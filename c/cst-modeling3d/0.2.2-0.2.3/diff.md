# Comparing `tmp/cst_modeling3d-0.2.2.tar.gz` & `tmp/cst_modeling3d-0.2.3.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "cst_modeling3d-0.2.2.tar", last modified: Wed Mar 15 05:06:00 2023, max compression
+gzip compressed data, was "cst_modeling3d-0.2.3.tar", last modified: Mon Apr 17 06:40:07 2023, max compression
```

## Comparing `cst_modeling3d-0.2.2.tar` & `cst_modeling3d-0.2.3.tar`

### file list

```diff
@@ -1,17 +1,17 @@
-drwxrwxrwx   0        0        0        0 2023-03-15 05:06:00.165567 cst_modeling3d-0.2.2/
--rw-rw-rw-   0        0        0     1088 2023-02-28 08:20:44.000000 cst_modeling3d-0.2.2/LICENSE
--rw-rw-rw-   0        0        0      406 2023-03-15 05:06:00.164567 cst_modeling3d-0.2.2/PKG-INFO
--rw-rw-rw-   0        0        0     2899 2023-03-15 05:03:28.000000 cst_modeling3d-0.2.2/README.md
-drwxrwxrwx   0        0        0        0 2023-03-15 05:06:00.148558 cst_modeling3d-0.2.2/cst_modeling/
--rw-rw-rw-   0        0        0      873 2023-02-28 08:20:44.000000 cst_modeling3d-0.2.2/cst_modeling/__init__.py
--rw-rw-rw-   0        0        0   104762 2023-03-03 09:09:08.000000 cst_modeling3d-0.2.2/cst_modeling/basic.py
--rw-rw-rw-   0        0        0    42116 2023-03-03 10:11:39.000000 cst_modeling3d-0.2.2/cst_modeling/section.py
--rw-rw-rw-   0        0        0    18114 2023-03-03 10:24:14.000000 cst_modeling3d-0.2.2/cst_modeling/surface.py
-drwxrwxrwx   0        0        0        0 2023-03-15 05:06:00.162568 cst_modeling3d-0.2.2/cst_modeling3d.egg-info/
--rw-rw-rw-   0        0        0      406 2023-03-15 05:05:59.000000 cst_modeling3d-0.2.2/cst_modeling3d.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      310 2023-03-15 05:06:00.000000 cst_modeling3d-0.2.2/cst_modeling3d.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-03-15 05:05:59.000000 cst_modeling3d-0.2.2/cst_modeling3d.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       23 2023-03-15 05:05:59.000000 cst_modeling3d-0.2.2/cst_modeling3d.egg-info/requires.txt
--rw-rw-rw-   0        0        0       13 2023-03-15 05:05:59.000000 cst_modeling3d-0.2.2/cst_modeling3d.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       42 2023-03-15 05:06:00.165567 cst_modeling3d-0.2.2/setup.cfg
--rw-rw-rw-   0        0        0      690 2023-02-28 08:20:44.000000 cst_modeling3d-0.2.2/setup.py
+drwxrwxrwx   0        0        0        0 2023-04-17 06:40:07.777437 cst_modeling3d-0.2.3/
+-rw-rw-rw-   0        0        0     1088 2023-02-28 08:20:44.000000 cst_modeling3d-0.2.3/LICENSE
+-rw-rw-rw-   0        0        0      406 2023-04-17 06:40:07.776438 cst_modeling3d-0.2.3/PKG-INFO
+-rw-rw-rw-   0        0        0     2899 2023-03-15 05:03:28.000000 cst_modeling3d-0.2.3/README.md
+drwxrwxrwx   0        0        0        0 2023-04-17 06:40:07.768437 cst_modeling3d-0.2.3/cst_modeling/
+-rw-rw-rw-   0        0        0      873 2023-04-17 06:39:55.000000 cst_modeling3d-0.2.3/cst_modeling/__init__.py
+-rw-rw-rw-   0        0        0   104760 2023-04-17 06:34:48.000000 cst_modeling3d-0.2.3/cst_modeling/basic.py
+-rw-rw-rw-   0        0        0    42116 2023-03-03 10:11:39.000000 cst_modeling3d-0.2.3/cst_modeling/section.py
+-rw-rw-rw-   0        0        0    18114 2023-04-17 06:34:56.000000 cst_modeling3d-0.2.3/cst_modeling/surface.py
+drwxrwxrwx   0        0        0        0 2023-04-17 06:40:07.775436 cst_modeling3d-0.2.3/cst_modeling3d.egg-info/
+-rw-rw-rw-   0        0        0      406 2023-04-17 06:40:07.000000 cst_modeling3d-0.2.3/cst_modeling3d.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      310 2023-04-17 06:40:07.000000 cst_modeling3d-0.2.3/cst_modeling3d.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-04-17 06:40:07.000000 cst_modeling3d-0.2.3/cst_modeling3d.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       23 2023-04-17 06:40:07.000000 cst_modeling3d-0.2.3/cst_modeling3d.egg-info/requires.txt
+-rw-rw-rw-   0        0        0       13 2023-04-17 06:40:07.000000 cst_modeling3d-0.2.3/cst_modeling3d.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       42 2023-04-17 06:40:07.777437 cst_modeling3d-0.2.3/setup.cfg
+-rw-rw-rw-   0        0        0      690 2023-02-28 08:20:44.000000 cst_modeling3d-0.2.3/setup.py
```

### Comparing `cst_modeling3d-0.2.2/LICENSE` & `cst_modeling3d-0.2.3/LICENSE`

 * *Files identical despite different names*

### Comparing `cst_modeling3d-0.2.2/README.md` & `cst_modeling3d-0.2.3/README.md`

 * *Files identical despite different names*

### Comparing `cst_modeling3d-0.2.2/cst_modeling/__init__.py` & `cst_modeling3d-0.2.3/cst_modeling/__init__.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-__version__ = "0.2.2"
+__version__ = "0.2.3"
 __name__ = "cst_modeling"
 
 '''
 Information of modeling
 
 1. Coordinates
```

### Comparing `cst_modeling3d-0.2.2/cst_modeling/basic.py` & `cst_modeling3d-0.2.3/cst_modeling/basic.py`

 * *Files 0% similar despite different names*

```diff
@@ -3221,15 +3221,15 @@
 0000c940: 6c66 2e73 7572 6673 5b69 5f73 6563 5d5b  lf.surfs[i_sec][
 0000c950: 325d 0d0a 2020 2020 2020 2020 2020 2020  2]..            
 0000c960: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
 0000c970: 2020 2020 2020 2020 2020 2020 2020 6e74                nt
 0000c980: 203d 2073 7572 665f 782e 7368 6170 655b   = surf_x.shape[
 0000c990: 315d 0d0a 0d0a 2020 2020 2020 2020 2020  1]....          
 0000c9a0: 2020 2020 2020 2020 2020 6966 2069 5f73            if i_s
-0000c9b0: 6563 3e3d 6e5f 7069 6563 652d 323a 0d0a  ec>=n_piece-2:..
+0000c9b0: 6563 3e3d 6e5f 7069 6563 652d 313a 0d0a  ec>=n_piece-1:..
 0000c9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000c9d0: 2020 2020 2020 2020 695f 6164 6420 3d20          i_add = 
 0000c9e0: 300d 0a20 2020 2020 2020 2020 2020 2020  0..             
 0000c9f0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
 0000ca00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000ca10: 2020 2020 2020 695f 6164 6420 3d20 310d        i_add = 1.
 0000ca20: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
@@ -3955,2594 +3955,2594 @@
 0000f720: 2072 6f74 6174 696f 6e5f 7665 6374 6f72   rotation_vector
 0000f730: 203d 206e 702e 6172 7261 7928 6178 6973   = np.array(axis
 0000f740: 5f76 6563 746f 7229 2f6e 702e 6c69 6e61  _vector)/np.lina
 0000f750: 6c67 2e6e 6f72 6d28 6178 6973 5f76 6563  lg.norm(axis_vec
 0000f760: 746f 7229 0d0a 0d0a 2020 2020 726f 7420  tor)....    rot 
 0000f770: 3d20 526f 7461 7469 6f6e 2e66 726f 6d5f  = Rotation.from_
 0000f780: 726f 7476 6563 2861 6e67 6c65 2a72 6f74  rotvec(angle*rot
-0000f790: 6174 696f 6e5f 7665 6374 6f72 2c20 6465  ation_vector, de
-0000f7a0: 6772 6565 733d 5472 7565 290d 0a20 2020  grees=True)..   
-0000f7b0: 200d 0a20 2020 2023 2049 6e20 7465 726d   ..    # In term
-0000f7c0: 7320 6f66 2072 6f74 6174 696f 6e20 6d61  s of rotation ma
-0000f7d0: 7472 6963 6965 732c 2074 6869 7320 6170  tricies, this ap
-0000f7e0: 706c 6963 6174 696f 6e20 6973 2074 6865  plication is the
-0000f7f0: 2073 616d 6520 6173 2072 6f74 2e61 735f   same as rot.as_
-0000f800: 6d61 7472 6978 2829 2e64 6f74 2876 6563  matrix().dot(vec
-0000f810: 746f 7229 2e0d 0a20 2020 2070 6f69 6e74  tor)...    point
-0000f820: 7320 3d20 726f 742e 6170 706c 7928 7665  s = rot.apply(ve
-0000f830: 6374 6f72 2920 2b20 6f72 6967 696e 0d0a  ctor) + origin..
-0000f840: 2020 2020 0d0a 2020 2020 7265 7475 726e      ..    return
-0000f850: 2070 6f69 6e74 730d 0a0d 0a64 6566 2073   points....def s
-0000f860: 7472 6574 6368 5f66 6978 6564 5f70 6f69  tretch_fixed_poi
-0000f870: 6e74 2878 3a20 6e70 2e6e 6461 7272 6179  nt(x: np.ndarray
-0000f880: 2c20 793a 206e 702e 6e64 6172 7261 792c  , y: np.ndarray,
-0000f890: 2064 783d 302e 302c 2064 793d 302e 302c   dx=0.0, dy=0.0,
-0000f8a0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000f8b0: 2020 2020 2020 2020 2020 2078 6d3d 4e6f             xm=No
-0000f8c0: 6e65 2c20 796d 3d4e 6f6e 652c 2078 663d  ne, ym=None, xf=
-0000f8d0: 4e6f 6e65 2c20 7966 3d4e 6f6e 6529 202d  None, yf=None) -
-0000f8e0: 3e20 5475 706c 655b 6e70 2e6e 6461 7272  > Tuple[np.ndarr
-0000f8f0: 6179 2c20 6e70 2e6e 6461 7272 6179 5d3a  ay, np.ndarray]:
-0000f900: 0d0a 2020 2020 2727 270d 0a20 2020 204c  ..    '''..    L
-0000f910: 696e 6561 726c 7920 7374 7265 7463 6820  inearly stretch 
-0000f920: 6120 3244 2063 7572 7665 2077 6865 6e20  a 2D curve when 
-0000f930: 6120 6365 7274 6169 6e20 706f 696e 7420  a certain point 
-0000f940: 286f 6e20 7468 6520 6375 7276 6529 2069  (on the curve) i
-0000f950: 7320 6669 7865 642e 0d0a 0d0a 2020 2020  s fixed.....    
-0000f960: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+0000f790: 6174 696f 6e5f 7665 6374 6f72 2f31 3830  ation_vector/180
+0000f7a0: 2e30 2a6e 702e 7069 290d 0a20 2020 200d  .0*np.pi)..    .
+0000f7b0: 0a20 2020 2023 2049 6e20 7465 726d 7320  .    # In terms 
+0000f7c0: 6f66 2072 6f74 6174 696f 6e20 6d61 7472  of rotation matr
+0000f7d0: 6963 6965 732c 2074 6869 7320 6170 706c  icies, this appl
+0000f7e0: 6963 6174 696f 6e20 6973 2074 6865 2073  ication is the s
+0000f7f0: 616d 6520 6173 2072 6f74 2e61 735f 6d61  ame as rot.as_ma
+0000f800: 7472 6978 2829 2e64 6f74 2876 6563 746f  trix().dot(vecto
+0000f810: 7229 2e0d 0a20 2020 2070 6f69 6e74 7320  r)...    points 
+0000f820: 3d20 726f 742e 6170 706c 7928 7665 6374  = rot.apply(vect
+0000f830: 6f72 2920 2b20 6f72 6967 696e 0d0a 2020  or) + origin..  
+0000f840: 2020 0d0a 2020 2020 7265 7475 726e 2070    ..    return p
+0000f850: 6f69 6e74 730d 0a0d 0a64 6566 2073 7472  oints....def str
+0000f860: 6574 6368 5f66 6978 6564 5f70 6f69 6e74  etch_fixed_point
+0000f870: 2878 3a20 6e70 2e6e 6461 7272 6179 2c20  (x: np.ndarray, 
+0000f880: 793a 206e 702e 6e64 6172 7261 792c 2064  y: np.ndarray, d
+0000f890: 783d 302e 302c 2064 793d 302e 302c 200d  x=0.0, dy=0.0, .
+0000f8a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f8b0: 2020 2020 2020 2020 2078 6d3d 4e6f 6e65           xm=None
+0000f8c0: 2c20 796d 3d4e 6f6e 652c 2078 663d 4e6f  , ym=None, xf=No
+0000f8d0: 6e65 2c20 7966 3d4e 6f6e 6529 202d 3e20  ne, yf=None) -> 
+0000f8e0: 5475 706c 655b 6e70 2e6e 6461 7272 6179  Tuple[np.ndarray
+0000f8f0: 2c20 6e70 2e6e 6461 7272 6179 5d3a 0d0a  , np.ndarray]:..
+0000f900: 2020 2020 2727 270d 0a20 2020 204c 696e      '''..    Lin
+0000f910: 6561 726c 7920 7374 7265 7463 6820 6120  early stretch a 
+0000f920: 3244 2063 7572 7665 2077 6865 6e20 6120  2D curve when a 
+0000f930: 6365 7274 6169 6e20 706f 696e 7420 286f  certain point (o
+0000f940: 6e20 7468 6520 6375 7276 6529 2069 7320  n the curve) is 
+0000f950: 6669 7865 642e 0d0a 0d0a 2020 2020 5061  fixed.....    Pa
+0000f960: 7261 6d65 7465 7273 0d0a 2020 2020 2d2d  rameters..    --
 0000f970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000f980: 2d2d 0d0a 2020 2020 782c 2079 203a 206e  --..    x, y : n
-0000f990: 6461 7272 6179 0d0a 2020 2020 2020 2020  darray..        
-0000f9a0: 636f 6f72 6469 6e61 7465 7320 6f66 2074  coordinates of t
-0000f9b0: 6865 2032 4420 6375 7276 650d 0a20 2020  he 2D curve..   
-0000f9c0: 2064 782c 2064 7920 3a20 666c 6f61 740d   dx, dy : float.
-0000f9d0: 0a20 2020 2020 2020 206d 6f76 656d 656e  .        movemen
-0000f9e0: 7420 6f66 2074 6865 2073 7472 6574 6368  t of the stretch
-0000f9f0: 6564 2070 6f69 6e74 0d0a 2020 2020 786d  ed point..    xm
-0000fa00: 2c20 796d 203a 207b 4e6f 6e65 2c20 666c  , ym : {None, fl
-0000fa10: 6f61 747d 0d0a 2020 2020 2020 2020 636f  oat}..        co
-0000fa20: 6f72 6469 6e61 7465 7320 6f66 2074 6865  ordinates of the
-0000fa30: 2073 7472 6574 6368 6564 2070 6f69 6e74   stretched point
-0000fa40: 2e0d 0a20 2020 2020 2020 2049 6620 4e6f  ...        If No
-0000fa50: 6e65 2c20 7468 6520 7374 7265 7463 6865  ne, the stretche
-0000fa60: 6420 706f 696e 7420 6973 2074 6865 2066  d point is the f
-0000fa70: 6972 7374 2065 6c65 6d65 6e74 206f 6620  irst element of 
-0000fa80: 7468 6520 6375 7276 652e 0d0a 2020 2020  the curve...    
-0000fa90: 7866 2c20 7966 203a 207b 4e6f 6e65 2c20  xf, yf : {None, 
-0000faa0: 666c 6f61 747d 0d0a 2020 2020 2020 2020  float}..        
-0000fab0: 636f 6f72 6469 6e61 7465 7320 6f66 2074  coordinates of t
-0000fac0: 6865 2066 6978 6564 2070 6f69 6e74 2e0d  he fixed point..
-0000fad0: 0a20 2020 2020 2020 2049 6620 4e6f 6e65  .        If None
-0000fae0: 2c20 7468 6520 6669 7865 6420 706f 696e  , the fixed poin
-0000faf0: 7420 6973 2074 6865 206c 6173 7420 656c  t is the last el
-0000fb00: 656d 656e 7420 6f66 2074 6865 2063 7572  ement of the cur
-0000fb10: 7665 2e0d 0a0d 0a20 2020 2052 6574 7572  ve.....    Retur
-0000fb20: 6e73 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  ns..    --------
-0000fb30: 2d2d 2d2d 2d0d 0a20 2020 2078 5f2c 2079  -----..    x_, y
-0000fb40: 5f20 3a20 6e64 6172 7261 790d 0a20 2020  _ : ndarray..   
-0000fb50: 2020 2020 2063 6f6f 7264 696e 6174 6573       coordinates
-0000fb60: 206f 6620 7468 6520 7374 7265 7463 6865   of the stretche
-0000fb70: 6420 6375 7276 650d 0a20 2020 200d 0a20  d curve..    .. 
-0000fb80: 2020 2045 7861 6d70 6c65 730d 0a20 2020     Examples..   
-0000fb90: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20   ------------.. 
-0000fba0: 2020 203e 3e3e 2078 5f2c 2079 5f20 3d20     >>> x_, y_ = 
-0000fbb0: 7374 7265 7463 685f 6669 7865 645f 706f  stretch_fixed_po
-0000fbc0: 696e 7428 782c 2079 2c20 6478 2c20 6479  int(x, y, dx, dy
-0000fbd0: 2c20 786d 2c20 796d 2c20 7866 2c20 7966  , xm, ym, xf, yf
-0000fbe0: 290d 0a20 2020 200d 0a20 2020 2027 2727  )..    ..    '''
-0000fbf0: 0d0a 2020 2020 785f 203d 2078 2e63 6f70  ..    x_ = x.cop
-0000fc00: 7928 290d 0a20 2020 2079 5f20 3d20 792e  y()..    y_ = y.
-0000fc10: 636f 7079 2829 0d0a 0d0a 2020 2020 6966  copy()....    if
-0000fc20: 2078 6620 6973 204e 6f6e 6520 6f72 2079   xf is None or y
-0000fc30: 6620 6973 204e 6f6e 653a 0d0a 2020 2020  f is None:..    
-0000fc40: 2020 2020 7866 203d 2078 5b2d 315d 0d0a      xf = x[-1]..
-0000fc50: 2020 2020 2020 2020 7966 203d 2079 5b2d          yf = y[-
-0000fc60: 315d 0d0a 0d0a 2020 2020 6966 2078 6d20  1]....    if xm 
-0000fc70: 6973 204e 6f6e 6520 6f72 2079 6d20 6973  is None or ym is
-0000fc80: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0000fc90: 786d 203d 2078 5b30 5d0d 0a20 2020 2020  xm = x[0]..     
-0000fca0: 2020 2079 6d20 3d20 795b 305d 0d0a 0d0a     ym = y[0]....
-0000fcb0: 2020 2020 6c6d 203d 206e 702e 6c69 6e61      lm = np.lina
-0000fcc0: 6c67 2e6e 6f72 6d28 5b78 6d2d 7866 2c20  lg.norm([xm-xf, 
-0000fcd0: 796d 2d79 665d 290d 0a0d 0a20 2020 2066  ym-yf])....    f
-0000fce0: 6f72 2069 2069 6e20 7261 6e67 6528 782e  or i in range(x.
-0000fcf0: 7368 6170 655b 305d 293a 0d0a 2020 2020  shape[0]):..    
-0000fd00: 2020 2020 7272 2020 3d20 6e70 2e6c 696e      rr  = np.lin
-0000fd10: 616c 672e 6e6f 726d 285b 785b 695d 2d78  alg.norm([x[i]-x
-0000fd20: 662c 2079 5b69 5d2d 7966 5d29 202f 206c  f, y[i]-yf]) / l
-0000fd30: 6d0d 0a20 2020 2020 2020 2078 5f5b 695d  m..        x_[i]
-0000fd40: 203d 2078 5f5b 695d 202b 2072 722a 6478   = x_[i] + rr*dx
-0000fd50: 0d0a 2020 2020 2020 2020 795f 5b69 5d20  ..        y_[i] 
-0000fd60: 3d20 795f 5b69 5d20 2b20 7272 2a64 790d  = y_[i] + rr*dy.
-0000fd70: 0a0d 0a20 2020 2072 6574 7572 6e20 785f  ...    return x_
-0000fd80: 2c20 795f 0d0a 0d0a 6465 6620 6672 6f6d  , y_....def from
-0000fd90: 4379 6c69 6e64 6572 2878 3a20 6e70 2e6e  Cylinder(x: np.n
-0000fda0: 6461 7272 6179 2c20 793a 206e 702e 6e64  darray, y: np.nd
-0000fdb0: 6172 7261 792c 207a 3a20 6e70 2e6e 6461  array, z: np.nda
-0000fdc0: 7272 6179 2c20 0d0a 2020 2020 2020 2020  rray, ..        
-0000fdd0: 2020 2020 2020 2020 2066 6c69 703d 5472           flip=Tr
-0000fde0: 7565 2c20 6f72 6967 696e 3d5b 302c 2030  ue, origin=[0, 0
-0000fdf0: 5d29 202d 3e20 5475 706c 655b 6e70 2e6e  ]) -> Tuple[np.n
-0000fe00: 6461 7272 6179 2c20 6e70 2e6e 6461 7272  darray, np.ndarr
-0000fe10: 6179 2c20 6e70 2e6e 6461 7272 6179 5d3a  ay, np.ndarray]:
-0000fe20: 0d0a 2020 2020 2727 270d 0a20 2020 2042  ..    '''..    B
-0000fe30: 656e 6420 7468 6520 6379 6c69 6e64 6572  end the cylinder
-0000fe40: 2063 7572 7665 2074 6f20 6120 3244 2070   curve to a 2D p
-0000fe50: 6c61 6e65 2063 7572 7665 2e0d 0a0d 0a20  lane curve..... 
-0000fe60: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0000fe70: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0000fe80: 2020 2078 2c20 7920 2c7a 203a 206e 6461     x, y ,z : nda
-0000fe90: 7272 6179 0d0a 2020 2020 2020 2020 636f  rray..        co
-0000fea0: 6f72 6469 6e61 7465 7320 6f66 2074 6865  ordinates of the
-0000feb0: 2063 7572 7665 206f 6e20 6120 6379 6c69   curve on a cyli
-0000fec0: 6e64 6572 2e20 6078 6020 616e 6420 6079  nder. `x` and `y
-0000fed0: 6020 6d75 7374 206e 6f74 2062 6520 3020  ` must not be 0 
-0000fee0: 6174 2074 6865 2073 616d 6520 7469 6d65  at the same time
-0000fef0: 2e0d 0a20 2020 2066 6c69 7020 3a20 626f  ...    flip : bo
-0000ff00: 6f6c 0d0a 2020 2020 2020 2020 6966 2054  ol..        if T
-0000ff10: 7275 652c 2066 6c69 7020 7468 6520 5820  rue, flip the X 
-0000ff20: 6f66 2074 6865 2065 7874 7261 6374 6564  of the extracted
-0000ff30: 2070 6c61 6e65 2063 7572 7665 2e0d 0a20   plane curve... 
-0000ff40: 2020 206f 7269 6769 6e3a 2061 7272 6179     origin: array
-0000ff50: 5f6c 696b 650d 0a20 2020 2020 2020 2074  _like..        t
-0000ff60: 6865 2063 796c 696e 6465 7220 6f72 6967  he cylinder orig
-0000ff70: 696e 2c20 5b78 302c 2079 305d 2028 6f72  in, [x0, y0] (or
-0000ff80: 205b 7830 2c20 7930 2c20 305d 292e 0d0a   [x0, y0, 0])...
-0000ff90: 0d0a 2020 2020 5265 7475 726e 730d 0a20  ..    Returns.. 
-0000ffa0: 2020 202d 2d2d 2d2d 2d2d 2d2d 0d0a 2020     ---------..  
-0000ffb0: 2020 582c 2059 2c20 5a20 3a20 206e 6461    X, Y, Z :  nda
-0000ffc0: 7272 6179 0d0a 2020 2020 2020 2020 636f  rray..        co
-0000ffd0: 6f72 6469 6e61 7465 7320 6f66 2074 6865  ordinates of the
-0000ffe0: 2063 7572 7665 2062 656e 7420 746f 2074   curve bent to t
-0000fff0: 6865 2032 4420 582d 5920 706c 616e 650d  he 2D X-Y plane.
-00010000: 0a0d 0a20 2020 204e 6f74 6573 0d0a 2020  ...    Notes..  
-00010010: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00010020: 2020 5468 6520 6379 6c69 6e64 6572 2773    The cylinder's
-00010030: 2064 6566 6175 6c74 206f 7269 6769 6e20   default origin 
-00010040: 6973 2060 2830 2c30 2c30 2960 2c20 6178  is `(0,0,0)`, ax
-00010050: 6973 2069 7320 7a2d 6178 6973 2e0d 0a20  is is z-axis... 
-00010060: 2020 200d 0a20 2020 2054 6865 206f 7269     ..    The ori
-00010070: 6769 6e20 6f66 2063 796c 696e 6465 7220  gin of cylinder 
-00010080: 616e 6420 706c 616e 6520 6375 7276 6573  and plane curves
-00010090: 2069 7320 7468 6520 7361 6d65 2028 302c   is the same (0,
-000100a0: 302c 3029 2e0d 0a20 2020 200d 0a20 2020  0,0)...    ..   
-000100b0: 2043 796c 696e 6465 723a 2078 2c20 792c   Cylinder: x, y,
-000100c0: 207a 207e 7e20 722c 2074 6865 7461 2c20   z ~~ r, theta, 
-000100d0: 7a20 5c6e 0d0a 2020 2020 506c 616e 653a  z \n..    Plane:
-000100e0: 2020 2020 582c 2059 2c20 5a20 5c6e 0d0a      X, Y, Z \n..
-000100f0: 0d0a 2020 2020 7468 6574 6120 3d20 6172  ..    theta = ar
-00010100: 6374 616e 2879 2f78 2920 5c6e 0d0a 2020  ctan(y/x) \n..  
-00010110: 2020 7220 3d20 7371 7274 2878 5e32 2b79    r = sqrt(x^2+y
-00010120: 5e32 2920 5c6e 0d0a 2020 2020 7a20 3d20  ^2) \n..    z = 
-00010130: 7a20 5c6e 0d0a 0d0a 2020 2020 5820 3d20  z \n....    X = 
-00010140: 722a 7468 6574 6120 5c6e 0d0a 2020 2020  r*theta \n..    
-00010150: 5920 3d20 7a20 5c6e 0d0a 2020 2020 5a20  Y = z \n..    Z 
-00010160: 3d20 7220 5c6e 0d0a 2020 2020 2727 270d  = r \n..    '''.
-00010170: 0a20 2020 2063 6f65 6620 3d20 2d31 2e30  .    coef = -1.0
-00010180: 2069 6620 666c 6970 2065 6c73 6520 312e   if flip else 1.
-00010190: 300d 0a0d 0a20 2020 2078 203d 2078 202d  0....    x = x -
-000101a0: 206f 7269 6769 6e5b 305d 0d0a 2020 2020   origin[0]..    
-000101b0: 7920 3d20 7920 2d20 6f72 6967 696e 5b31  y = y - origin[1
-000101c0: 5d0d 0a0d 0a20 2020 2072 7220 3d20 6e70  ]....    rr = np
-000101d0: 2e73 7172 7428 782a 782b 792a 7929 0d0a  .sqrt(x*x+y*y)..
-000101e0: 2020 2020 7474 203d 206e 702e 6172 6374      tt = np.arct
-000101f0: 616e 3228 792c 2078 2920 2a20 636f 6566  an2(y, x) * coef
-00010200: 0d0a 0d0a 2020 2020 5820 3d20 7272 2a74  ....    X = rr*t
-00010210: 740d 0a20 2020 2059 203d 207a 2e63 6f70  t..    Y = z.cop
-00010220: 7928 290d 0a20 2020 205a 203d 2072 720d  y()..    Z = rr.
-00010230: 0a0d 0a20 2020 2072 6574 7572 6e20 582c  ...    return X,
-00010240: 2059 2c20 5a0d 0a0d 0a64 6566 2074 6f43   Y, Z....def toC
-00010250: 796c 696e 6465 7228 583a 206e 702e 6e64  ylinder(X: np.nd
-00010260: 6172 7261 792c 2059 3a20 6e70 2e6e 6461  array, Y: np.nda
-00010270: 7272 6179 2c20 5a3a 206e 702e 6e64 6172  rray, Z: np.ndar
-00010280: 7261 792c 200d 0a20 2020 2020 2020 2020  ray, ..         
-00010290: 2020 2020 2020 666c 6970 3d54 7275 652c        flip=True,
-000102a0: 206f 7269 6769 6e3d 5b30 2c20 305d 2920   origin=[0, 0]) 
-000102b0: 2d3e 2054 7570 6c65 5b6e 702e 6e64 6172  -> Tuple[np.ndar
-000102c0: 7261 792c 206e 702e 6e64 6172 7261 792c  ray, np.ndarray,
-000102d0: 206e 702e 6e64 6172 7261 795d 3a0d 0a20   np.ndarray]:.. 
-000102e0: 2020 2027 2727 0d0a 2020 2020 4265 6e64     '''..    Bend
-000102f0: 2074 6865 2070 6c61 6e65 2073 6563 7469   the plane secti
-00010300: 6f6e 7320 746f 2063 7572 7665 7320 6f6e  ons to curves on
-00010310: 2061 2063 796c 696e 6465 722e 0d0a 0d0a   a cylinder.....
-00010320: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-00010330: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-00010340: 2020 2020 582c 2059 2c20 5a20 3a20 6e64      X, Y, Z : nd
-00010350: 6172 7261 790d 0a20 2020 2020 2020 2063  array..        c
-00010360: 6f6f 7264 696e 6174 6573 206f 6620 7468  oordinates of th
-00010370: 6520 6375 7276 6520 6f6e 2061 2070 6c61  e curve on a pla
-00010380: 6e65 2e20 605a 6020 6d75 7374 206e 6f74  ne. `Z` must not
-00010390: 2062 6520 302e 0d0a 2020 2020 666c 6970   be 0...    flip
-000103a0: 203a 2062 6f6f 6c0d 0a20 2020 2020 2020   : bool..       
-000103b0: 2069 6620 5472 7565 2c20 666c 6970 2074   if True, flip t
-000103c0: 6865 2058 206f 6620 7468 6520 6578 7472  he X of the extr
-000103d0: 6163 7465 6420 706c 616e 6520 6375 7276  acted plane curv
-000103e0: 652e 0d0a 2020 2020 6f72 6967 696e 3a20  e...    origin: 
-000103f0: 6172 7261 795f 6c69 6b65 0d0a 2020 2020  array_like..    
-00010400: 2020 2020 7468 6520 6379 6c69 6e64 6572      the cylinder
-00010410: 206f 7269 6769 6e2c 205b 7830 2c20 7930   origin, [x0, y0
-00010420: 5d20 286f 7220 5b78 302c 2079 302c 2030  ] (or [x0, y0, 0
-00010430: 5d29 2e0d 0a0d 0a20 2020 2052 6574 7572  ]).....    Retur
-00010440: 6e73 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  ns..    --------
-00010450: 2d0d 0a20 2020 2078 2c20 7920 2c7a 203a  -..    x, y ,z :
-00010460: 2020 6e64 6172 7261 790d 0a20 2020 2020    ndarray..     
-00010470: 2020 2063 6f6f 7264 696e 6174 6573 206f     coordinates o
-00010480: 6620 7468 6520 6375 7276 6520 6265 6e74  f the curve bent
-00010490: 2074 6f20 6120 6379 6c69 6e64 6572 2e0d   to a cylinder..
-000104a0: 0a0d 0a20 2020 204e 6f74 6573 0d0a 2020  ...    Notes..  
-000104b0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-000104c0: 2020 5468 6520 6379 6c69 6e64 6572 2773    The cylinder's
-000104d0: 2064 6566 6175 6c74 206f 7269 6769 6e20   default origin 
-000104e0: 6973 2060 2830 2c30 2c30 2960 2c20 6178  is `(0,0,0)`, ax
-000104f0: 6973 2069 7320 7a2d 6178 6973 2e0d 0a20  is is z-axis... 
-00010500: 2020 200d 0a20 2020 2054 6865 206f 7269     ..    The ori
-00010510: 6769 6e20 6f66 2063 796c 696e 6465 7220  gin of cylinder 
-00010520: 616e 6420 706c 616e 6520 6375 7276 6573  and plane curves
-00010530: 2069 7320 7468 6520 7361 6d65 2028 302c   is the same (0,
-00010540: 302c 3029 2e0d 0a20 2020 200d 0a20 2020  0,0)...    ..   
-00010550: 2043 796c 696e 6465 723a 2078 2c20 792c   Cylinder: x, y,
-00010560: 207a 207e 7e20 722c 2074 6865 7461 2c20   z ~~ r, theta, 
-00010570: 7a20 5c6e 0d0a 2020 2020 506c 616e 653a  z \n..    Plane:
-00010580: 2020 2020 582c 2059 2c20 5a20 5c6e 0d0a      X, Y, Z \n..
-00010590: 0d0a 2020 2020 7468 6574 6120 3d20 6172  ..    theta = ar
-000105a0: 6374 616e 2879 2f78 2920 5c6e 0d0a 2020  ctan(y/x) \n..  
-000105b0: 2020 7220 3d20 7371 7274 2878 5e32 2b79    r = sqrt(x^2+y
-000105c0: 5e32 2920 5c6e 0d0a 2020 2020 7a20 3d20  ^2) \n..    z = 
-000105d0: 7a20 5c6e 0d0a 0d0a 2020 2020 5820 3d20  z \n....    X = 
-000105e0: 722a 7468 6574 6120 5c6e 0d0a 2020 2020  r*theta \n..    
-000105f0: 5920 3d20 7a20 5c6e 0d0a 2020 2020 5a20  Y = z \n..    Z 
-00010600: 3d20 7220 5c6e 0d0a 2020 2020 2727 270d  = r \n..    '''.
-00010610: 0a20 2020 2063 6f65 6620 3d20 2d31 2e30  .    coef = -1.0
-00010620: 2069 6620 666c 6970 2065 6c73 6520 312e   if flip else 1.
-00010630: 300d 0a0d 0a20 2020 206e 6e20 3d20 582e  0....    nn = X.
-00010640: 7368 6170 655b 305d 0d0a 2020 2020 7820  shape[0]..    x 
-00010650: 3d20 6e70 2e7a 6572 6f73 286e 6e29 0d0a  = np.zeros(nn)..
-00010660: 2020 2020 7920 3d20 6e70 2e7a 6572 6f73      y = np.zeros
-00010670: 286e 6e29 0d0a 2020 2020 7a20 3d20 592e  (nn)..    z = Y.
-00010680: 636f 7079 2829 0d0a 0d0a 2020 2020 666f  copy()....    fo
-00010690: 7220 6920 696e 2072 616e 6765 286e 6e29  r i in range(nn)
-000106a0: 3a0d 0a20 2020 2020 2020 2072 203d 205a  :..        r = Z
-000106b0: 5b69 5d0d 0a20 2020 2020 2020 2074 6865  [i]..        the
-000106c0: 7461 203d 2058 5b69 5d2f 7220 2a20 636f  ta = X[i]/r * co
-000106d0: 6566 0d0a 2020 2020 2020 2020 785b 695d  ef..        x[i]
-000106e0: 203d 2072 2a6e 702e 636f 7328 7468 6574   = r*np.cos(thet
-000106f0: 6129 0d0a 2020 2020 2020 2020 795b 695d  a)..        y[i]
-00010700: 203d 2072 2a6e 702e 7369 6e28 7468 6574   = r*np.sin(thet
-00010710: 6129 0d0a 0d0a 2020 2020 7820 3d20 7820  a)....    x = x 
-00010720: 2b20 6f72 6967 696e 5b30 5d0d 0a20 2020  + origin[0]..   
-00010730: 2079 203d 2079 202b 206f 7269 6769 6e5b   y = y + origin[
-00010740: 315d 0d0a 0d0a 2020 2020 7265 7475 726e  1]....    return
-00010750: 2078 2c20 792c 207a 0d0a 0d0a 0d0a 232a   x, y, z......#*
-00010760: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+0000f980: 0d0a 2020 2020 782c 2079 203a 206e 6461  ..    x, y : nda
+0000f990: 7272 6179 0d0a 2020 2020 2020 2020 636f  rray..        co
+0000f9a0: 6f72 6469 6e61 7465 7320 6f66 2074 6865  ordinates of the
+0000f9b0: 2032 4420 6375 7276 650d 0a20 2020 2064   2D curve..    d
+0000f9c0: 782c 2064 7920 3a20 666c 6f61 740d 0a20  x, dy : float.. 
+0000f9d0: 2020 2020 2020 206d 6f76 656d 656e 7420         movement 
+0000f9e0: 6f66 2074 6865 2073 7472 6574 6368 6564  of the stretched
+0000f9f0: 2070 6f69 6e74 0d0a 2020 2020 786d 2c20   point..    xm, 
+0000fa00: 796d 203a 207b 4e6f 6e65 2c20 666c 6f61  ym : {None, floa
+0000fa10: 747d 0d0a 2020 2020 2020 2020 636f 6f72  t}..        coor
+0000fa20: 6469 6e61 7465 7320 6f66 2074 6865 2073  dinates of the s
+0000fa30: 7472 6574 6368 6564 2070 6f69 6e74 2e0d  tretched point..
+0000fa40: 0a20 2020 2020 2020 2049 6620 4e6f 6e65  .        If None
+0000fa50: 2c20 7468 6520 7374 7265 7463 6865 6420  , the stretched 
+0000fa60: 706f 696e 7420 6973 2074 6865 2066 6972  point is the fir
+0000fa70: 7374 2065 6c65 6d65 6e74 206f 6620 7468  st element of th
+0000fa80: 6520 6375 7276 652e 0d0a 2020 2020 7866  e curve...    xf
+0000fa90: 2c20 7966 203a 207b 4e6f 6e65 2c20 666c  , yf : {None, fl
+0000faa0: 6f61 747d 0d0a 2020 2020 2020 2020 636f  oat}..        co
+0000fab0: 6f72 6469 6e61 7465 7320 6f66 2074 6865  ordinates of the
+0000fac0: 2066 6978 6564 2070 6f69 6e74 2e0d 0a20   fixed point... 
+0000fad0: 2020 2020 2020 2049 6620 4e6f 6e65 2c20         If None, 
+0000fae0: 7468 6520 6669 7865 6420 706f 696e 7420  the fixed point 
+0000faf0: 6973 2074 6865 206c 6173 7420 656c 656d  is the last elem
+0000fb00: 656e 7420 6f66 2074 6865 2063 7572 7665  ent of the curve
+0000fb10: 2e0d 0a0d 0a20 2020 2052 6574 7572 6e73  .....    Returns
+0000fb20: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
+0000fb30: 2d2d 2d0d 0a20 2020 2078 5f2c 2079 5f20  ---..    x_, y_ 
+0000fb40: 3a20 6e64 6172 7261 790d 0a20 2020 2020  : ndarray..     
+0000fb50: 2020 2063 6f6f 7264 696e 6174 6573 206f     coordinates o
+0000fb60: 6620 7468 6520 7374 7265 7463 6865 6420  f the stretched 
+0000fb70: 6375 7276 650d 0a20 2020 200d 0a20 2020  curve..    ..   
+0000fb80: 2045 7861 6d70 6c65 730d 0a20 2020 202d   Examples..    -
+0000fb90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
+0000fba0: 203e 3e3e 2078 5f2c 2079 5f20 3d20 7374   >>> x_, y_ = st
+0000fbb0: 7265 7463 685f 6669 7865 645f 706f 696e  retch_fixed_poin
+0000fbc0: 7428 782c 2079 2c20 6478 2c20 6479 2c20  t(x, y, dx, dy, 
+0000fbd0: 786d 2c20 796d 2c20 7866 2c20 7966 290d  xm, ym, xf, yf).
+0000fbe0: 0a20 2020 200d 0a20 2020 2027 2727 0d0a  .    ..    '''..
+0000fbf0: 2020 2020 785f 203d 2078 2e63 6f70 7928      x_ = x.copy(
+0000fc00: 290d 0a20 2020 2079 5f20 3d20 792e 636f  )..    y_ = y.co
+0000fc10: 7079 2829 0d0a 0d0a 2020 2020 6966 2078  py()....    if x
+0000fc20: 6620 6973 204e 6f6e 6520 6f72 2079 6620  f is None or yf 
+0000fc30: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
+0000fc40: 2020 7866 203d 2078 5b2d 315d 0d0a 2020    xf = x[-1]..  
+0000fc50: 2020 2020 2020 7966 203d 2079 5b2d 315d        yf = y[-1]
+0000fc60: 0d0a 0d0a 2020 2020 6966 2078 6d20 6973  ....    if xm is
+0000fc70: 204e 6f6e 6520 6f72 2079 6d20 6973 204e   None or ym is N
+0000fc80: 6f6e 653a 0d0a 2020 2020 2020 2020 786d  one:..        xm
+0000fc90: 203d 2078 5b30 5d0d 0a20 2020 2020 2020   = x[0]..       
+0000fca0: 2079 6d20 3d20 795b 305d 0d0a 0d0a 2020   ym = y[0]....  
+0000fcb0: 2020 6c6d 203d 206e 702e 6c69 6e61 6c67    lm = np.linalg
+0000fcc0: 2e6e 6f72 6d28 5b78 6d2d 7866 2c20 796d  .norm([xm-xf, ym
+0000fcd0: 2d79 665d 290d 0a0d 0a20 2020 2066 6f72  -yf])....    for
+0000fce0: 2069 2069 6e20 7261 6e67 6528 782e 7368   i in range(x.sh
+0000fcf0: 6170 655b 305d 293a 0d0a 2020 2020 2020  ape[0]):..      
+0000fd00: 2020 7272 2020 3d20 6e70 2e6c 696e 616c    rr  = np.linal
+0000fd10: 672e 6e6f 726d 285b 785b 695d 2d78 662c  g.norm([x[i]-xf,
+0000fd20: 2079 5b69 5d2d 7966 5d29 202f 206c 6d0d   y[i]-yf]) / lm.
+0000fd30: 0a20 2020 2020 2020 2078 5f5b 695d 203d  .        x_[i] =
+0000fd40: 2078 5f5b 695d 202b 2072 722a 6478 0d0a   x_[i] + rr*dx..
+0000fd50: 2020 2020 2020 2020 795f 5b69 5d20 3d20          y_[i] = 
+0000fd60: 795f 5b69 5d20 2b20 7272 2a64 790d 0a0d  y_[i] + rr*dy...
+0000fd70: 0a20 2020 2072 6574 7572 6e20 785f 2c20  .    return x_, 
+0000fd80: 795f 0d0a 0d0a 6465 6620 6672 6f6d 4379  y_....def fromCy
+0000fd90: 6c69 6e64 6572 2878 3a20 6e70 2e6e 6461  linder(x: np.nda
+0000fda0: 7272 6179 2c20 793a 206e 702e 6e64 6172  rray, y: np.ndar
+0000fdb0: 7261 792c 207a 3a20 6e70 2e6e 6461 7272  ray, z: np.ndarr
+0000fdc0: 6179 2c20 0d0a 2020 2020 2020 2020 2020  ay, ..          
+0000fdd0: 2020 2020 2020 2066 6c69 703d 5472 7565         flip=True
+0000fde0: 2c20 6f72 6967 696e 3d5b 302c 2030 5d29  , origin=[0, 0])
+0000fdf0: 202d 3e20 5475 706c 655b 6e70 2e6e 6461   -> Tuple[np.nda
+0000fe00: 7272 6179 2c20 6e70 2e6e 6461 7272 6179  rray, np.ndarray
+0000fe10: 2c20 6e70 2e6e 6461 7272 6179 5d3a 0d0a  , np.ndarray]:..
+0000fe20: 2020 2020 2727 270d 0a20 2020 2042 656e      '''..    Ben
+0000fe30: 6420 7468 6520 6379 6c69 6e64 6572 2063  d the cylinder c
+0000fe40: 7572 7665 2074 6f20 6120 3244 2070 6c61  urve to a 2D pla
+0000fe50: 6e65 2063 7572 7665 2e0d 0a0d 0a20 2020  ne curve.....   
+0000fe60: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0000fe70: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+0000fe80: 2078 2c20 7920 2c7a 203a 206e 6461 7272   x, y ,z : ndarr
+0000fe90: 6179 0d0a 2020 2020 2020 2020 636f 6f72  ay..        coor
+0000fea0: 6469 6e61 7465 7320 6f66 2074 6865 2063  dinates of the c
+0000feb0: 7572 7665 206f 6e20 6120 6379 6c69 6e64  urve on a cylind
+0000fec0: 6572 2e20 6078 6020 616e 6420 6079 6020  er. `x` and `y` 
+0000fed0: 6d75 7374 206e 6f74 2062 6520 3020 6174  must not be 0 at
+0000fee0: 2074 6865 2073 616d 6520 7469 6d65 2e0d   the same time..
+0000fef0: 0a20 2020 2066 6c69 7020 3a20 626f 6f6c  .    flip : bool
+0000ff00: 0d0a 2020 2020 2020 2020 6966 2054 7275  ..        if Tru
+0000ff10: 652c 2066 6c69 7020 7468 6520 5820 6f66  e, flip the X of
+0000ff20: 2074 6865 2065 7874 7261 6374 6564 2070   the extracted p
+0000ff30: 6c61 6e65 2063 7572 7665 2e0d 0a20 2020  lane curve...   
+0000ff40: 206f 7269 6769 6e3a 2061 7272 6179 5f6c   origin: array_l
+0000ff50: 696b 650d 0a20 2020 2020 2020 2074 6865  ike..        the
+0000ff60: 2063 796c 696e 6465 7220 6f72 6967 696e   cylinder origin
+0000ff70: 2c20 5b78 302c 2079 305d 2028 6f72 205b  , [x0, y0] (or [
+0000ff80: 7830 2c20 7930 2c20 305d 292e 0d0a 0d0a  x0, y0, 0]).....
+0000ff90: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+0000ffa0: 202d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020   ---------..    
+0000ffb0: 582c 2059 2c20 5a20 3a20 206e 6461 7272  X, Y, Z :  ndarr
+0000ffc0: 6179 0d0a 2020 2020 2020 2020 636f 6f72  ay..        coor
+0000ffd0: 6469 6e61 7465 7320 6f66 2074 6865 2063  dinates of the c
+0000ffe0: 7572 7665 2062 656e 7420 746f 2074 6865  urve bent to the
+0000fff0: 2032 4420 582d 5920 706c 616e 650d 0a0d   2D X-Y plane...
+00010000: 0a20 2020 204e 6f74 6573 0d0a 2020 2020  .    Notes..    
+00010010: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00010020: 5468 6520 6379 6c69 6e64 6572 2773 2064  The cylinder's d
+00010030: 6566 6175 6c74 206f 7269 6769 6e20 6973  efault origin is
+00010040: 2060 2830 2c30 2c30 2960 2c20 6178 6973   `(0,0,0)`, axis
+00010050: 2069 7320 7a2d 6178 6973 2e0d 0a20 2020   is z-axis...   
+00010060: 200d 0a20 2020 2054 6865 206f 7269 6769   ..    The origi
+00010070: 6e20 6f66 2063 796c 696e 6465 7220 616e  n of cylinder an
+00010080: 6420 706c 616e 6520 6375 7276 6573 2069  d plane curves i
+00010090: 7320 7468 6520 7361 6d65 2028 302c 302c  s the same (0,0,
+000100a0: 3029 2e0d 0a20 2020 200d 0a20 2020 2043  0)...    ..    C
+000100b0: 796c 696e 6465 723a 2078 2c20 792c 207a  ylinder: x, y, z
+000100c0: 207e 7e20 722c 2074 6865 7461 2c20 7a20   ~~ r, theta, z 
+000100d0: 5c6e 0d0a 2020 2020 506c 616e 653a 2020  \n..    Plane:  
+000100e0: 2020 582c 2059 2c20 5a20 5c6e 0d0a 0d0a    X, Y, Z \n....
+000100f0: 2020 2020 7468 6574 6120 3d20 6172 6374      theta = arct
+00010100: 616e 2879 2f78 2920 5c6e 0d0a 2020 2020  an(y/x) \n..    
+00010110: 7220 3d20 7371 7274 2878 5e32 2b79 5e32  r = sqrt(x^2+y^2
+00010120: 2920 5c6e 0d0a 2020 2020 7a20 3d20 7a20  ) \n..    z = z 
+00010130: 5c6e 0d0a 0d0a 2020 2020 5820 3d20 722a  \n....    X = r*
+00010140: 7468 6574 6120 5c6e 0d0a 2020 2020 5920  theta \n..    Y 
+00010150: 3d20 7a20 5c6e 0d0a 2020 2020 5a20 3d20  = z \n..    Z = 
+00010160: 7220 5c6e 0d0a 2020 2020 2727 270d 0a20  r \n..    '''.. 
+00010170: 2020 2063 6f65 6620 3d20 2d31 2e30 2069     coef = -1.0 i
+00010180: 6620 666c 6970 2065 6c73 6520 312e 300d  f flip else 1.0.
+00010190: 0a0d 0a20 2020 2078 203d 2078 202d 206f  ...    x = x - o
+000101a0: 7269 6769 6e5b 305d 0d0a 2020 2020 7920  rigin[0]..    y 
+000101b0: 3d20 7920 2d20 6f72 6967 696e 5b31 5d0d  = y - origin[1].
+000101c0: 0a0d 0a20 2020 2072 7220 3d20 6e70 2e73  ...    rr = np.s
+000101d0: 7172 7428 782a 782b 792a 7929 0d0a 2020  qrt(x*x+y*y)..  
+000101e0: 2020 7474 203d 206e 702e 6172 6374 616e    tt = np.arctan
+000101f0: 3228 792c 2078 2920 2a20 636f 6566 0d0a  2(y, x) * coef..
+00010200: 0d0a 2020 2020 5820 3d20 7272 2a74 740d  ..    X = rr*tt.
+00010210: 0a20 2020 2059 203d 207a 2e63 6f70 7928  .    Y = z.copy(
+00010220: 290d 0a20 2020 205a 203d 2072 720d 0a0d  )..    Z = rr...
+00010230: 0a20 2020 2072 6574 7572 6e20 582c 2059  .    return X, Y
+00010240: 2c20 5a0d 0a0d 0a64 6566 2074 6f43 796c  , Z....def toCyl
+00010250: 696e 6465 7228 583a 206e 702e 6e64 6172  inder(X: np.ndar
+00010260: 7261 792c 2059 3a20 6e70 2e6e 6461 7272  ray, Y: np.ndarr
+00010270: 6179 2c20 5a3a 206e 702e 6e64 6172 7261  ay, Z: np.ndarra
+00010280: 792c 200d 0a20 2020 2020 2020 2020 2020  y, ..           
+00010290: 2020 2020 666c 6970 3d54 7275 652c 206f      flip=True, o
+000102a0: 7269 6769 6e3d 5b30 2c20 305d 2920 2d3e  rigin=[0, 0]) ->
+000102b0: 2054 7570 6c65 5b6e 702e 6e64 6172 7261   Tuple[np.ndarra
+000102c0: 792c 206e 702e 6e64 6172 7261 792c 206e  y, np.ndarray, n
+000102d0: 702e 6e64 6172 7261 795d 3a0d 0a20 2020  p.ndarray]:..   
+000102e0: 2027 2727 0d0a 2020 2020 4265 6e64 2074   '''..    Bend t
+000102f0: 6865 2070 6c61 6e65 2073 6563 7469 6f6e  he plane section
+00010300: 7320 746f 2063 7572 7665 7320 6f6e 2061  s to curves on a
+00010310: 2063 796c 696e 6465 722e 0d0a 0d0a 2020   cylinder.....  
+00010320: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00010330: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+00010340: 2020 582c 2059 2c20 5a20 3a20 6e64 6172    X, Y, Z : ndar
+00010350: 7261 790d 0a20 2020 2020 2020 2063 6f6f  ray..        coo
+00010360: 7264 696e 6174 6573 206f 6620 7468 6520  rdinates of the 
+00010370: 6375 7276 6520 6f6e 2061 2070 6c61 6e65  curve on a plane
+00010380: 2e20 605a 6020 6d75 7374 206e 6f74 2062  . `Z` must not b
+00010390: 6520 302e 0d0a 2020 2020 666c 6970 203a  e 0...    flip :
+000103a0: 2062 6f6f 6c0d 0a20 2020 2020 2020 2069   bool..        i
+000103b0: 6620 5472 7565 2c20 666c 6970 2074 6865  f True, flip the
+000103c0: 2058 206f 6620 7468 6520 6578 7472 6163   X of the extrac
+000103d0: 7465 6420 706c 616e 6520 6375 7276 652e  ted plane curve.
+000103e0: 0d0a 2020 2020 6f72 6967 696e 3a20 6172  ..    origin: ar
+000103f0: 7261 795f 6c69 6b65 0d0a 2020 2020 2020  ray_like..      
+00010400: 2020 7468 6520 6379 6c69 6e64 6572 206f    the cylinder o
+00010410: 7269 6769 6e2c 205b 7830 2c20 7930 5d20  rigin, [x0, y0] 
+00010420: 286f 7220 5b78 302c 2079 302c 2030 5d29  (or [x0, y0, 0])
+00010430: 2e0d 0a0d 0a20 2020 2052 6574 7572 6e73  .....    Returns
+00010440: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0d  ..    ---------.
+00010450: 0a20 2020 2078 2c20 7920 2c7a 203a 2020  .    x, y ,z :  
+00010460: 6e64 6172 7261 790d 0a20 2020 2020 2020  ndarray..       
+00010470: 2063 6f6f 7264 696e 6174 6573 206f 6620   coordinates of 
+00010480: 7468 6520 6375 7276 6520 6265 6e74 2074  the curve bent t
+00010490: 6f20 6120 6379 6c69 6e64 6572 2e0d 0a0d  o a cylinder....
+000104a0: 0a20 2020 204e 6f74 6573 0d0a 2020 2020  .    Notes..    
+000104b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+000104c0: 5468 6520 6379 6c69 6e64 6572 2773 2064  The cylinder's d
+000104d0: 6566 6175 6c74 206f 7269 6769 6e20 6973  efault origin is
+000104e0: 2060 2830 2c30 2c30 2960 2c20 6178 6973   `(0,0,0)`, axis
+000104f0: 2069 7320 7a2d 6178 6973 2e0d 0a20 2020   is z-axis...   
+00010500: 200d 0a20 2020 2054 6865 206f 7269 6769   ..    The origi
+00010510: 6e20 6f66 2063 796c 696e 6465 7220 616e  n of cylinder an
+00010520: 6420 706c 616e 6520 6375 7276 6573 2069  d plane curves i
+00010530: 7320 7468 6520 7361 6d65 2028 302c 302c  s the same (0,0,
+00010540: 3029 2e0d 0a20 2020 200d 0a20 2020 2043  0)...    ..    C
+00010550: 796c 696e 6465 723a 2078 2c20 792c 207a  ylinder: x, y, z
+00010560: 207e 7e20 722c 2074 6865 7461 2c20 7a20   ~~ r, theta, z 
+00010570: 5c6e 0d0a 2020 2020 506c 616e 653a 2020  \n..    Plane:  
+00010580: 2020 582c 2059 2c20 5a20 5c6e 0d0a 0d0a    X, Y, Z \n....
+00010590: 2020 2020 7468 6574 6120 3d20 6172 6374      theta = arct
+000105a0: 616e 2879 2f78 2920 5c6e 0d0a 2020 2020  an(y/x) \n..    
+000105b0: 7220 3d20 7371 7274 2878 5e32 2b79 5e32  r = sqrt(x^2+y^2
+000105c0: 2920 5c6e 0d0a 2020 2020 7a20 3d20 7a20  ) \n..    z = z 
+000105d0: 5c6e 0d0a 0d0a 2020 2020 5820 3d20 722a  \n....    X = r*
+000105e0: 7468 6574 6120 5c6e 0d0a 2020 2020 5920  theta \n..    Y 
+000105f0: 3d20 7a20 5c6e 0d0a 2020 2020 5a20 3d20  = z \n..    Z = 
+00010600: 7220 5c6e 0d0a 2020 2020 2727 270d 0a20  r \n..    '''.. 
+00010610: 2020 2063 6f65 6620 3d20 2d31 2e30 2069     coef = -1.0 i
+00010620: 6620 666c 6970 2065 6c73 6520 312e 300d  f flip else 1.0.
+00010630: 0a0d 0a20 2020 206e 6e20 3d20 582e 7368  ...    nn = X.sh
+00010640: 6170 655b 305d 0d0a 2020 2020 7820 3d20  ape[0]..    x = 
+00010650: 6e70 2e7a 6572 6f73 286e 6e29 0d0a 2020  np.zeros(nn)..  
+00010660: 2020 7920 3d20 6e70 2e7a 6572 6f73 286e    y = np.zeros(n
+00010670: 6e29 0d0a 2020 2020 7a20 3d20 592e 636f  n)..    z = Y.co
+00010680: 7079 2829 0d0a 0d0a 2020 2020 666f 7220  py()....    for 
+00010690: 6920 696e 2072 616e 6765 286e 6e29 3a0d  i in range(nn):.
+000106a0: 0a20 2020 2020 2020 2072 203d 205a 5b69  .        r = Z[i
+000106b0: 5d0d 0a20 2020 2020 2020 2074 6865 7461  ]..        theta
+000106c0: 203d 2058 5b69 5d2f 7220 2a20 636f 6566   = X[i]/r * coef
+000106d0: 0d0a 2020 2020 2020 2020 785b 695d 203d  ..        x[i] =
+000106e0: 2072 2a6e 702e 636f 7328 7468 6574 6129   r*np.cos(theta)
+000106f0: 0d0a 2020 2020 2020 2020 795b 695d 203d  ..        y[i] =
+00010700: 2072 2a6e 702e 7369 6e28 7468 6574 6129   r*np.sin(theta)
+00010710: 0d0a 0d0a 2020 2020 7820 3d20 7820 2b20  ....    x = x + 
+00010720: 6f72 6967 696e 5b30 5d0d 0a20 2020 2079  origin[0]..    y
+00010730: 203d 2079 202b 206f 7269 6769 6e5b 315d   = y + origin[1]
+00010740: 0d0a 0d0a 2020 2020 7265 7475 726e 2078  ....    return x
+00010750: 2c20 792c 207a 0d0a 0d0a 0d0a 232a 203d  , y, z......#* =
+00010760: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00010770: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00010780: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 232a  ============..#*
-00010790: 2049 6e74 6572 706f 6c61 7469 6f6e 0d0a   Interpolation..
-000107a0: 232a 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  #* =============
+00010780: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 232a 2049  ==========..#* I
+00010790: 6e74 6572 706f 6c61 7469 6f6e 0d0a 232a  nterpolation..#*
+000107a0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
 000107b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000107c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
-000107d0: 0d0a 6465 6620 696e 7465 7270 5f62 6173  ..def interp_bas
-000107e0: 6963 5f73 6563 2873 6563 303a 2042 6173  ic_sec(sec0: Bas
-000107f0: 6963 5365 6374 696f 6e2c 2073 6563 313a  icSection, sec1:
-00010800: 2042 6173 6963 5365 6374 696f 6e2c 2072   BasicSection, r
-00010810: 6174 696f 3a20 666c 6f61 7429 202d 3e20  atio: float) -> 
-00010820: 4261 7369 6353 6563 7469 6f6e 3a0d 0a20  BasicSection:.. 
-00010830: 2020 2027 2727 0d0a 2020 2020 496e 7465     '''..    Inte
-00010840: 7270 6f6c 6174 6520 6120 6261 7369 6320  rpolate a basic 
-00010850: 7365 6374 696f 6e20 6279 2072 6174 696f  section by ratio
-00010860: 2e0d 0a20 2020 200d 0a20 2020 2050 6172  ...    ..    Par
-00010870: 616d 6574 6572 730d 0a20 2020 202d 2d2d  ameters..    ---
-00010880: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2073  ---------..    s
-00010890: 6563 302c 2073 6563 3120 3a20 4261 7369  ec0, sec1 : Basi
-000108a0: 6353 6563 7469 6f6e 0d0a 2020 2020 2020  cSection..      
-000108b0: 2020 7365 6374 696f 6e73 2061 7420 626f    sections at bo
-000108c0: 7468 2065 6e64 732e 0d0a 2020 2020 7261  th ends...    ra
-000108d0: 7469 6f20 3a20 666c 6f61 740d 0a20 2020  tio : float..   
-000108e0: 2020 2020 2069 6e74 6572 706f 6c61 7469       interpolati
-000108f0: 6f6e 2072 6174 696f 2e0d 0a20 2020 200d  on ratio...    .
-00010900: 0a20 2020 2045 7861 6d70 6c65 730d 0a20  .    Examples.. 
-00010910: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00010920: 2d0d 0a20 2020 203e 3e3e 2073 6563 203d  -..    >>> sec =
-00010930: 2069 6e74 6572 705f 6261 7369 635f 7365   interp_basic_se
-00010940: 6328 7365 6330 2c20 7365 6331 2c20 7261  c(sec0, sec1, ra
-00010950: 7469 6f29 0d0a 2020 2020 2727 270d 0a20  tio)..    '''.. 
-00010960: 2020 200d 0a20 2020 2073 6563 203d 2063     ..    sec = c
-00010970: 6f70 792e 6465 6570 636f 7079 2873 6563  opy.deepcopy(sec
-00010980: 3029 0d0a 0d0a 2020 2020 7365 632e 784c  0)....    sec.xL
-00010990: 4520 2020 3d20 2831 2d72 6174 696f 292a  E   = (1-ratio)*
-000109a0: 7365 6330 2e78 4c45 2020 202b 2072 6174  sec0.xLE   + rat
-000109b0: 696f 2a73 6563 312e 784c 450d 0a20 2020  io*sec1.xLE..   
-000109c0: 2073 6563 2e79 4c45 2020 203d 2028 312d   sec.yLE   = (1-
-000109d0: 7261 7469 6f29 2a73 6563 302e 794c 4520  ratio)*sec0.yLE 
-000109e0: 2020 2b20 7261 7469 6f2a 7365 6331 2e79    + ratio*sec1.y
-000109f0: 4c45 0d0a 2020 2020 7365 632e 7a4c 4520  LE..    sec.zLE 
-00010a00: 2020 3d20 2831 2d72 6174 696f 292a 7365    = (1-ratio)*se
-00010a10: 6330 2e7a 4c45 2020 202b 2072 6174 696f  c0.zLE   + ratio
-00010a20: 2a73 6563 312e 7a4c 450d 0a20 2020 2073  *sec1.zLE..    s
-00010a30: 6563 2e63 686f 7264 203d 2028 312d 7261  ec.chord = (1-ra
-00010a40: 7469 6f29 2a73 6563 302e 6368 6f72 6420  tio)*sec0.chord 
-00010a50: 2b20 7261 7469 6f2a 7365 6331 2e63 686f  + ratio*sec1.cho
-00010a60: 7264 0d0a 2020 2020 7365 632e 7477 6973  rd..    sec.twis
-00010a70: 7420 3d20 2831 2d72 6174 696f 292a 7365  t = (1-ratio)*se
-00010a80: 6330 2e74 7769 7374 202b 2072 6174 696f  c0.twist + ratio
-00010a90: 2a73 6563 312e 7477 6973 740d 0a20 2020  *sec1.twist..   
-00010aa0: 2073 6563 2e74 6869 636b 203d 2028 312d   sec.thick = (1-
-00010ab0: 7261 7469 6f29 2a73 6563 302e 7468 6963  ratio)*sec0.thic
-00010ac0: 6b20 2b20 7261 7469 6f2a 7365 6331 2e74  k + ratio*sec1.t
-00010ad0: 6869 636b 0d0a 0d0a 2020 2020 7365 632e  hick....    sec.
-00010ae0: 7878 203d 2028 312d 7261 7469 6f29 2a73  xx = (1-ratio)*s
-00010af0: 6563 302e 7878 202b 2072 6174 696f 2a73  ec0.xx + ratio*s
-00010b00: 6563 312e 7878 0d0a 2020 2020 0d0a 2020  ec1.xx..    ..  
-00010b10: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00010b20: 7365 632e 7979 2c20 6e70 2e6e 6461 7272  sec.yy, np.ndarr
-00010b30: 6179 293a 0d0a 2020 2020 2020 2020 7365  ay):..        se
-00010b40: 632e 7979 203d 2028 312d 7261 7469 6f29  c.yy = (1-ratio)
-00010b50: 2a73 6563 302e 7979 202b 2072 6174 696f  *sec0.yy + ratio
-00010b60: 2a73 6563 312e 7979 0d0a 2020 2020 656c  *sec1.yy..    el
-00010b70: 7365 3a0d 0a20 2020 2020 2020 2073 6563  se:..        sec
-00010b80: 2e79 7520 3d20 2831 2d72 6174 696f 292a  .yu = (1-ratio)*
-00010b90: 7365 6330 2e79 7520 2b20 7261 7469 6f2a  sec0.yu + ratio*
-00010ba0: 7365 6331 2e79 750d 0a20 2020 2020 2020  sec1.yu..       
-00010bb0: 2073 6563 2e79 6c20 3d20 2831 2d72 6174   sec.yl = (1-rat
-00010bc0: 696f 292a 7365 6330 2e79 6c20 2b20 7261  io)*sec0.yl + ra
-00010bd0: 7469 6f2a 7365 6331 2e79 6c0d 0a0d 0a20  tio*sec1.yl.... 
-00010be0: 2020 2073 6563 2e78 2020 3d20 2831 2d72     sec.x  = (1-r
-00010bf0: 6174 696f 292a 7365 6330 2e78 202b 2072  atio)*sec0.x + r
-00010c00: 6174 696f 2a73 6563 312e 780d 0a20 2020  atio*sec1.x..   
-00010c10: 2073 6563 2e79 2020 3d20 2831 2d72 6174   sec.y  = (1-rat
-00010c20: 696f 292a 7365 6330 2e79 202b 2072 6174  io)*sec0.y + rat
-00010c30: 696f 2a73 6563 312e 790d 0a20 2020 2073  io*sec1.y..    s
-00010c40: 6563 2e7a 2020 3d20 2831 2d72 6174 696f  ec.z  = (1-ratio
-00010c50: 292a 7365 6330 2e7a 202b 2072 6174 696f  )*sec0.z + ratio
-00010c60: 2a73 6563 312e 7a0d 0a0d 0a20 2020 2072  *sec1.z....    r
-00010c70: 6574 7572 6e20 7365 630d 0a0d 0a64 6566  eturn sec....def
-00010c80: 2069 6e74 6572 705f 6672 6f6d 5f63 7572   interp_from_cur
-00010c90: 7665 2878 302c 2078 3a20 6e70 2e6e 6461  ve(x0, x: np.nda
-00010ca0: 7272 6179 2c20 793a 206e 702e 6e64 6172  rray, y: np.ndar
-00010cb0: 7261 7929 3a0d 0a20 2020 2027 2727 0d0a  ray):..    '''..
-00010cc0: 2020 2020 496e 7465 7270 6f6c 6174 6520      Interpolate 
-00010cd0: 706f 696e 7473 2066 726f 6d20 6375 7276  points from curv
-00010ce0: 6520 7265 7072 6573 656e 7465 6420 706f  e represented po
-00010cf0: 696e 7473 205b 782c 2079 5d2e 0d0a 2020  ints [x, y]...  
-00010d00: 2020 0d0a 2020 2020 5061 7261 6d65 7465    ..    Paramete
-00010d10: 7273 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  rs..    --------
-00010d20: 2d2d 0d0a 2020 2020 7830 203a 2066 6c6f  --..    x0 : flo
-00010d30: 6174 206f 7220 6e64 6172 7261 790d 0a20  at or ndarray.. 
-00010d40: 2020 2020 2020 206e 6461 7272 6179 2f76         ndarray/v
-00010d50: 616c 7565 206f 6620 7820 6c6f 6361 7469  alue of x locati
-00010d60: 6f6e 7320 746f 2062 6520 696e 7465 7270  ons to be interp
-00010d70: 6f6c 6174 6564 2e0d 0a20 2020 2078 2c20  olated...    x, 
-00010d80: 7920 3a20 6e64 6172 7261 790d 0a20 2020  y : ndarray..   
-00010d90: 2020 2020 2063 6f6f 7264 696e 6174 6573       coordinates
-00010da0: 206f 6620 7468 6520 6375 7276 652e 0d0a   of the curve...
-00010db0: 0d0a 2020 2020 5265 7475 726e 730d 0a20  ..    Returns.. 
-00010dc0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-00010dd0: 2020 2079 3020 3a20 666c 6f61 7420 6f72     y0 : float or
-00010de0: 206e 6461 7272 6179 0d0a 2020 2020 2020   ndarray..      
-00010df0: 2020 696e 7465 7270 6f6c 6174 6564 2063    interpolated c
-00010e00: 6f6f 7264 696e 6174 6573 0d0a 0d0a 2020  oordinates....  
-00010e10: 2020 4578 616d 706c 6573 0d0a 2020 2020    Examples..    
-00010e20: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 203e  ---------..    >
-00010e30: 3e3e 2079 3020 3d20 696e 7465 7270 5f66  >> y0 = interp_f
-00010e40: 726f 6d5f 6375 7276 6528 7830 2c20 782c  rom_curve(x0, x,
-00010e50: 2079 290d 0a20 2020 2027 2727 0d0a 2020   y)..    '''..  
-00010e60: 2020 6620 203d 2069 6e74 6572 7031 6428    f  = interp1d(
-00010e70: 782c 2079 2c20 6b69 6e64 3d27 6375 6269  x, y, kind='cubi
-00010e80: 6327 290d 0a20 2020 2079 3020 3d20 6628  c')..    y0 = f(
-00010e90: 7830 290d 0a0d 0a20 2020 2072 6574 7572  x0)....    retur
-00010ea0: 6e20 7930 0d0a 0d0a 6465 6620 696e 7465  n y0....def inte
-00010eb0: 7270 6f6c 6174 655f 4944 5728 7830 3a20  rpolate_IDW(x0: 
-00010ec0: 6e70 2e6e 6461 7272 6179 2c20 7873 3a20  np.ndarray, xs: 
-00010ed0: 6e70 2e6e 6461 7272 6179 2c20 7973 3a20  np.ndarray, ys: 
-00010ee0: 6e70 2e6e 6461 7272 6179 2c20 6570 733d  np.ndarray, eps=
-00010ef0: 3165 2d31 3029 202d 3e20 6e70 2e6e 6461  1e-10) -> np.nda
-00010f00: 7272 6179 3a0d 0a20 2020 2027 2727 0d0a  rray:..    '''..
-00010f10: 2020 2020 496e 7665 7273 6520 6469 7374      Inverse dist
-00010f20: 616e 6365 2077 6569 6768 7465 6420 696e  ance weighted in
-00010f30: 7465 7270 6f6c 6174 696f 6e2e 0d0a 2020  terpolation...  
-00010f40: 2020 0d0a 2020 2020 5061 7261 6d65 7465    ..    Paramete
-00010f50: 7273 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  rs..    --------
-00010f60: 2d2d 0d0a 2020 2020 7830 203a 206e 6461  --..    x0 : nda
-00010f70: 7272 6179 0d0a 2020 2020 2020 2020 636f  rray..        co
-00010f80: 6f72 6469 6e61 7465 7320 746f 2062 6520  ordinates to be 
-00010f90: 696e 7465 7270 6f6c 6174 6564 2c20 7368  interpolated, sh
-00010fa0: 6170 6520 5b6e 302c 335d 2e0d 0a20 2020  ape [n0,3]...   
-00010fb0: 2078 7320 3a20 6e64 6172 7261 790d 0a20   xs : ndarray.. 
-00010fc0: 2020 2020 2020 2063 6f6f 7264 696e 6174         coordinat
-00010fd0: 6573 206f 6620 7468 6520 7265 6665 7265  es of the refere
-00010fe0: 6e63 6520 706f 696e 7473 2c20 7368 6170  nce points, shap
-00010ff0: 6520 5b6e 2c20 335d 2e0d 0a20 2020 2079  e [n, 3]...    y
-00011000: 7320 3a20 6e64 6172 7261 790d 0a20 2020  s : ndarray..   
-00011010: 2020 2020 2076 616c 7565 7320 6174 2074       values at t
-00011020: 6865 2072 6566 6572 656e 6365 2070 6f69  he reference poi
-00011030: 6e74 732c 2073 6861 7065 205b 6e2c 206e  nts, shape [n, n
-00011040: 795d 2e0d 0a20 2020 2065 7073 203a 2066  y]...    eps : f
-00011050: 6c6f 6174 0d0a 2020 2020 2020 2020 6372  loat..        cr
-00011060: 6974 6963 616c 2064 6973 7461 6e63 6520  itical distance 
-00011070: 6265 7477 6565 6e20 6078 3060 2074 6f20  between `x0` to 
-00011080: 6078 7360 2e0d 0a20 2020 2020 2020 200d  `xs`...        .
-00011090: 0a20 2020 2052 6574 7572 6e73 0d0a 2020  .    Returns..  
-000110a0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-000110b0: 2020 7930 203a 206e 6461 7272 6179 0d0a    y0 : ndarray..
-000110c0: 2020 2020 2020 2020 696e 7465 7270 6f6c          interpol
-000110d0: 6174 6564 2076 616c 7565 732c 2073 6861  ated values, sha
-000110e0: 7065 205b 6e30 2c6e 795d 2e0d 0a20 2020  pe [n0,ny]...   
-000110f0: 200d 0a20 2020 2045 7861 6d70 6c65 730d   ..    Examples.
-00011100: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 0d0a  .    ---------..
-00011110: 2020 2020 3e3e 3e20 7930 203d 2069 6e74      >>> y0 = int
-00011120: 6572 706f 6c61 7465 5f49 4457 2878 302c  erpolate_IDW(x0,
-00011130: 2078 732c 2079 732c 2065 7073 3d31 652d   xs, ys, eps=1e-
-00011140: 3130 290d 0a20 2020 200d 0a20 2020 2027  10)..    ..    '
-00011150: 2727 0d0a 2020 2020 6e30 203d 2078 302e  ''..    n0 = x0.
-00011160: 7368 6170 655b 305d 0d0a 2020 2020 6e20  shape[0]..    n 
-00011170: 203d 2078 732e 7368 6170 655b 305d 0d0a   = xs.shape[0]..
-00011180: 2020 2020 6e79 203d 2079 732e 7368 6170      ny = ys.shap
-00011190: 655b 315d 0d0a 2020 2020 7930 203d 206e  e[1]..    y0 = n
-000111a0: 702e 7a65 726f 7328 5b6e 302c 6e79 5d29  p.zeros([n0,ny])
-000111b0: 0d0a 2020 2020 6473 203d 2064 6973 5f6d  ..    ds = dis_m
-000111c0: 6174 7269 7828 7830 2c20 7873 2920 2320  atrix(x0, xs) # 
-000111d0: 5b6e 302c 206e 5d0d 0a20 2020 200d 0a20  [n0, n]..    .. 
-000111e0: 2020 2066 6f72 2069 3020 696e 2072 616e     for i0 in ran
-000111f0: 6765 286e 3029 3a0d 0a20 2020 2020 2020  ge(n0):..       
-00011200: 200d 0a20 2020 2020 2020 2069 6620 6e70   ..        if np
-00011210: 2e6d 696e 2864 735b 6930 2c3a 5d29 203c  .min(ds[i0,:]) <
-00011220: 3d20 6570 733a 0d0a 2020 2020 2020 2020  = eps:..        
-00011230: 2020 2020 6a20 3d20 6e70 2e61 7267 6d69      j = np.argmi
-00011240: 6e28 6473 5b69 302c 3a5d 290d 0a20 2020  n(ds[i0,:])..   
-00011250: 2020 2020 2020 2020 2079 305b 6930 2c3a           y0[i0,:
-00011260: 5d20 3d20 7973 5b6a 2c3a 5d0d 0a20 2020  ] = ys[j,:]..   
-00011270: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-00011280: 650d 0a20 2020 2020 2020 200d 0a20 2020  e..        ..   
-00011290: 2020 2020 2077 7320 3d20 6473 5b69 302c       ws = ds[i0,
-000112a0: 3a5d 2a2a 2d31 2020 2023 205b 6e5d 0d0a  :]**-1   # [n]..
-000112b0: 2020 2020 2020 2020 775f 616c 6c20 3d20          w_all = 
-000112c0: 6e70 2e73 756d 2877 7329 2020 2320 666c  np.sum(ws)  # fl
-000112d0: 6f61 740d 0a20 2020 2020 2020 2079 305b  oat..        y0[
-000112e0: 6930 2c3a 5d20 3d20 6e70 2e64 6f74 286e  i0,:] = np.dot(n
-000112f0: 702e 7472 616e 7370 6f73 6528 7973 292c  p.transpose(ys),
-00011300: 2077 7329 2f77 5f61 6c6c 0d0a 2020 2020   ws)/w_all..    
-00011310: 2020 2020 0d0a 2020 2020 7265 7475 726e      ..    return
-00011320: 2079 300d 0a0d 0a64 6566 2070 6c61 6e65   y0....def plane
-00011330: 5f33 706f 696e 7473 2850 303a 206e 702e  _3points(P0: np.
-00011340: 6e64 6172 7261 792c 2050 313a 206e 702e  ndarray, P1: np.
-00011350: 6e64 6172 7261 792c 2050 333a 206e 702e  ndarray, P3: np.
-00011360: 6e64 6172 7261 792c 2078 733a 206e 702e  ndarray, xs: np.
-00011370: 6e64 6172 7261 792c 2079 733a 206e 702e  ndarray, ys: np.
-00011380: 6e64 6172 7261 7929 202d 3e20 6e70 2e6e  ndarray) -> np.n
-00011390: 6461 7272 6179 3a0d 0a20 2020 2027 2727  darray:..    '''
-000113a0: 0d0a 2020 2020 4361 6c63 756c 6174 6520  ..    Calculate 
-000113b0: 7468 6520 706c 616e 6520 6675 6e63 7469  the plane functi
-000113c0: 6f6e 2061 6e64 2074 6865 2063 6f6f 7264  on and the coord
-000113d0: 696e 6174 6573 206f 6620 6769 7665 6e20  inates of given 
-000113e0: 706f 696e 7473 2028 6078 7360 2c20 6079  points (`xs`, `y
-000113f0: 7360 292e 0d0a 2020 2020 0d0a 2020 2020  s`)...    ..    
-00011400: 5468 6520 706c 616e 6520 6675 6e63 7469  The plane functi
-00011410: 6f6e 2069 7320 6061 2a78 2b62 2a79 2b63  on is `a*x+b*y+c
-00011420: 2a7a 2b64 3d30 602e 0d0a 2020 2020 0d0a  *z+d=0`...    ..
-00011430: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-00011440: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00011450: 2d0d 0a20 2020 2050 302c 2050 312c 2050  -..    P0, P1, P
-00011460: 3320 3a20 6e64 6172 7261 7920 5b33 5d0d  3 : ndarray [3].
-00011470: 0a20 2020 2020 2020 2063 6f6f 7264 696e  .        coordin
-00011480: 6174 6573 206f 6620 7468 7265 6520 706f  ates of three po
-00011490: 696e 7473 206f 6620 706c 616e 6520 5030  ints of plane P0
-000114a0: 3132 332e 0d0a 2020 2020 7873 2c20 7973  123...    xs, ys
-000114b0: 203a 206e 6461 7272 6179 205b 3a5d 206f   : ndarray [:] o
-000114c0: 7220 5b3a 2c3a 5d0d 0a20 2020 2020 2020  r [:,:]..       
-000114d0: 2058 2061 6e64 2059 2063 6f6f 7264 696e   X and Y coordin
-000114e0: 6174 6573 206f 6620 706c 616e 6520 706f  ates of plane po
-000114f0: 696e 7473 2e0d 0a20 2020 200d 0a20 2020  ints...    ..   
-00011500: 2052 6574 7572 6e73 0d0a 2020 2020 2d2d   Returns..    --
-00011510: 2d2d 2d2d 2d0d 0a20 2020 207a 7320 3a20  -----..    zs : 
-00011520: 6e64 6172 7261 7920 5b3a 5d20 6f72 205b  ndarray [:] or [
-00011530: 3a2c 3a5d 0d0a 2020 2020 0d0a 2020 2020  :,:]..    ..    
-00011540: 4578 616d 706c 6573 0d0a 2020 2020 2d2d  Examples..    --
-00011550: 2d2d 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e  -------..    >>>
-00011560: 2078 7320 3d20 706c 616e 655f 3370 6f69   xs = plane_3poi
-00011570: 6e74 7328 5030 2c20 5031 2c20 5033 2c20  nts(P0, P1, P3, 
-00011580: 7873 2c20 7973 290d 0a20 2020 2027 2727  xs, ys)..    '''
-00011590: 0d0a 2020 2020 6131 203d 2050 315b 305d  ..    a1 = P1[0]
-000115a0: 202d 2050 305b 305d 0d0a 2020 2020 6231   - P0[0]..    b1
-000115b0: 203d 2050 315b 315d 202d 2050 305b 315d   = P1[1] - P0[1]
-000115c0: 0d0a 2020 2020 6331 203d 2050 315b 325d  ..    c1 = P1[2]
-000115d0: 202d 2050 305b 325d 0d0a 2020 2020 6132   - P0[2]..    a2
-000115e0: 203d 2050 335b 305d 202d 2050 305b 305d   = P3[0] - P0[0]
-000115f0: 0d0a 2020 2020 6232 203d 2050 335b 315d  ..    b2 = P3[1]
-00011600: 202d 2050 305b 315d 0d0a 2020 2020 6332   - P0[1]..    c2
-00011610: 203d 2050 335b 325d 202d 2050 305b 325d   = P3[2] - P0[2]
-00011620: 0d0a 2020 2020 6120 3d20 6231 202a 2063  ..    a = b1 * c
-00011630: 3220 2d20 6232 202a 2063 310d 0a20 2020  2 - b2 * c1..   
-00011640: 2062 203d 2061 3220 2a20 6331 202d 2061   b = a2 * c1 - a
-00011650: 3120 2a20 6332 0d0a 2020 2020 6320 3d20  1 * c2..    c = 
-00011660: 6131 202a 2062 3220 2d20 6231 202a 2061  a1 * b2 - b1 * a
-00011670: 320d 0a20 2020 2064 203d 2028 2d20 6120  2..    d = (- a 
-00011680: 2a20 5030 5b30 5d20 2d20 6220 2a20 5030  * P0[0] - b * P0
-00011690: 5b31 5d20 2d20 6320 2a20 5030 5b32 5d29  [1] - c * P0[2])
-000116a0: 0d0a 2020 2020 0d0a 2020 2020 6966 2063  ..    ..    if c
-000116b0: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
-000116c0: 7265 7475 726e 206e 702e 7a65 726f 735f  return np.zeros_
-000116d0: 6c69 6b65 2878 7329 0d0a 2020 2020 656c  like(xs)..    el
-000116e0: 7365 3a0d 0a20 2020 2020 2020 2072 6574  se:..        ret
-000116f0: 7572 6e20 2861 2a78 732b 622a 7973 2b64  urn (a*xs+b*ys+d
-00011700: 292f 282d 6329 0d0a 2020 2020 0d0a 2020  )/(-c)..    ..  
-00011710: 2020 0d0a 232a 203d 3d3d 3d3d 3d3d 3d3d    ..#* =========
+000107c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 0d0a  ============....
+000107d0: 6465 6620 696e 7465 7270 5f62 6173 6963  def interp_basic
+000107e0: 5f73 6563 2873 6563 303a 2042 6173 6963  _sec(sec0: Basic
+000107f0: 5365 6374 696f 6e2c 2073 6563 313a 2042  Section, sec1: B
+00010800: 6173 6963 5365 6374 696f 6e2c 2072 6174  asicSection, rat
+00010810: 696f 3a20 666c 6f61 7429 202d 3e20 4261  io: float) -> Ba
+00010820: 7369 6353 6563 7469 6f6e 3a0d 0a20 2020  sicSection:..   
+00010830: 2027 2727 0d0a 2020 2020 496e 7465 7270   '''..    Interp
+00010840: 6f6c 6174 6520 6120 6261 7369 6320 7365  olate a basic se
+00010850: 6374 696f 6e20 6279 2072 6174 696f 2e0d  ction by ratio..
+00010860: 0a20 2020 200d 0a20 2020 2050 6172 616d  .    ..    Param
+00010870: 6574 6572 730d 0a20 2020 202d 2d2d 2d2d  eters..    -----
+00010880: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2073 6563  -------..    sec
+00010890: 302c 2073 6563 3120 3a20 4261 7369 6353  0, sec1 : BasicS
+000108a0: 6563 7469 6f6e 0d0a 2020 2020 2020 2020  ection..        
+000108b0: 7365 6374 696f 6e73 2061 7420 626f 7468  sections at both
+000108c0: 2065 6e64 732e 0d0a 2020 2020 7261 7469   ends...    rati
+000108d0: 6f20 3a20 666c 6f61 740d 0a20 2020 2020  o : float..     
+000108e0: 2020 2069 6e74 6572 706f 6c61 7469 6f6e     interpolation
+000108f0: 2072 6174 696f 2e0d 0a20 2020 200d 0a20   ratio...    .. 
+00010900: 2020 2045 7861 6d70 6c65 730d 0a20 2020     Examples..   
+00010910: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d   --------------.
+00010920: 0a20 2020 203e 3e3e 2073 6563 203d 2069  .    >>> sec = i
+00010930: 6e74 6572 705f 6261 7369 635f 7365 6328  nterp_basic_sec(
+00010940: 7365 6330 2c20 7365 6331 2c20 7261 7469  sec0, sec1, rati
+00010950: 6f29 0d0a 2020 2020 2727 270d 0a20 2020  o)..    '''..   
+00010960: 200d 0a20 2020 2073 6563 203d 2063 6f70   ..    sec = cop
+00010970: 792e 6465 6570 636f 7079 2873 6563 3029  y.deepcopy(sec0)
+00010980: 0d0a 0d0a 2020 2020 7365 632e 784c 4520  ....    sec.xLE 
+00010990: 2020 3d20 2831 2d72 6174 696f 292a 7365    = (1-ratio)*se
+000109a0: 6330 2e78 4c45 2020 202b 2072 6174 696f  c0.xLE   + ratio
+000109b0: 2a73 6563 312e 784c 450d 0a20 2020 2073  *sec1.xLE..    s
+000109c0: 6563 2e79 4c45 2020 203d 2028 312d 7261  ec.yLE   = (1-ra
+000109d0: 7469 6f29 2a73 6563 302e 794c 4520 2020  tio)*sec0.yLE   
+000109e0: 2b20 7261 7469 6f2a 7365 6331 2e79 4c45  + ratio*sec1.yLE
+000109f0: 0d0a 2020 2020 7365 632e 7a4c 4520 2020  ..    sec.zLE   
+00010a00: 3d20 2831 2d72 6174 696f 292a 7365 6330  = (1-ratio)*sec0
+00010a10: 2e7a 4c45 2020 202b 2072 6174 696f 2a73  .zLE   + ratio*s
+00010a20: 6563 312e 7a4c 450d 0a20 2020 2073 6563  ec1.zLE..    sec
+00010a30: 2e63 686f 7264 203d 2028 312d 7261 7469  .chord = (1-rati
+00010a40: 6f29 2a73 6563 302e 6368 6f72 6420 2b20  o)*sec0.chord + 
+00010a50: 7261 7469 6f2a 7365 6331 2e63 686f 7264  ratio*sec1.chord
+00010a60: 0d0a 2020 2020 7365 632e 7477 6973 7420  ..    sec.twist 
+00010a70: 3d20 2831 2d72 6174 696f 292a 7365 6330  = (1-ratio)*sec0
+00010a80: 2e74 7769 7374 202b 2072 6174 696f 2a73  .twist + ratio*s
+00010a90: 6563 312e 7477 6973 740d 0a20 2020 2073  ec1.twist..    s
+00010aa0: 6563 2e74 6869 636b 203d 2028 312d 7261  ec.thick = (1-ra
+00010ab0: 7469 6f29 2a73 6563 302e 7468 6963 6b20  tio)*sec0.thick 
+00010ac0: 2b20 7261 7469 6f2a 7365 6331 2e74 6869  + ratio*sec1.thi
+00010ad0: 636b 0d0a 0d0a 2020 2020 7365 632e 7878  ck....    sec.xx
+00010ae0: 203d 2028 312d 7261 7469 6f29 2a73 6563   = (1-ratio)*sec
+00010af0: 302e 7878 202b 2072 6174 696f 2a73 6563  0.xx + ratio*sec
+00010b00: 312e 7878 0d0a 2020 2020 0d0a 2020 2020  1.xx..    ..    
+00010b10: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
+00010b20: 632e 7979 2c20 6e70 2e6e 6461 7272 6179  c.yy, np.ndarray
+00010b30: 293a 0d0a 2020 2020 2020 2020 7365 632e  ):..        sec.
+00010b40: 7979 203d 2028 312d 7261 7469 6f29 2a73  yy = (1-ratio)*s
+00010b50: 6563 302e 7979 202b 2072 6174 696f 2a73  ec0.yy + ratio*s
+00010b60: 6563 312e 7979 0d0a 2020 2020 656c 7365  ec1.yy..    else
+00010b70: 3a0d 0a20 2020 2020 2020 2073 6563 2e79  :..        sec.y
+00010b80: 7520 3d20 2831 2d72 6174 696f 292a 7365  u = (1-ratio)*se
+00010b90: 6330 2e79 7520 2b20 7261 7469 6f2a 7365  c0.yu + ratio*se
+00010ba0: 6331 2e79 750d 0a20 2020 2020 2020 2073  c1.yu..        s
+00010bb0: 6563 2e79 6c20 3d20 2831 2d72 6174 696f  ec.yl = (1-ratio
+00010bc0: 292a 7365 6330 2e79 6c20 2b20 7261 7469  )*sec0.yl + rati
+00010bd0: 6f2a 7365 6331 2e79 6c0d 0a0d 0a20 2020  o*sec1.yl....   
+00010be0: 2073 6563 2e78 2020 3d20 2831 2d72 6174   sec.x  = (1-rat
+00010bf0: 696f 292a 7365 6330 2e78 202b 2072 6174  io)*sec0.x + rat
+00010c00: 696f 2a73 6563 312e 780d 0a20 2020 2073  io*sec1.x..    s
+00010c10: 6563 2e79 2020 3d20 2831 2d72 6174 696f  ec.y  = (1-ratio
+00010c20: 292a 7365 6330 2e79 202b 2072 6174 696f  )*sec0.y + ratio
+00010c30: 2a73 6563 312e 790d 0a20 2020 2073 6563  *sec1.y..    sec
+00010c40: 2e7a 2020 3d20 2831 2d72 6174 696f 292a  .z  = (1-ratio)*
+00010c50: 7365 6330 2e7a 202b 2072 6174 696f 2a73  sec0.z + ratio*s
+00010c60: 6563 312e 7a0d 0a0d 0a20 2020 2072 6574  ec1.z....    ret
+00010c70: 7572 6e20 7365 630d 0a0d 0a64 6566 2069  urn sec....def i
+00010c80: 6e74 6572 705f 6672 6f6d 5f63 7572 7665  nterp_from_curve
+00010c90: 2878 302c 2078 3a20 6e70 2e6e 6461 7272  (x0, x: np.ndarr
+00010ca0: 6179 2c20 793a 206e 702e 6e64 6172 7261  ay, y: np.ndarra
+00010cb0: 7929 3a0d 0a20 2020 2027 2727 0d0a 2020  y):..    '''..  
+00010cc0: 2020 496e 7465 7270 6f6c 6174 6520 706f    Interpolate po
+00010cd0: 696e 7473 2066 726f 6d20 6375 7276 6520  ints from curve 
+00010ce0: 7265 7072 6573 656e 7465 6420 706f 696e  represented poin
+00010cf0: 7473 205b 782c 2079 5d2e 0d0a 2020 2020  ts [x, y]...    
+00010d00: 0d0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00010d10: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
+00010d20: 0d0a 2020 2020 7830 203a 2066 6c6f 6174  ..    x0 : float
+00010d30: 206f 7220 6e64 6172 7261 790d 0a20 2020   or ndarray..   
+00010d40: 2020 2020 206e 6461 7272 6179 2f76 616c       ndarray/val
+00010d50: 7565 206f 6620 7820 6c6f 6361 7469 6f6e  ue of x location
+00010d60: 7320 746f 2062 6520 696e 7465 7270 6f6c  s to be interpol
+00010d70: 6174 6564 2e0d 0a20 2020 2078 2c20 7920  ated...    x, y 
+00010d80: 3a20 6e64 6172 7261 790d 0a20 2020 2020  : ndarray..     
+00010d90: 2020 2063 6f6f 7264 696e 6174 6573 206f     coordinates o
+00010da0: 6620 7468 6520 6375 7276 652e 0d0a 0d0a  f the curve.....
+00010db0: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+00010dc0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+00010dd0: 2079 3020 3a20 666c 6f61 7420 6f72 206e   y0 : float or n
+00010de0: 6461 7272 6179 0d0a 2020 2020 2020 2020  darray..        
+00010df0: 696e 7465 7270 6f6c 6174 6564 2063 6f6f  interpolated coo
+00010e00: 7264 696e 6174 6573 0d0a 0d0a 2020 2020  rdinates....    
+00010e10: 4578 616d 706c 6573 0d0a 2020 2020 2d2d  Examples..    --
+00010e20: 2d2d 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e  -------..    >>>
+00010e30: 2079 3020 3d20 696e 7465 7270 5f66 726f   y0 = interp_fro
+00010e40: 6d5f 6375 7276 6528 7830 2c20 782c 2079  m_curve(x0, x, y
+00010e50: 290d 0a20 2020 2027 2727 0d0a 2020 2020  )..    '''..    
+00010e60: 6620 203d 2069 6e74 6572 7031 6428 782c  f  = interp1d(x,
+00010e70: 2079 2c20 6b69 6e64 3d27 6375 6269 6327   y, kind='cubic'
+00010e80: 290d 0a20 2020 2079 3020 3d20 6628 7830  )..    y0 = f(x0
+00010e90: 290d 0a0d 0a20 2020 2072 6574 7572 6e20  )....    return 
+00010ea0: 7930 0d0a 0d0a 6465 6620 696e 7465 7270  y0....def interp
+00010eb0: 6f6c 6174 655f 4944 5728 7830 3a20 6e70  olate_IDW(x0: np
+00010ec0: 2e6e 6461 7272 6179 2c20 7873 3a20 6e70  .ndarray, xs: np
+00010ed0: 2e6e 6461 7272 6179 2c20 7973 3a20 6e70  .ndarray, ys: np
+00010ee0: 2e6e 6461 7272 6179 2c20 6570 733d 3165  .ndarray, eps=1e
+00010ef0: 2d31 3029 202d 3e20 6e70 2e6e 6461 7272  -10) -> np.ndarr
+00010f00: 6179 3a0d 0a20 2020 2027 2727 0d0a 2020  ay:..    '''..  
+00010f10: 2020 496e 7665 7273 6520 6469 7374 616e    Inverse distan
+00010f20: 6365 2077 6569 6768 7465 6420 696e 7465  ce weighted inte
+00010f30: 7270 6f6c 6174 696f 6e2e 0d0a 2020 2020  rpolation...    
+00010f40: 0d0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00010f50: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
+00010f60: 0d0a 2020 2020 7830 203a 206e 6461 7272  ..    x0 : ndarr
+00010f70: 6179 0d0a 2020 2020 2020 2020 636f 6f72  ay..        coor
+00010f80: 6469 6e61 7465 7320 746f 2062 6520 696e  dinates to be in
+00010f90: 7465 7270 6f6c 6174 6564 2c20 7368 6170  terpolated, shap
+00010fa0: 6520 5b6e 302c 335d 2e0d 0a20 2020 2078  e [n0,3]...    x
+00010fb0: 7320 3a20 6e64 6172 7261 790d 0a20 2020  s : ndarray..   
+00010fc0: 2020 2020 2063 6f6f 7264 696e 6174 6573       coordinates
+00010fd0: 206f 6620 7468 6520 7265 6665 7265 6e63   of the referenc
+00010fe0: 6520 706f 696e 7473 2c20 7368 6170 6520  e points, shape 
+00010ff0: 5b6e 2c20 335d 2e0d 0a20 2020 2079 7320  [n, 3]...    ys 
+00011000: 3a20 6e64 6172 7261 790d 0a20 2020 2020  : ndarray..     
+00011010: 2020 2076 616c 7565 7320 6174 2074 6865     values at the
+00011020: 2072 6566 6572 656e 6365 2070 6f69 6e74   reference point
+00011030: 732c 2073 6861 7065 205b 6e2c 206e 795d  s, shape [n, ny]
+00011040: 2e0d 0a20 2020 2065 7073 203a 2066 6c6f  ...    eps : flo
+00011050: 6174 0d0a 2020 2020 2020 2020 6372 6974  at..        crit
+00011060: 6963 616c 2064 6973 7461 6e63 6520 6265  ical distance be
+00011070: 7477 6565 6e20 6078 3060 2074 6f20 6078  tween `x0` to `x
+00011080: 7360 2e0d 0a20 2020 2020 2020 200d 0a20  s`...        .. 
+00011090: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+000110a0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+000110b0: 7930 203a 206e 6461 7272 6179 0d0a 2020  y0 : ndarray..  
+000110c0: 2020 2020 2020 696e 7465 7270 6f6c 6174        interpolat
+000110d0: 6564 2076 616c 7565 732c 2073 6861 7065  ed values, shape
+000110e0: 205b 6e30 2c6e 795d 2e0d 0a20 2020 200d   [n0,ny]...    .
+000110f0: 0a20 2020 2045 7861 6d70 6c65 730d 0a20  .    Examples.. 
+00011100: 2020 202d 2d2d 2d2d 2d2d 2d2d 0d0a 2020     ---------..  
+00011110: 2020 3e3e 3e20 7930 203d 2069 6e74 6572    >>> y0 = inter
+00011120: 706f 6c61 7465 5f49 4457 2878 302c 2078  polate_IDW(x0, x
+00011130: 732c 2079 732c 2065 7073 3d31 652d 3130  s, ys, eps=1e-10
+00011140: 290d 0a20 2020 200d 0a20 2020 2027 2727  )..    ..    '''
+00011150: 0d0a 2020 2020 6e30 203d 2078 302e 7368  ..    n0 = x0.sh
+00011160: 6170 655b 305d 0d0a 2020 2020 6e20 203d  ape[0]..    n  =
+00011170: 2078 732e 7368 6170 655b 305d 0d0a 2020   xs.shape[0]..  
+00011180: 2020 6e79 203d 2079 732e 7368 6170 655b    ny = ys.shape[
+00011190: 315d 0d0a 2020 2020 7930 203d 206e 702e  1]..    y0 = np.
+000111a0: 7a65 726f 7328 5b6e 302c 6e79 5d29 0d0a  zeros([n0,ny])..
+000111b0: 2020 2020 6473 203d 2064 6973 5f6d 6174      ds = dis_mat
+000111c0: 7269 7828 7830 2c20 7873 2920 2320 5b6e  rix(x0, xs) # [n
+000111d0: 302c 206e 5d0d 0a20 2020 200d 0a20 2020  0, n]..    ..   
+000111e0: 2066 6f72 2069 3020 696e 2072 616e 6765   for i0 in range
+000111f0: 286e 3029 3a0d 0a20 2020 2020 2020 200d  (n0):..        .
+00011200: 0a20 2020 2020 2020 2069 6620 6e70 2e6d  .        if np.m
+00011210: 696e 2864 735b 6930 2c3a 5d29 203c 3d20  in(ds[i0,:]) <= 
+00011220: 6570 733a 0d0a 2020 2020 2020 2020 2020  eps:..          
+00011230: 2020 6a20 3d20 6e70 2e61 7267 6d69 6e28    j = np.argmin(
+00011240: 6473 5b69 302c 3a5d 290d 0a20 2020 2020  ds[i0,:])..     
+00011250: 2020 2020 2020 2079 305b 6930 2c3a 5d20         y0[i0,:] 
+00011260: 3d20 7973 5b6a 2c3a 5d0d 0a20 2020 2020  = ys[j,:]..     
+00011270: 2020 2020 2020 2063 6f6e 7469 6e75 650d         continue.
+00011280: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00011290: 2020 2077 7320 3d20 6473 5b69 302c 3a5d     ws = ds[i0,:]
+000112a0: 2a2a 2d31 2020 2023 205b 6e5d 0d0a 2020  **-1   # [n]..  
+000112b0: 2020 2020 2020 775f 616c 6c20 3d20 6e70        w_all = np
+000112c0: 2e73 756d 2877 7329 2020 2320 666c 6f61  .sum(ws)  # floa
+000112d0: 740d 0a20 2020 2020 2020 2079 305b 6930  t..        y0[i0
+000112e0: 2c3a 5d20 3d20 6e70 2e64 6f74 286e 702e  ,:] = np.dot(np.
+000112f0: 7472 616e 7370 6f73 6528 7973 292c 2077  transpose(ys), w
+00011300: 7329 2f77 5f61 6c6c 0d0a 2020 2020 2020  s)/w_all..      
+00011310: 2020 0d0a 2020 2020 7265 7475 726e 2079    ..    return y
+00011320: 300d 0a0d 0a64 6566 2070 6c61 6e65 5f33  0....def plane_3
+00011330: 706f 696e 7473 2850 303a 206e 702e 6e64  points(P0: np.nd
+00011340: 6172 7261 792c 2050 313a 206e 702e 6e64  array, P1: np.nd
+00011350: 6172 7261 792c 2050 333a 206e 702e 6e64  array, P3: np.nd
+00011360: 6172 7261 792c 2078 733a 206e 702e 6e64  array, xs: np.nd
+00011370: 6172 7261 792c 2079 733a 206e 702e 6e64  array, ys: np.nd
+00011380: 6172 7261 7929 202d 3e20 6e70 2e6e 6461  array) -> np.nda
+00011390: 7272 6179 3a0d 0a20 2020 2027 2727 0d0a  rray:..    '''..
+000113a0: 2020 2020 4361 6c63 756c 6174 6520 7468      Calculate th
+000113b0: 6520 706c 616e 6520 6675 6e63 7469 6f6e  e plane function
+000113c0: 2061 6e64 2074 6865 2063 6f6f 7264 696e   and the coordin
+000113d0: 6174 6573 206f 6620 6769 7665 6e20 706f  ates of given po
+000113e0: 696e 7473 2028 6078 7360 2c20 6079 7360  ints (`xs`, `ys`
+000113f0: 292e 0d0a 2020 2020 0d0a 2020 2020 5468  )...    ..    Th
+00011400: 6520 706c 616e 6520 6675 6e63 7469 6f6e  e plane function
+00011410: 2069 7320 6061 2a78 2b62 2a79 2b63 2a7a   is `a*x+b*y+c*z
+00011420: 2b64 3d30 602e 0d0a 2020 2020 0d0a 2020  +d=0`...    ..  
+00011430: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00011440: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d    -------------.
+00011450: 0a20 2020 2050 302c 2050 312c 2050 3320  .    P0, P1, P3 
+00011460: 3a20 6e64 6172 7261 7920 5b33 5d0d 0a20  : ndarray [3].. 
+00011470: 2020 2020 2020 2063 6f6f 7264 696e 6174         coordinat
+00011480: 6573 206f 6620 7468 7265 6520 706f 696e  es of three poin
+00011490: 7473 206f 6620 706c 616e 6520 5030 3132  ts of plane P012
+000114a0: 332e 0d0a 2020 2020 7873 2c20 7973 203a  3...    xs, ys :
+000114b0: 206e 6461 7272 6179 205b 3a5d 206f 7220   ndarray [:] or 
+000114c0: 5b3a 2c3a 5d0d 0a20 2020 2020 2020 2058  [:,:]..        X
+000114d0: 2061 6e64 2059 2063 6f6f 7264 696e 6174   and Y coordinat
+000114e0: 6573 206f 6620 706c 616e 6520 706f 696e  es of plane poin
+000114f0: 7473 2e0d 0a20 2020 200d 0a20 2020 2052  ts...    ..    R
+00011500: 6574 7572 6e73 0d0a 2020 2020 2d2d 2d2d  eturns..    ----
+00011510: 2d2d 2d0d 0a20 2020 207a 7320 3a20 6e64  ---..    zs : nd
+00011520: 6172 7261 7920 5b3a 5d20 6f72 205b 3a2c  array [:] or [:,
+00011530: 3a5d 0d0a 2020 2020 0d0a 2020 2020 4578  :]..    ..    Ex
+00011540: 616d 706c 6573 0d0a 2020 2020 2d2d 2d2d  amples..    ----
+00011550: 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e 2078  -----..    >>> x
+00011560: 7320 3d20 706c 616e 655f 3370 6f69 6e74  s = plane_3point
+00011570: 7328 5030 2c20 5031 2c20 5033 2c20 7873  s(P0, P1, P3, xs
+00011580: 2c20 7973 290d 0a20 2020 2027 2727 0d0a  , ys)..    '''..
+00011590: 2020 2020 6131 203d 2050 315b 305d 202d      a1 = P1[0] -
+000115a0: 2050 305b 305d 0d0a 2020 2020 6231 203d   P0[0]..    b1 =
+000115b0: 2050 315b 315d 202d 2050 305b 315d 0d0a   P1[1] - P0[1]..
+000115c0: 2020 2020 6331 203d 2050 315b 325d 202d      c1 = P1[2] -
+000115d0: 2050 305b 325d 0d0a 2020 2020 6132 203d   P0[2]..    a2 =
+000115e0: 2050 335b 305d 202d 2050 305b 305d 0d0a   P3[0] - P0[0]..
+000115f0: 2020 2020 6232 203d 2050 335b 315d 202d      b2 = P3[1] -
+00011600: 2050 305b 315d 0d0a 2020 2020 6332 203d   P0[1]..    c2 =
+00011610: 2050 335b 325d 202d 2050 305b 325d 0d0a   P3[2] - P0[2]..
+00011620: 2020 2020 6120 3d20 6231 202a 2063 3220      a = b1 * c2 
+00011630: 2d20 6232 202a 2063 310d 0a20 2020 2062  - b2 * c1..    b
+00011640: 203d 2061 3220 2a20 6331 202d 2061 3120   = a2 * c1 - a1 
+00011650: 2a20 6332 0d0a 2020 2020 6320 3d20 6131  * c2..    c = a1
+00011660: 202a 2062 3220 2d20 6231 202a 2061 320d   * b2 - b1 * a2.
+00011670: 0a20 2020 2064 203d 2028 2d20 6120 2a20  .    d = (- a * 
+00011680: 5030 5b30 5d20 2d20 6220 2a20 5030 5b31  P0[0] - b * P0[1
+00011690: 5d20 2d20 6320 2a20 5030 5b32 5d29 0d0a  ] - c * P0[2])..
+000116a0: 2020 2020 0d0a 2020 2020 6966 2063 203d      ..    if c =
+000116b0: 3d20 303a 0d0a 2020 2020 2020 2020 7265  = 0:..        re
+000116c0: 7475 726e 206e 702e 7a65 726f 735f 6c69  turn np.zeros_li
+000116d0: 6b65 2878 7329 0d0a 2020 2020 656c 7365  ke(xs)..    else
+000116e0: 3a0d 0a20 2020 2020 2020 2072 6574 7572  :..        retur
+000116f0: 6e20 2861 2a78 732b 622a 7973 2b64 292f  n (a*xs+b*ys+d)/
+00011700: 282d 6329 0d0a 2020 2020 0d0a 2020 2020  (-c)..    ..    
+00011710: 0d0a 232a 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ..#* ===========
 00011720: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00011730: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00011740: 3d3d 0d0a 232a 2049 6e74 6572 7365 6374  ==..#* Intersect
-00011750: 696f 6e0d 0a23 2a20 3d3d 3d3d 3d3d 3d3d  ion..#* ========
+00011740: 0d0a 232a 2049 6e74 6572 7365 6374 696f  ..#* Intersectio
+00011750: 6e0d 0a23 2a20 3d3d 3d3d 3d3d 3d3d 3d3d  n..#* ==========
 00011760: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00011770: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00011780: 3d3d 3d0d 0a20 2020 200d 0a64 6566 2069  ===..    ..def i
-00011790: 6e74 6572 7365 6374 5f69 6e64 6578 2878  ntersect_index(x
-000117a0: 312c 2079 312c 2078 322c 2079 3229 3a0d  1, y1, x2, y2):.
-000117b0: 0a20 2020 2027 2727 0d0a 2020 2020 4669  .    '''..    Fi
-000117c0: 6e64 2074 6865 2069 6e74 6572 7365 6374  nd the intersect
-000117d0: 2069 6e64 6578 2062 6574 7765 656e 2074   index between t
-000117e0: 776f 2063 7572 7665 732e 0d0a 2020 2020  wo curves...    
-000117f0: 0d0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-00011800: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
-00011810: 0d0a 2020 2020 7831 2c20 7931 203a 206c  ..    x1, y1 : l
-00011820: 6973 7420 6f72 206e 6461 7272 6179 0d0a  ist or ndarray..
-00011830: 2020 2020 2020 2020 636f 6f72 6469 6e61          coordina
-00011840: 7465 7320 6f66 2063 7572 7665 2031 2e20  tes of curve 1. 
-00011850: 0d0a 2020 2020 7832 2c20 7932 203a 206c  ..    x2, y2 : l
-00011860: 6973 7420 6f72 206e 6461 7272 6179 0d0a  ist or ndarray..
-00011870: 2020 2020 2020 2020 636f 6f72 6469 6e61          coordina
-00011880: 7465 7320 6f66 2063 7572 7665 2032 2e20  tes of curve 2. 
-00011890: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-000118a0: 5265 7475 726e 730d 0a20 2020 202d 2d2d  Returns..    ---
-000118b0: 2d2d 2d2d 2d2d 0d0a 2020 2020 6931 2c20  ------..    i1, 
-000118c0: 6932 203a 2069 6e74 0d0a 2020 2020 2020  i2 : int..      
-000118d0: 2020 696e 6465 7820 6f66 2074 6865 2063    index of the c
-000118e0: 6c6f 7365 7374 2070 6f69 6e74 7320 696e  losest points in
-000118f0: 2063 7572 7665 2031 2026 2032 2e0d 0a20   curve 1 & 2... 
-00011900: 2020 2070 6f69 6e74 7320 3a20 7475 706c     points : tupl
-00011910: 6520 6f66 206e 6461 7272 6179 0d0a 2020  e of ndarray..  
-00011920: 2020 2020 2020 7475 706c 6520 6f66 2074        tuple of t
-00011930: 776f 2063 6c6f 7365 7374 2070 6f69 6e74  wo closest point
-00011940: 7320 696e 2063 7572 7665 2031 2026 2032  s in curve 1 & 2
-00011950: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
-00011960: 2045 7861 6d70 6c65 730d 0a20 2020 202d   Examples..    -
-00011970: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-00011980: 3e3e 3e20 6931 2c20 6932 2c20 706f 696e  >>> i1, i2, poin
-00011990: 7473 203d 2069 6e74 6572 7365 6374 5f69  ts = intersect_i
-000119a0: 6e64 6578 2878 312c 2079 312c 2078 322c  ndex(x1, y1, x2,
-000119b0: 2079 3229 0d0a 0d0a 2020 2020 2727 270d   y2)....    '''.
-000119c0: 0a0d 0a20 2020 2061 7272 3120 3d20 6e70  ...    arr1 = np
-000119d0: 2e76 7374 6163 6b28 286e 702e 6172 7261  .vstack((np.arra
-000119e0: 7928 7831 292c 6e70 2e61 7272 6179 2879  y(x1),np.array(y
-000119f0: 3129 2929 2e54 0d0a 2020 2020 6172 7232  1))).T..    arr2
-00011a00: 203d 206e 702e 7673 7461 636b 2828 6e70   = np.vstack((np
-00011a10: 2e61 7272 6179 2878 3229 2c6e 702e 6172  .array(x2),np.ar
-00011a20: 7261 7928 7932 2929 292e 540d 0a0d 0a20  ray(y2))).T.... 
-00011a30: 2020 2074 7265 6520 3d20 7370 6174 6961     tree = spatia
-00011a40: 6c2e 4b44 5472 6565 2861 7272 3229 0d0a  l.KDTree(arr2)..
-00011a50: 2020 2020 6469 7374 616e 6365 2c20 6172      distance, ar
-00011a60: 7232 5f69 6e64 6578 203d 2074 7265 652e  r2_index = tree.
-00011a70: 7175 6572 7928 6172 7231 290d 0a20 2020  query(arr1)..   
-00011a80: 2069 3120 3d20 6469 7374 616e 6365 2e61   i1 = distance.a
-00011a90: 7267 6d69 6e28 2920 2023 2074 7970 653a  rgmin()  # type:
-00011aa0: 2069 6e74 0d0a 2020 2020 6932 203d 2061   int..    i2 = a
-00011ab0: 7272 325f 696e 6465 785b 6931 5d20 2020  rr2_index[i1]   
-00011ac0: 2020 2320 7479 7065 3a20 696e 740d 0a20    # type: int.. 
-00011ad0: 2020 2070 6f69 6e74 7320 3d20 2861 7272     points = (arr
-00011ae0: 315b 6931 5d2c 2061 7272 325b 6932 5d29  1[i1], arr2[i2])
-00011af0: 0d0a 0d0a 2020 2020 7265 7475 726e 2069  ....    return i
-00011b00: 312c 2069 322c 2070 6f69 6e74 730d 0a0d  1, i2, points...
-00011b10: 0a64 6566 2069 6e74 6572 7365 6374 5f70  .def intersect_p
-00011b20: 6f69 6e74 2870 313a 206e 702e 6e64 6172  oint(p1: np.ndar
-00011b30: 7261 792c 2070 323a 206e 702e 6e64 6172  ray, p2: np.ndar
-00011b40: 7261 792c 2070 333a 206e 702e 6e64 6172  ray, p3: np.ndar
-00011b50: 7261 792c 2070 343a 206e 702e 6e64 6172  ray, p4: np.ndar
-00011b60: 7261 7929 3a0d 0a20 2020 2027 2727 0d0a  ray):..    '''..
-00011b70: 2020 2020 4361 6c63 756c 6174 6520 696e      Calculate in
-00011b80: 7465 7273 6563 7469 6f6e 2070 6f69 6e74  tersection point
-00011b90: 206f 6620 7477 6f20 7365 676d 656e 7473   of two segments
-00011ba0: 2070 3170 3220 2620 7033 7034 2e0d 0a20   p1p2 & p3p4... 
-00011bb0: 2020 200d 0a20 2020 2050 6172 616d 6574     ..    Paramet
-00011bc0: 6572 730d 0a20 2020 202d 2d2d 2d2d 2d2d  ers..    -------
-00011bd0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2070 312c  -------..    p1,
-00011be0: 2070 322c 2070 332c 2070 3420 3a20 6e64   p2, p3, p4 : nd
-00011bf0: 6172 7261 790d 0a20 2020 2020 2020 206e  array..        n
-00011c00: 6461 7272 6179 205b 325d 206f 7220 5b3a  darray [2] or [:
-00011c10: 2c32 5d0d 0a20 2020 200d 0a20 2020 2052  ,2]..    ..    R
-00011c20: 6574 7572 6e73 0d0a 2020 2020 2d2d 2d2d  eturns..    ----
-00011c30: 2d2d 2d2d 2d2d 0d0a 2020 2020 7069 203a  ------..    pi :
-00011c40: 206e 6461 7272 6179 0d0a 2020 2020 2020   ndarray..      
-00011c50: 2020 6e64 6172 7261 7920 5b32 5d20 6f72    ndarray [2] or
-00011c60: 205b 3a2c 325d 0d0a 2020 2020 2727 270d   [:,2]..    '''.
-00011c70: 0a20 2020 2069 6620 6c65 6e28 7031 2e73  .    if len(p1.s
-00011c80: 6861 7065 293d 3d31 3a0d 0a20 2020 2020  hape)==1:..     
-00011c90: 2020 2061 3120 3d20 7032 5b31 5d2d 7031     a1 = p2[1]-p1
-00011ca0: 5b31 5d0d 0a20 2020 2020 2020 2062 3120  [1]..        b1 
-00011cb0: 3d20 7031 5b30 5d2d 7032 5b30 5d0d 0a20  = p1[0]-p2[0].. 
-00011cc0: 2020 2020 2020 2063 3120 3d20 7031 5b30         c1 = p1[0
-00011cd0: 5d2a 7032 5b31 5d2d 7032 5b30 5d2a 7031  ]*p2[1]-p2[0]*p1
-00011ce0: 5b31 5d0d 0a20 2020 2020 2020 2061 3220  [1]..        a2 
-00011cf0: 3d20 7034 5b31 5d2d 7033 5b31 5d0d 0a20  = p4[1]-p3[1].. 
-00011d00: 2020 2020 2020 2062 3220 3d20 7033 5b30         b2 = p3[0
-00011d10: 5d2d 7034 5b30 5d0d 0a20 2020 2020 2020  ]-p4[0]..       
-00011d20: 2063 3220 3d20 7033 5b30 5d2a 7034 5b31   c2 = p3[0]*p4[1
-00011d30: 5d2d 7034 5b30 5d2a 7033 5b31 5d0d 0a20  ]-p4[0]*p3[1].. 
-00011d40: 2020 2020 2020 2064 6420 3d20 6131 2a62         dd = a1*b
-00011d50: 322d 6132 2a62 310d 0a0d 0a20 2020 2020  2-a2*b1....     
-00011d60: 2020 2069 6620 6464 3d3d 303a 0d0a 2020     if dd==0:..  
-00011d70: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00011d80: 2750 6172 616c 6c65 6c20 7365 676d 656e  'Parallel segmen
-00011d90: 7473 2729 0d0a 2020 2020 2020 2020 2020  ts')..          
-00011da0: 2020 7265 7475 726e 204e 6f6e 650d 0a20    return None.. 
-00011db0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00011dc0: 2020 2020 2020 2020 2020 7830 203d 2028            x0 = (
-00011dd0: 6331 2a62 322d 6332 2a62 3129 2f64 640d  c1*b2-c2*b1)/dd.
-00011de0: 0a20 2020 2020 2020 2020 2020 2079 3020  .            y0 
-00011df0: 3d20 2863 322a 6131 2d63 312a 6132 292f  = (c2*a1-c1*a2)/
-00011e00: 6464 0d0a 2020 2020 2020 2020 2020 2020  dd..            
-00011e10: 7265 7475 726e 206e 702e 6172 7261 7928  return np.array(
-00011e20: 5b78 302c 7930 5d29 0d0a 2020 2020 0d0a  [x0,y0])..    ..
-00011e30: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00011e40: 2020 200d 0a20 2020 2020 2020 2061 3120     ..        a1 
-00011e50: 3d20 7032 5b3a 2c31 5d2d 7031 5b3a 2c31  = p2[:,1]-p1[:,1
-00011e60: 5d0d 0a20 2020 2020 2020 2062 3120 3d20  ]..        b1 = 
-00011e70: 7031 5b3a 2c30 5d2d 7032 5b3a 2c30 5d0d  p1[:,0]-p2[:,0].
-00011e80: 0a20 2020 2020 2020 2063 3120 3d20 7031  .        c1 = p1
-00011e90: 5b3a 2c30 5d2a 7032 5b3a 2c31 5d2d 7032  [:,0]*p2[:,1]-p2
-00011ea0: 5b3a 2c30 5d2a 7031 5b3a 2c31 5d0d 0a20  [:,0]*p1[:,1].. 
-00011eb0: 2020 2020 2020 2061 3220 3d20 7034 5b3a         a2 = p4[:
-00011ec0: 2c31 5d2d 7033 5b3a 2c31 5d0d 0a20 2020  ,1]-p3[:,1]..   
-00011ed0: 2020 2020 2062 3220 3d20 7033 5b3a 2c30       b2 = p3[:,0
-00011ee0: 5d2d 7034 5b3a 2c30 5d0d 0a20 2020 2020  ]-p4[:,0]..     
-00011ef0: 2020 2063 3220 3d20 7033 5b3a 2c30 5d2a     c2 = p3[:,0]*
-00011f00: 7034 5b3a 2c31 5d2d 7034 5b3a 2c30 5d2a  p4[:,1]-p4[:,0]*
-00011f10: 7033 5b3a 2c31 5d0d 0a20 2020 2020 2020  p3[:,1]..       
-00011f20: 2064 6420 3d20 6131 2a62 322d 6132 2a62   dd = a1*b2-a2*b
-00011f30: 310d 0a0d 0a20 2020 2020 2020 2069 6620  1....        if 
-00011f40: 6e70 2e61 6e79 2864 643d 3d30 293a 0d0a  np.any(dd==0):..
-00011f50: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00011f60: 7428 2750 6172 616c 6c65 6c20 7365 676d  t('Parallel segm
-00011f70: 656e 7473 2729 0d0a 2020 2020 2020 2020  ents')..        
-00011f80: 2020 2020 7265 7475 726e 204e 6f6e 650d      return None.
-00011f90: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00011fa0: 2020 2020 2020 2020 2020 2020 7830 203d              x0 =
-00011fb0: 2028 6331 2a62 322d 6332 2a62 3129 2f64   (c1*b2-c2*b1)/d
-00011fc0: 640d 0a20 2020 2020 2020 2020 2020 2079  d..            y
-00011fd0: 3020 3d20 2863 322a 6131 2d63 312a 6132  0 = (c2*a1-c1*a2
-00011fe0: 292f 6464 0d0a 2020 2020 2020 2020 2020  )/dd..          
-00011ff0: 2020 7069 203d 206e 702e 636f 6e63 6174    pi = np.concat
-00012000: 656e 6174 6528 2878 302c 2079 3029 2c20  enate((x0, y0), 
-00012010: 6178 6973 3d31 290d 0a20 2020 2020 2020  axis=1)..       
-00012020: 2020 2020 2072 6574 7572 6e20 7069 0d0a       return pi..
-00012030: 0d0a 6465 6620 696e 7465 7273 6563 745f  ..def intersect_
-00012040: 7665 635f 706c 616e 6528 5630 3a20 6e70  vec_plane(V0: np
-00012050: 2e6e 6461 7272 6179 2c20 5631 3a20 6e70  .ndarray, V1: np
-00012060: 2e6e 6461 7272 6179 2c20 0d0a 2020 2020  .ndarray, ..    
+00011780: 3d0d 0a20 2020 200d 0a64 6566 2069 6e74  =..    ..def int
+00011790: 6572 7365 6374 5f69 6e64 6578 2878 312c  ersect_index(x1,
+000117a0: 2079 312c 2078 322c 2079 3229 3a0d 0a20   y1, x2, y2):.. 
+000117b0: 2020 2027 2727 0d0a 2020 2020 4669 6e64     '''..    Find
+000117c0: 2074 6865 2069 6e74 6572 7365 6374 2069   the intersect i
+000117d0: 6e64 6578 2062 6574 7765 656e 2074 776f  ndex between two
+000117e0: 2063 7572 7665 732e 0d0a 2020 2020 0d0a   curves...    ..
+000117f0: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00011800: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+00011810: 2020 2020 7831 2c20 7931 203a 206c 6973      x1, y1 : lis
+00011820: 7420 6f72 206e 6461 7272 6179 0d0a 2020  t or ndarray..  
+00011830: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
+00011840: 7320 6f66 2063 7572 7665 2031 2e20 0d0a  s of curve 1. ..
+00011850: 2020 2020 7832 2c20 7932 203a 206c 6973      x2, y2 : lis
+00011860: 7420 6f72 206e 6461 7272 6179 0d0a 2020  t or ndarray..  
+00011870: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
+00011880: 7320 6f66 2063 7572 7665 2032 2e20 0d0a  s of curve 2. ..
+00011890: 2020 2020 2020 2020 0d0a 2020 2020 5265          ..    Re
+000118a0: 7475 726e 730d 0a20 2020 202d 2d2d 2d2d  turns..    -----
+000118b0: 2d2d 2d2d 0d0a 2020 2020 6931 2c20 6932  ----..    i1, i2
+000118c0: 203a 2069 6e74 0d0a 2020 2020 2020 2020   : int..        
+000118d0: 696e 6465 7820 6f66 2074 6865 2063 6c6f  index of the clo
+000118e0: 7365 7374 2070 6f69 6e74 7320 696e 2063  sest points in c
+000118f0: 7572 7665 2031 2026 2032 2e0d 0a20 2020  urve 1 & 2...   
+00011900: 2070 6f69 6e74 7320 3a20 7475 706c 6520   points : tuple 
+00011910: 6f66 206e 6461 7272 6179 0d0a 2020 2020  of ndarray..    
+00011920: 2020 2020 7475 706c 6520 6f66 2074 776f      tuple of two
+00011930: 2063 6c6f 7365 7374 2070 6f69 6e74 7320   closest points 
+00011940: 696e 2063 7572 7665 2031 2026 2032 2e0d  in curve 1 & 2..
+00011950: 0a20 2020 2020 2020 200d 0a20 2020 2045  .        ..    E
+00011960: 7861 6d70 6c65 730d 0a20 2020 202d 2d2d  xamples..    ---
+00011970: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 3e3e  --------..    >>
+00011980: 3e20 6931 2c20 6932 2c20 706f 696e 7473  > i1, i2, points
+00011990: 203d 2069 6e74 6572 7365 6374 5f69 6e64   = intersect_ind
+000119a0: 6578 2878 312c 2079 312c 2078 322c 2079  ex(x1, y1, x2, y
+000119b0: 3229 0d0a 0d0a 2020 2020 2727 270d 0a0d  2)....    '''...
+000119c0: 0a20 2020 2061 7272 3120 3d20 6e70 2e76  .    arr1 = np.v
+000119d0: 7374 6163 6b28 286e 702e 6172 7261 7928  stack((np.array(
+000119e0: 7831 292c 6e70 2e61 7272 6179 2879 3129  x1),np.array(y1)
+000119f0: 2929 2e54 0d0a 2020 2020 6172 7232 203d  )).T..    arr2 =
+00011a00: 206e 702e 7673 7461 636b 2828 6e70 2e61   np.vstack((np.a
+00011a10: 7272 6179 2878 3229 2c6e 702e 6172 7261  rray(x2),np.arra
+00011a20: 7928 7932 2929 292e 540d 0a0d 0a20 2020  y(y2))).T....   
+00011a30: 2074 7265 6520 3d20 7370 6174 6961 6c2e   tree = spatial.
+00011a40: 4b44 5472 6565 2861 7272 3229 0d0a 2020  KDTree(arr2)..  
+00011a50: 2020 6469 7374 616e 6365 2c20 6172 7232    distance, arr2
+00011a60: 5f69 6e64 6578 203d 2074 7265 652e 7175  _index = tree.qu
+00011a70: 6572 7928 6172 7231 290d 0a20 2020 2069  ery(arr1)..    i
+00011a80: 3120 3d20 6469 7374 616e 6365 2e61 7267  1 = distance.arg
+00011a90: 6d69 6e28 2920 2023 2074 7970 653a 2069  min()  # type: i
+00011aa0: 6e74 0d0a 2020 2020 6932 203d 2061 7272  nt..    i2 = arr
+00011ab0: 325f 696e 6465 785b 6931 5d20 2020 2020  2_index[i1]     
+00011ac0: 2320 7479 7065 3a20 696e 740d 0a20 2020  # type: int..   
+00011ad0: 2070 6f69 6e74 7320 3d20 2861 7272 315b   points = (arr1[
+00011ae0: 6931 5d2c 2061 7272 325b 6932 5d29 0d0a  i1], arr2[i2])..
+00011af0: 0d0a 2020 2020 7265 7475 726e 2069 312c  ..    return i1,
+00011b00: 2069 322c 2070 6f69 6e74 730d 0a0d 0a64   i2, points....d
+00011b10: 6566 2069 6e74 6572 7365 6374 5f70 6f69  ef intersect_poi
+00011b20: 6e74 2870 313a 206e 702e 6e64 6172 7261  nt(p1: np.ndarra
+00011b30: 792c 2070 323a 206e 702e 6e64 6172 7261  y, p2: np.ndarra
+00011b40: 792c 2070 333a 206e 702e 6e64 6172 7261  y, p3: np.ndarra
+00011b50: 792c 2070 343a 206e 702e 6e64 6172 7261  y, p4: np.ndarra
+00011b60: 7929 3a0d 0a20 2020 2027 2727 0d0a 2020  y):..    '''..  
+00011b70: 2020 4361 6c63 756c 6174 6520 696e 7465    Calculate inte
+00011b80: 7273 6563 7469 6f6e 2070 6f69 6e74 206f  rsection point o
+00011b90: 6620 7477 6f20 7365 676d 656e 7473 2070  f two segments p
+00011ba0: 3170 3220 2620 7033 7034 2e0d 0a20 2020  1p2 & p3p4...   
+00011bb0: 200d 0a20 2020 2050 6172 616d 6574 6572   ..    Parameter
+00011bc0: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
+00011bd0: 2d2d 2d2d 2d0d 0a20 2020 2070 312c 2070  -----..    p1, p
+00011be0: 322c 2070 332c 2070 3420 3a20 6e64 6172  2, p3, p4 : ndar
+00011bf0: 7261 790d 0a20 2020 2020 2020 206e 6461  ray..        nda
+00011c00: 7272 6179 205b 325d 206f 7220 5b3a 2c32  rray [2] or [:,2
+00011c10: 5d0d 0a20 2020 200d 0a20 2020 2052 6574  ]..    ..    Ret
+00011c20: 7572 6e73 0d0a 2020 2020 2d2d 2d2d 2d2d  urns..    ------
+00011c30: 2d2d 2d2d 0d0a 2020 2020 7069 203a 206e  ----..    pi : n
+00011c40: 6461 7272 6179 0d0a 2020 2020 2020 2020  darray..        
+00011c50: 6e64 6172 7261 7920 5b32 5d20 6f72 205b  ndarray [2] or [
+00011c60: 3a2c 325d 0d0a 2020 2020 2727 270d 0a20  :,2]..    '''.. 
+00011c70: 2020 2069 6620 6c65 6e28 7031 2e73 6861     if len(p1.sha
+00011c80: 7065 293d 3d31 3a0d 0a20 2020 2020 2020  pe)==1:..       
+00011c90: 2061 3120 3d20 7032 5b31 5d2d 7031 5b31   a1 = p2[1]-p1[1
+00011ca0: 5d0d 0a20 2020 2020 2020 2062 3120 3d20  ]..        b1 = 
+00011cb0: 7031 5b30 5d2d 7032 5b30 5d0d 0a20 2020  p1[0]-p2[0]..   
+00011cc0: 2020 2020 2063 3120 3d20 7031 5b30 5d2a       c1 = p1[0]*
+00011cd0: 7032 5b31 5d2d 7032 5b30 5d2a 7031 5b31  p2[1]-p2[0]*p1[1
+00011ce0: 5d0d 0a20 2020 2020 2020 2061 3220 3d20  ]..        a2 = 
+00011cf0: 7034 5b31 5d2d 7033 5b31 5d0d 0a20 2020  p4[1]-p3[1]..   
+00011d00: 2020 2020 2062 3220 3d20 7033 5b30 5d2d       b2 = p3[0]-
+00011d10: 7034 5b30 5d0d 0a20 2020 2020 2020 2063  p4[0]..        c
+00011d20: 3220 3d20 7033 5b30 5d2a 7034 5b31 5d2d  2 = p3[0]*p4[1]-
+00011d30: 7034 5b30 5d2a 7033 5b31 5d0d 0a20 2020  p4[0]*p3[1]..   
+00011d40: 2020 2020 2064 6420 3d20 6131 2a62 322d       dd = a1*b2-
+00011d50: 6132 2a62 310d 0a0d 0a20 2020 2020 2020  a2*b1....       
+00011d60: 2069 6620 6464 3d3d 303a 0d0a 2020 2020   if dd==0:..    
+00011d70: 2020 2020 2020 2020 7072 696e 7428 2750          print('P
+00011d80: 6172 616c 6c65 6c20 7365 676d 656e 7473  arallel segments
+00011d90: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+00011da0: 7265 7475 726e 204e 6f6e 650d 0a20 2020  return None..   
+00011db0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00011dc0: 2020 2020 2020 2020 7830 203d 2028 6331          x0 = (c1
+00011dd0: 2a62 322d 6332 2a62 3129 2f64 640d 0a20  *b2-c2*b1)/dd.. 
+00011de0: 2020 2020 2020 2020 2020 2079 3020 3d20             y0 = 
+00011df0: 2863 322a 6131 2d63 312a 6132 292f 6464  (c2*a1-c1*a2)/dd
+00011e00: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00011e10: 7475 726e 206e 702e 6172 7261 7928 5b78  turn np.array([x
+00011e20: 302c 7930 5d29 0d0a 2020 2020 0d0a 2020  0,y0])..    ..  
+00011e30: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00011e40: 200d 0a20 2020 2020 2020 2061 3120 3d20   ..        a1 = 
+00011e50: 7032 5b3a 2c31 5d2d 7031 5b3a 2c31 5d0d  p2[:,1]-p1[:,1].
+00011e60: 0a20 2020 2020 2020 2062 3120 3d20 7031  .        b1 = p1
+00011e70: 5b3a 2c30 5d2d 7032 5b3a 2c30 5d0d 0a20  [:,0]-p2[:,0].. 
+00011e80: 2020 2020 2020 2063 3120 3d20 7031 5b3a         c1 = p1[:
+00011e90: 2c30 5d2a 7032 5b3a 2c31 5d2d 7032 5b3a  ,0]*p2[:,1]-p2[:
+00011ea0: 2c30 5d2a 7031 5b3a 2c31 5d0d 0a20 2020  ,0]*p1[:,1]..   
+00011eb0: 2020 2020 2061 3220 3d20 7034 5b3a 2c31       a2 = p4[:,1
+00011ec0: 5d2d 7033 5b3a 2c31 5d0d 0a20 2020 2020  ]-p3[:,1]..     
+00011ed0: 2020 2062 3220 3d20 7033 5b3a 2c30 5d2d     b2 = p3[:,0]-
+00011ee0: 7034 5b3a 2c30 5d0d 0a20 2020 2020 2020  p4[:,0]..       
+00011ef0: 2063 3220 3d20 7033 5b3a 2c30 5d2a 7034   c2 = p3[:,0]*p4
+00011f00: 5b3a 2c31 5d2d 7034 5b3a 2c30 5d2a 7033  [:,1]-p4[:,0]*p3
+00011f10: 5b3a 2c31 5d0d 0a20 2020 2020 2020 2064  [:,1]..        d
+00011f20: 6420 3d20 6131 2a62 322d 6132 2a62 310d  d = a1*b2-a2*b1.
+00011f30: 0a0d 0a20 2020 2020 2020 2069 6620 6e70  ...        if np
+00011f40: 2e61 6e79 2864 643d 3d30 293a 0d0a 2020  .any(dd==0):..  
+00011f50: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00011f60: 2750 6172 616c 6c65 6c20 7365 676d 656e  'Parallel segmen
+00011f70: 7473 2729 0d0a 2020 2020 2020 2020 2020  ts')..          
+00011f80: 2020 7265 7475 726e 204e 6f6e 650d 0a20    return None.. 
+00011f90: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00011fa0: 2020 2020 2020 2020 2020 7830 203d 2028            x0 = (
+00011fb0: 6331 2a62 322d 6332 2a62 3129 2f64 640d  c1*b2-c2*b1)/dd.
+00011fc0: 0a20 2020 2020 2020 2020 2020 2079 3020  .            y0 
+00011fd0: 3d20 2863 322a 6131 2d63 312a 6132 292f  = (c2*a1-c1*a2)/
+00011fe0: 6464 0d0a 2020 2020 2020 2020 2020 2020  dd..            
+00011ff0: 7069 203d 206e 702e 636f 6e63 6174 656e  pi = np.concaten
+00012000: 6174 6528 2878 302c 2079 3029 2c20 6178  ate((x0, y0), ax
+00012010: 6973 3d31 290d 0a20 2020 2020 2020 2020  is=1)..         
+00012020: 2020 2072 6574 7572 6e20 7069 0d0a 0d0a     return pi....
+00012030: 6465 6620 696e 7465 7273 6563 745f 7665  def intersect_ve
+00012040: 635f 706c 616e 6528 5630 3a20 6e70 2e6e  c_plane(V0: np.n
+00012050: 6461 7272 6179 2c20 5631 3a20 6e70 2e6e  darray, V1: np.n
+00012060: 6461 7272 6179 2c20 0d0a 2020 2020 2020  darray, ..      
 00012070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012080: 2020 2020 5030 3a20 6e70 2e6e 6461 7272      P0: np.ndarr
-00012090: 6179 2c20 5031 3a20 6e70 2e6e 6461 7272  ay, P1: np.ndarr
-000120a0: 6179 2c0d 0a20 2020 2020 2020 2020 2020  ay,..           
-000120b0: 2020 2020 2020 2020 2020 2020 2050 333a               P3:
-000120c0: 206e 702e 6e64 6172 7261 7929 202d 3e20   np.ndarray) -> 
-000120d0: 5475 706c 655b 6e70 2e6e 6461 7272 6179  Tuple[np.ndarray
-000120e0: 2c20 666c 6f61 742c 2066 6c6f 6174 2c20  , float, float, 
-000120f0: 666c 6f61 745d 3a0d 0a20 2020 2027 2727  float]:..    '''
-00012100: 0d0a 2020 2020 4361 6c63 756c 6174 6520  ..    Calculate 
-00012110: 7468 6520 696e 7465 7273 6563 7469 6f6e  the intersection
-00012120: 2070 6f69 6e74 206f 6620 6120 7665 6374   point of a vect
-00012130: 6f72 2061 6e64 2061 2070 6c61 6e65 2e0d  or and a plane..
-00012140: 0a20 2020 200d 0a20 2020 2050 6172 616d  .    ..    Param
-00012150: 6574 6572 730d 0a20 2020 202d 2d2d 2d2d  eters..    -----
-00012160: 2d2d 2d2d 2d2d 0d0a 2020 2020 5630 2c20  ------..    V0, 
-00012170: 5631 3a20 6e64 6172 7261 7920 5b33 5d0d  V1: ndarray [3].
-00012180: 0a20 2020 2020 2020 2063 6f6f 7264 696e  .        coordin
-00012190: 6174 6573 206f 6620 7665 6374 6f72 3a20  ates of vector: 
-000121a0: 5630 312e 0d0a 2020 2020 5030 2c20 5031  V01...    P0, P1
-000121b0: 2c20 5033 203a 206e 6461 7272 6179 205b  , P3 : ndarray [
-000121c0: 335d 0d0a 2020 2020 2020 2020 636f 6f72  3]..        coor
-000121d0: 6469 6e61 7465 7320 6f66 2074 6872 6565  dinates of three
-000121e0: 2070 6f69 6e74 7320 6f66 2070 6c61 6e65   points of plane
-000121f0: 2050 3031 3233 2e0d 0a20 2020 200d 0a20   P0123...    .. 
-00012200: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-00012210: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2078 6920  -------..    xi 
-00012220: 3a20 6e64 6172 7261 7920 5b33 5d0d 0a20  : ndarray [3].. 
-00012230: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
-00012240: 696f 6e20 706f 696e 740d 0a20 2020 2074  ion point..    t
-00012250: 312c 2074 3320 3a20 666c 6f61 740d 0a20  1, t3 : float.. 
-00012260: 2020 2020 2020 2072 6174 696f 206f 6620         ratio of 
-00012270: 7869 2069 6e20 5030 312c 2050 3033 2064  xi in P01, P03 d
-00012280: 6972 6563 7469 6f6e 2e0d 0a20 2020 2072  irection...    r
-00012290: 7620 3a20 666c 6f61 740d 0a20 2020 2020  v : float..     
-000122a0: 2020 2072 6174 696f 206f 6620 7869 2069     ratio of xi i
-000122b0: 6e20 5630 3120 6469 7265 6374 696f 6e2e  n V01 direction.
-000122c0: 0d0a 2020 2020 0d0a 2020 2020 4578 616d  ..    ..    Exam
-000122d0: 706c 6573 0d0a 2020 2020 2d2d 2d2d 2d2d  ples..    ------
-000122e0: 2d2d 2d0d 0a20 2020 203e 3e3e 2078 692c  ---..    >>> xi,
-000122f0: 2074 312c 2074 332c 2072 7620 3d20 696e   t1, t3, rv = in
-00012300: 7465 7273 6563 745f 7665 635f 706c 616e  tersect_vec_plan
-00012310: 6528 5630 2c20 5631 2c20 5030 2c20 5031  e(V0, V1, P0, P1
-00012320: 2c20 5033 290d 0a0d 0a20 2020 2027 2727  , P3)....    '''
-00012330: 0d0a 2020 2020 6e52 2020 3d20 5631 202d  ..    nR  = V1 -
-00012340: 2056 300d 0a20 2020 206c 3020 203d 206e   V0..    l0  = n
-00012350: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 6e52  p.linalg.norm(nR
-00012360: 2920 2b20 3145 2d32 300d 0a20 2020 206e  ) + 1E-20..    n
-00012370: 5220 203d 206e 5220 2f20 6c30 0d0a 2020  R  = nR / l0..  
-00012380: 2020 0d0a 2020 2020 4120 3d20 6e70 2e7a    ..    A = np.z
-00012390: 6572 6f73 2828 332c 3329 290d 0a20 2020  eros((3,3))..   
-000123a0: 2041 5b3a 2c30 5d20 3d20 5031 2d50 300d   A[:,0] = P1-P0.
-000123b0: 0a20 2020 2041 5b3a 2c31 5d20 3d20 5033  .    A[:,1] = P3
-000123c0: 2d50 300d 0a20 2020 2041 5b3a 2c32 5d20  -P0..    A[:,2] 
-000123d0: 3d20 2d20 6e52 0d0a 2020 2020 4220 3d20  = - nR..    B = 
-000123e0: 5630 2d50 300d 0a20 2020 200d 0a20 2020  V0-P0..    ..   
-000123f0: 2053 6f6c 203d 206e 702e 6c69 6e61 6c67   Sol = np.linalg
-00012400: 2e73 6f6c 7665 2841 2c20 4229 0d0a 2020  .solve(A, B)..  
-00012410: 2020 0d0a 2020 2020 7431 203d 2053 6f6c    ..    t1 = Sol
-00012420: 5b30 5d0d 0a20 2020 2074 3320 3d20 536f  [0]..    t3 = So
-00012430: 6c5b 315d 0d0a 2020 2020 7276 203d 2053  l[1]..    rv = S
-00012440: 6f6c 5b32 5d2f 6c30 0d0a 2020 2020 7869  ol[2]/l0..    xi
-00012450: 203d 2056 3020 2b20 6e52 2a53 6f6c 5b32   = V0 + nR*Sol[2
-00012460: 5d0d 0a0d 0a20 2020 2072 6574 7572 6e20  ]....    return 
-00012470: 7869 2c20 7431 2c20 7433 2c20 7276 0d0a  xi, t1, t3, rv..
-00012480: 0d0a 6465 6620 696e 7465 7273 6563 745f  ..def intersect_
-00012490: 7375 7266 6163 655f 706c 616e 6528 7375  surface_plane(su
-000124a0: 7266 6163 653a 206e 702e 6e64 6172 7261  rface: np.ndarra
-000124b0: 792c 2050 303a 206e 702e 6e64 6172 7261  y, P0: np.ndarra
-000124c0: 792c 2050 313a 206e 702e 6e64 6172 7261  y, P1: np.ndarra
-000124d0: 792c 2050 333a 206e 702e 6e64 6172 7261  y, P3: np.ndarra
-000124e0: 792c 200d 0a20 2020 2020 2020 2020 2020  y, ..           
-000124f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012500: 2077 6974 6869 6e5f 626f 756e 6473 3d46   within_bounds=F
-00012510: 616c 7365 2c20 6f72 6967 696e 616c 5f6f  alse, original_o
-00012520: 7264 6572 3d46 616c 7365 293a 0d0a 2020  rder=False):..  
-00012530: 2020 2727 270d 0a20 2020 2043 616c 6375    '''..    Calcu
-00012540: 6c61 7465 2074 6865 2069 6e74 6572 7365  late the interse
-00012550: 6374 696f 6e20 6375 7276 6520 6f66 2061  ction curve of a
-00012560: 2073 7572 6661 6365 2061 6e64 2061 2070   surface and a p
-00012570: 6c61 6e65 2e0d 0a20 2020 200d 0a20 2020  lane...    ..   
-00012580: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00012590: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-000125a0: 2073 7572 6661 6365 203a 206e 6461 7272   surface : ndarr
-000125b0: 6179 205b 6e69 2c6e 6a2c 335d 0d0a 2020  ay [ni,nj,3]..  
-000125c0: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
-000125d0: 7320 6f66 2073 7572 6661 6365 2e0d 0a20  s of surface... 
-000125e0: 2020 2050 302c 2050 312c 2050 3320 3a20     P0, P1, P3 : 
-000125f0: 6e64 6172 7261 7920 5b33 5d0d 0a20 2020  ndarray [3]..   
-00012600: 2020 2020 2063 6f6f 7264 696e 6174 6573       coordinates
-00012610: 206f 6620 7468 7265 6520 706f 696e 7473   of three points
-00012620: 206f 6620 706c 616e 6520 5030 3132 330d   of plane P0123.
-00012630: 0a20 2020 2077 6974 6869 6e5f 626f 756e  .    within_boun
-00012640: 6473 203a 2062 6f6f 6c0d 0a20 2020 2020  ds : bool..     
-00012650: 2020 2069 6620 5472 7565 2c20 6f6e 6c79     if True, only
-00012660: 206b 6565 7020 7468 6520 6375 7276 6520   keep the curve 
-00012670: 7769 7468 696e 2074 6865 2062 6f75 6e64  within the bound
-00012680: 7320 6f66 2050 3031 3233 2e0d 0a20 2020  s of P0123...   
-00012690: 206f 7269 6769 6e61 6c5f 6f72 6465 7220   original_order 
-000126a0: 3a20 626f 6f6c 0d0a 2020 2020 2020 2020  : bool..        
-000126b0: 6966 2046 616c 7365 2c20 7265 6172 7261  if False, rearra
-000126c0: 6e67 6520 706f 696e 7473 2074 6f20 666f  nge points to fo
-000126d0: 726d 2061 2073 6d6f 6f74 6820 6375 7276  rm a smooth curv
-000126e0: 652e 0d0a 2020 2020 0d0a 2020 2020 5265  e...    ..    Re
-000126f0: 7475 726e 730d 0a20 2020 202d 2d2d 2d2d  turns..    -----
-00012700: 2d2d 2d2d 0d0a 2020 2020 6375 7276 6520  ----..    curve 
-00012710: 3a20 6c69 7374 206f 6620 6e64 6172 7261  : list of ndarra
-00012720: 7920 5b33 5d0d 0a20 2020 2020 2020 2069  y [3]..        i
-00012730: 6e74 6572 7365 6374 696f 6e20 6375 7276  ntersection curv
-00012740: 652e 0d0a 2020 2020 696a 5f63 7572 7665  e...    ij_curve
-00012750: 203a 206c 6973 7420 6f66 205b 692c 6a5d   : list of [i,j]
-00012760: 0d0a 2020 2020 2020 2020 7468 6520 696e  ..        the in
-00012770: 6465 7820 6f66 206e 6561 7265 7374 2070  dex of nearest p
-00012780: 6f69 6e74 2069 6e20 7375 7266 6163 6520  oint in surface 
-00012790: 746f 2065 6163 6820 706f 696e 7420 6f66  to each point of
-000127a0: 2063 7572 7665 2e0d 0a20 2020 2078 695f   curve...    xi_
-000127b0: 6375 7276 652c 2079 745f 6375 7276 653a  curve, yt_curve:
-000127c0: 206e 6461 7272 6179 205b 3a5d 0d0a 2020   ndarray [:]..  
-000127d0: 2020 2020 2020 7265 6c61 7469 7665 2063        relative c
-000127e0: 6f6f 7264 696e 6174 6573 2069 6e20 7468  oordinates in th
-000127f0: 6520 706c 616e 6520 5030 3132 332c 2072  e plane P0123, r
-00012800: 616e 6765 2069 6e20 5b30 2c31 5d2e 0d0a  ange in [0,1]...
-00012810: 2020 2020 0d0a 2020 2020 4578 616d 706c      ..    Exampl
-00012820: 6573 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  es..    --------
-00012830: 2d2d 2d2d 0d0a 2020 2020 3e3e 3e20 6375  ----..    >>> cu
-00012840: 7276 652c 2069 6a5f 6375 7276 652c 2078  rve, ij_curve, x
-00012850: 695f 6375 7276 652c 2079 745f 6375 7276  i_curve, yt_curv
-00012860: 6520 3d20 696e 7465 7273 6563 745f 7375  e = intersect_su
-00012870: 7266 6163 655f 706c 616e 6528 7375 7266  rface_plane(surf
-00012880: 6163 652c 2050 302c 2050 312c 2050 3329  ace, P0, P1, P3)
-00012890: 0d0a 0d0a 2020 2020 2727 270d 0a0d 0a20  ....    '''.... 
-000128a0: 2020 206e 6920 3d20 7375 7266 6163 652e     ni = surface.
-000128b0: 7368 6170 655b 305d 0d0a 2020 2020 6e6a  shape[0]..    nj
-000128c0: 203d 2073 7572 6661 6365 2e73 6861 7065   = surface.shape
-000128d0: 5b31 5d0d 0a20 2020 206e 6f72 6d20 3d20  [1]..    norm = 
-000128e0: 6e70 2e63 726f 7373 2850 312d 5030 2c20  np.cross(P1-P0, 
-000128f0: 5033 2d50 3029 0d0a 2020 2020 6e6f 726d  P3-P0)..    norm
-00012900: 203d 206e 6f72 6d2f 6e70 2e6c 696e 616c   = norm/np.linal
-00012910: 672e 6e6f 726d 286e 6f72 6d29 0d0a 2020  g.norm(norm)..  
-00012920: 2020 0d0a 2020 2020 6375 7276 6520 3d20    ..    curve = 
-00012930: 5b5d 0d0a 2020 2020 696a 5f63 7572 7665  []..    ij_curve
-00012940: 203d 205b 5d0d 0a20 2020 2078 695f 6375   = []..    xi_cu
-00012950: 7276 6520 3d20 5b5d 0d0a 2020 2020 7974  rve = []..    yt
-00012960: 5f63 7572 7665 203d 205b 5d0d 0a0d 0a20  _curve = [].... 
-00012970: 2020 2023 2a20 546f 206c 6f63 6174 6520     #* To locate 
-00012980: 706f 696e 7473 2069 6e20 626f 7468 2073  points in both s
-00012990: 6964 6573 206f 6620 7468 6520 706c 616e  ides of the plan
-000129a0: 650d 0a20 2020 206e 6f72 6d5f 6469 7320  e..    norm_dis 
-000129b0: 3d20 6e70 2e64 6f74 2873 7572 6661 6365  = np.dot(surface
-000129c0: 2d50 302c 206e 6f72 6d29 2023 205b 6e69  -P0, norm) # [ni
-000129d0: 2c6e 6a5d 0d0a 2020 2020 0d0a 2020 2020  ,nj]..    ..    
-000129e0: 666f 7220 6a20 696e 2072 616e 6765 286e  for j in range(n
-000129f0: 6a29 3a0d 0a20 2020 2020 2020 2066 6f72  j):..        for
-00012a00: 2069 2069 6e20 7261 6e67 6528 6e69 293a   i in range(ni):
-00012a10: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00012a20: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00012a30: 3c6e 692d 313a 0d0a 2020 2020 2020 2020  <ni-1:..        
-00012a40: 2020 2020 2020 2020 6966 206e 6f72 6d5f          if norm_
-00012a50: 6469 735b 692c 6a5d 2a6e 6f72 6d5f 6469  dis[i,j]*norm_di
-00012a60: 735b 692b 312c 6a5d 3c30 206f 7220 6e6f  s[i+1,j]<0 or no
-00012a70: 726d 5f64 6973 5b69 2c6a 5d3d 3d30 3a0d  rm_dis[i,j]==0:.
-00012a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012a90: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00012aa0: 2020 2020 2020 2020 2020 2078 692c 2074             xi, t
-00012ab0: 312c 2074 332c 2072 7620 3d20 696e 7465  1, t3, rv = inte
-00012ac0: 7273 6563 745f 7665 635f 706c 616e 6528  rsect_vec_plane(
-00012ad0: 7375 7266 6163 655b 692c 6a2c 3a5d 2c20  surface[i,j,:], 
-00012ae0: 7375 7266 6163 655b 692b 312c 6a2c 3a5d  surface[i+1,j,:]
-00012af0: 2c20 5030 2c20 5031 2c20 5033 290d 0a20  , P0, P1, P3).. 
+00012080: 2020 5030 3a20 6e70 2e6e 6461 7272 6179    P0: np.ndarray
+00012090: 2c20 5031 3a20 6e70 2e6e 6461 7272 6179  , P1: np.ndarray
+000120a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000120b0: 2020 2020 2020 2020 2020 2050 333a 206e             P3: n
+000120c0: 702e 6e64 6172 7261 7929 202d 3e20 5475  p.ndarray) -> Tu
+000120d0: 706c 655b 6e70 2e6e 6461 7272 6179 2c20  ple[np.ndarray, 
+000120e0: 666c 6f61 742c 2066 6c6f 6174 2c20 666c  float, float, fl
+000120f0: 6f61 745d 3a0d 0a20 2020 2027 2727 0d0a  oat]:..    '''..
+00012100: 2020 2020 4361 6c63 756c 6174 6520 7468      Calculate th
+00012110: 6520 696e 7465 7273 6563 7469 6f6e 2070  e intersection p
+00012120: 6f69 6e74 206f 6620 6120 7665 6374 6f72  oint of a vector
+00012130: 2061 6e64 2061 2070 6c61 6e65 2e0d 0a20   and a plane... 
+00012140: 2020 200d 0a20 2020 2050 6172 616d 6574     ..    Paramet
+00012150: 6572 730d 0a20 2020 202d 2d2d 2d2d 2d2d  ers..    -------
+00012160: 2d2d 2d2d 0d0a 2020 2020 5630 2c20 5631  ----..    V0, V1
+00012170: 3a20 6e64 6172 7261 7920 5b33 5d0d 0a20  : ndarray [3].. 
+00012180: 2020 2020 2020 2063 6f6f 7264 696e 6174         coordinat
+00012190: 6573 206f 6620 7665 6374 6f72 3a20 5630  es of vector: V0
+000121a0: 312e 0d0a 2020 2020 5030 2c20 5031 2c20  1...    P0, P1, 
+000121b0: 5033 203a 206e 6461 7272 6179 205b 335d  P3 : ndarray [3]
+000121c0: 0d0a 2020 2020 2020 2020 636f 6f72 6469  ..        coordi
+000121d0: 6e61 7465 7320 6f66 2074 6872 6565 2070  nates of three p
+000121e0: 6f69 6e74 7320 6f66 2070 6c61 6e65 2050  oints of plane P
+000121f0: 3031 3233 2e0d 0a20 2020 200d 0a20 2020  0123...    ..   
+00012200: 2052 6574 7572 6e73 0d0a 2020 2020 2d2d   Returns..    --
+00012210: 2d2d 2d2d 2d0d 0a20 2020 2078 6920 3a20  -----..    xi : 
+00012220: 6e64 6172 7261 7920 5b33 5d0d 0a20 2020  ndarray [3]..   
+00012230: 2020 2020 2069 6e74 6572 7365 6374 696f       intersectio
+00012240: 6e20 706f 696e 740d 0a20 2020 2074 312c  n point..    t1,
+00012250: 2074 3320 3a20 666c 6f61 740d 0a20 2020   t3 : float..   
+00012260: 2020 2020 2072 6174 696f 206f 6620 7869       ratio of xi
+00012270: 2069 6e20 5030 312c 2050 3033 2064 6972   in P01, P03 dir
+00012280: 6563 7469 6f6e 2e0d 0a20 2020 2072 7620  ection...    rv 
+00012290: 3a20 666c 6f61 740d 0a20 2020 2020 2020  : float..       
+000122a0: 2072 6174 696f 206f 6620 7869 2069 6e20   ratio of xi in 
+000122b0: 5630 3120 6469 7265 6374 696f 6e2e 0d0a  V01 direction...
+000122c0: 2020 2020 0d0a 2020 2020 4578 616d 706c      ..    Exampl
+000122d0: 6573 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  es..    --------
+000122e0: 2d0d 0a20 2020 203e 3e3e 2078 692c 2074  -..    >>> xi, t
+000122f0: 312c 2074 332c 2072 7620 3d20 696e 7465  1, t3, rv = inte
+00012300: 7273 6563 745f 7665 635f 706c 616e 6528  rsect_vec_plane(
+00012310: 5630 2c20 5631 2c20 5030 2c20 5031 2c20  V0, V1, P0, P1, 
+00012320: 5033 290d 0a0d 0a20 2020 2027 2727 0d0a  P3)....    '''..
+00012330: 2020 2020 6e52 2020 3d20 5631 202d 2056      nR  = V1 - V
+00012340: 300d 0a20 2020 206c 3020 203d 206e 702e  0..    l0  = np.
+00012350: 6c69 6e61 6c67 2e6e 6f72 6d28 6e52 2920  linalg.norm(nR) 
+00012360: 2b20 3145 2d32 300d 0a20 2020 206e 5220  + 1E-20..    nR 
+00012370: 203d 206e 5220 2f20 6c30 0d0a 2020 2020   = nR / l0..    
+00012380: 0d0a 2020 2020 4120 3d20 6e70 2e7a 6572  ..    A = np.zer
+00012390: 6f73 2828 332c 3329 290d 0a20 2020 2041  os((3,3))..    A
+000123a0: 5b3a 2c30 5d20 3d20 5031 2d50 300d 0a20  [:,0] = P1-P0.. 
+000123b0: 2020 2041 5b3a 2c31 5d20 3d20 5033 2d50     A[:,1] = P3-P
+000123c0: 300d 0a20 2020 2041 5b3a 2c32 5d20 3d20  0..    A[:,2] = 
+000123d0: 2d20 6e52 0d0a 2020 2020 4220 3d20 5630  - nR..    B = V0
+000123e0: 2d50 300d 0a20 2020 200d 0a20 2020 2053  -P0..    ..    S
+000123f0: 6f6c 203d 206e 702e 6c69 6e61 6c67 2e73  ol = np.linalg.s
+00012400: 6f6c 7665 2841 2c20 4229 0d0a 2020 2020  olve(A, B)..    
+00012410: 0d0a 2020 2020 7431 203d 2053 6f6c 5b30  ..    t1 = Sol[0
+00012420: 5d0d 0a20 2020 2074 3320 3d20 536f 6c5b  ]..    t3 = Sol[
+00012430: 315d 0d0a 2020 2020 7276 203d 2053 6f6c  1]..    rv = Sol
+00012440: 5b32 5d2f 6c30 0d0a 2020 2020 7869 203d  [2]/l0..    xi =
+00012450: 2056 3020 2b20 6e52 2a53 6f6c 5b32 5d0d   V0 + nR*Sol[2].
+00012460: 0a0d 0a20 2020 2072 6574 7572 6e20 7869  ...    return xi
+00012470: 2c20 7431 2c20 7433 2c20 7276 0d0a 0d0a  , t1, t3, rv....
+00012480: 6465 6620 696e 7465 7273 6563 745f 7375  def intersect_su
+00012490: 7266 6163 655f 706c 616e 6528 7375 7266  rface_plane(surf
+000124a0: 6163 653a 206e 702e 6e64 6172 7261 792c  ace: np.ndarray,
+000124b0: 2050 303a 206e 702e 6e64 6172 7261 792c   P0: np.ndarray,
+000124c0: 2050 313a 206e 702e 6e64 6172 7261 792c   P1: np.ndarray,
+000124d0: 2050 333a 206e 702e 6e64 6172 7261 792c   P3: np.ndarray,
+000124e0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000124f0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00012500: 6974 6869 6e5f 626f 756e 6473 3d46 616c  ithin_bounds=Fal
+00012510: 7365 2c20 6f72 6967 696e 616c 5f6f 7264  se, original_ord
+00012520: 6572 3d46 616c 7365 293a 0d0a 2020 2020  er=False):..    
+00012530: 2727 270d 0a20 2020 2043 616c 6375 6c61  '''..    Calcula
+00012540: 7465 2074 6865 2069 6e74 6572 7365 6374  te the intersect
+00012550: 696f 6e20 6375 7276 6520 6f66 2061 2073  ion curve of a s
+00012560: 7572 6661 6365 2061 6e64 2061 2070 6c61  urface and a pla
+00012570: 6e65 2e0d 0a20 2020 200d 0a20 2020 2050  ne...    ..    P
+00012580: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
+00012590: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2073  ---------..    s
+000125a0: 7572 6661 6365 203a 206e 6461 7272 6179  urface : ndarray
+000125b0: 205b 6e69 2c6e 6a2c 335d 0d0a 2020 2020   [ni,nj,3]..    
+000125c0: 2020 2020 636f 6f72 6469 6e61 7465 7320      coordinates 
+000125d0: 6f66 2073 7572 6661 6365 2e0d 0a20 2020  of surface...   
+000125e0: 2050 302c 2050 312c 2050 3320 3a20 6e64   P0, P1, P3 : nd
+000125f0: 6172 7261 7920 5b33 5d0d 0a20 2020 2020  array [3]..     
+00012600: 2020 2063 6f6f 7264 696e 6174 6573 206f     coordinates o
+00012610: 6620 7468 7265 6520 706f 696e 7473 206f  f three points o
+00012620: 6620 706c 616e 6520 5030 3132 330d 0a20  f plane P0123.. 
+00012630: 2020 2077 6974 6869 6e5f 626f 756e 6473     within_bounds
+00012640: 203a 2062 6f6f 6c0d 0a20 2020 2020 2020   : bool..       
+00012650: 2069 6620 5472 7565 2c20 6f6e 6c79 206b   if True, only k
+00012660: 6565 7020 7468 6520 6375 7276 6520 7769  eep the curve wi
+00012670: 7468 696e 2074 6865 2062 6f75 6e64 7320  thin the bounds 
+00012680: 6f66 2050 3031 3233 2e0d 0a20 2020 206f  of P0123...    o
+00012690: 7269 6769 6e61 6c5f 6f72 6465 7220 3a20  riginal_order : 
+000126a0: 626f 6f6c 0d0a 2020 2020 2020 2020 6966  bool..        if
+000126b0: 2046 616c 7365 2c20 7265 6172 7261 6e67   False, rearrang
+000126c0: 6520 706f 696e 7473 2074 6f20 666f 726d  e points to form
+000126d0: 2061 2073 6d6f 6f74 6820 6375 7276 652e   a smooth curve.
+000126e0: 0d0a 2020 2020 0d0a 2020 2020 5265 7475  ..    ..    Retu
+000126f0: 726e 730d 0a20 2020 202d 2d2d 2d2d 2d2d  rns..    -------
+00012700: 2d2d 0d0a 2020 2020 6375 7276 6520 3a20  --..    curve : 
+00012710: 6c69 7374 206f 6620 6e64 6172 7261 7920  list of ndarray 
+00012720: 5b33 5d0d 0a20 2020 2020 2020 2069 6e74  [3]..        int
+00012730: 6572 7365 6374 696f 6e20 6375 7276 652e  ersection curve.
+00012740: 0d0a 2020 2020 696a 5f63 7572 7665 203a  ..    ij_curve :
+00012750: 206c 6973 7420 6f66 205b 692c 6a5d 0d0a   list of [i,j]..
+00012760: 2020 2020 2020 2020 7468 6520 696e 6465          the inde
+00012770: 7820 6f66 206e 6561 7265 7374 2070 6f69  x of nearest poi
+00012780: 6e74 2069 6e20 7375 7266 6163 6520 746f  nt in surface to
+00012790: 2065 6163 6820 706f 696e 7420 6f66 2063   each point of c
+000127a0: 7572 7665 2e0d 0a20 2020 2078 695f 6375  urve...    xi_cu
+000127b0: 7276 652c 2079 745f 6375 7276 653a 206e  rve, yt_curve: n
+000127c0: 6461 7272 6179 205b 3a5d 0d0a 2020 2020  darray [:]..    
+000127d0: 2020 2020 7265 6c61 7469 7665 2063 6f6f      relative coo
+000127e0: 7264 696e 6174 6573 2069 6e20 7468 6520  rdinates in the 
+000127f0: 706c 616e 6520 5030 3132 332c 2072 616e  plane P0123, ran
+00012800: 6765 2069 6e20 5b30 2c31 5d2e 0d0a 2020  ge in [0,1]...  
+00012810: 2020 0d0a 2020 2020 4578 616d 706c 6573    ..    Examples
+00012820: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
+00012830: 2d2d 0d0a 2020 2020 3e3e 3e20 6375 7276  --..    >>> curv
+00012840: 652c 2069 6a5f 6375 7276 652c 2078 695f  e, ij_curve, xi_
+00012850: 6375 7276 652c 2079 745f 6375 7276 6520  curve, yt_curve 
+00012860: 3d20 696e 7465 7273 6563 745f 7375 7266  = intersect_surf
+00012870: 6163 655f 706c 616e 6528 7375 7266 6163  ace_plane(surfac
+00012880: 652c 2050 302c 2050 312c 2050 3329 0d0a  e, P0, P1, P3)..
+00012890: 0d0a 2020 2020 2727 270d 0a0d 0a20 2020  ..    '''....   
+000128a0: 206e 6920 3d20 7375 7266 6163 652e 7368   ni = surface.sh
+000128b0: 6170 655b 305d 0d0a 2020 2020 6e6a 203d  ape[0]..    nj =
+000128c0: 2073 7572 6661 6365 2e73 6861 7065 5b31   surface.shape[1
+000128d0: 5d0d 0a20 2020 206e 6f72 6d20 3d20 6e70  ]..    norm = np
+000128e0: 2e63 726f 7373 2850 312d 5030 2c20 5033  .cross(P1-P0, P3
+000128f0: 2d50 3029 0d0a 2020 2020 6e6f 726d 203d  -P0)..    norm =
+00012900: 206e 6f72 6d2f 6e70 2e6c 696e 616c 672e   norm/np.linalg.
+00012910: 6e6f 726d 286e 6f72 6d29 0d0a 2020 2020  norm(norm)..    
+00012920: 0d0a 2020 2020 6375 7276 6520 3d20 5b5d  ..    curve = []
+00012930: 0d0a 2020 2020 696a 5f63 7572 7665 203d  ..    ij_curve =
+00012940: 205b 5d0d 0a20 2020 2078 695f 6375 7276   []..    xi_curv
+00012950: 6520 3d20 5b5d 0d0a 2020 2020 7974 5f63  e = []..    yt_c
+00012960: 7572 7665 203d 205b 5d0d 0a0d 0a20 2020  urve = []....   
+00012970: 2023 2a20 546f 206c 6f63 6174 6520 706f   #* To locate po
+00012980: 696e 7473 2069 6e20 626f 7468 2073 6964  ints in both sid
+00012990: 6573 206f 6620 7468 6520 706c 616e 650d  es of the plane.
+000129a0: 0a20 2020 206e 6f72 6d5f 6469 7320 3d20  .    norm_dis = 
+000129b0: 6e70 2e64 6f74 2873 7572 6661 6365 2d50  np.dot(surface-P
+000129c0: 302c 206e 6f72 6d29 2023 205b 6e69 2c6e  0, norm) # [ni,n
+000129d0: 6a5d 0d0a 2020 2020 0d0a 2020 2020 666f  j]..    ..    fo
+000129e0: 7220 6a20 696e 2072 616e 6765 286e 6a29  r j in range(nj)
+000129f0: 3a0d 0a20 2020 2020 2020 2066 6f72 2069  :..        for i
+00012a00: 2069 6e20 7261 6e67 6528 6e69 293a 0d0a   in range(ni):..
+00012a10: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00012a20: 2020 2020 2020 2020 2020 6966 2069 3c6e            if i<n
+00012a30: 692d 313a 0d0a 2020 2020 2020 2020 2020  i-1:..          
+00012a40: 2020 2020 2020 6966 206e 6f72 6d5f 6469        if norm_di
+00012a50: 735b 692c 6a5d 2a6e 6f72 6d5f 6469 735b  s[i,j]*norm_dis[
+00012a60: 692b 312c 6a5d 3c30 206f 7220 6e6f 726d  i+1,j]<0 or norm
+00012a70: 5f64 6973 5b69 2c6a 5d3d 3d30 3a0d 0a20  _dis[i,j]==0:.. 
+00012a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012a90: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00012aa0: 2020 2020 2020 2020 2078 692c 2074 312c           xi, t1,
+00012ab0: 2074 332c 2072 7620 3d20 696e 7465 7273   t3, rv = inters
+00012ac0: 6563 745f 7665 635f 706c 616e 6528 7375  ect_vec_plane(su
+00012ad0: 7266 6163 655b 692c 6a2c 3a5d 2c20 7375  rface[i,j,:], su
+00012ae0: 7266 6163 655b 692b 312c 6a2c 3a5d 2c20  rface[i+1,j,:], 
+00012af0: 5030 2c20 5031 2c20 5033 290d 0a20 2020  P0, P1, P3)..   
 00012b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012b10: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00012b20: 2020 2020 2020 2020 2069 6620 7276 3c3d           if rv<=
-00012b30: 302e 3020 6f72 2072 763e 3d31 2e30 3a0d  0.0 or rv>=1.0:.
-00012b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012b50: 2020 2020 2020 2020 2072 6169 7365 2045           raise E
-00012b60: 7863 6570 7469 6f6e 2827 6e6f 726d 2070  xception('norm p
-00012b70: 726f 6475 6374 2073 686f 756c 6420 6775  roduct should gu
-00012b80: 6172 616e 7465 6520 7276 2069 6e20 2830  arantee rv in (0
-00012b90: 2c31 2927 290d 0a20 2020 2020 2020 2020  ,1)')..         
-00012ba0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00012bb0: 7769 7468 696e 5f62 6f75 6e64 7320 616e  within_bounds an
-00012bc0: 6420 2874 313c 302e 3020 6f72 2074 313e  d (t1<0.0 or t1>
-00012bd0: 312e 3020 6f72 2074 333c 302e 3020 6f72  1.0 or t3<0.0 or
-00012be0: 2074 333e 312e 3029 3a0d 0a20 2020 2020   t3>1.0):..     
+00012b10: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00012b20: 2020 2020 2020 2069 6620 7276 3c3d 302e         if rv<=0.
+00012b30: 3020 6f72 2072 763e 3d31 2e30 3a0d 0a20  0 or rv>=1.0:.. 
+00012b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012b50: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
+00012b60: 6570 7469 6f6e 2827 6e6f 726d 2070 726f  eption('norm pro
+00012b70: 6475 6374 2073 686f 756c 6420 6775 6172  duct should guar
+00012b80: 616e 7465 6520 7276 2069 6e20 2830 2c31  antee rv in (0,1
+00012b90: 2927 290d 0a20 2020 2020 2020 2020 2020  )')..           
+00012ba0: 2020 2020 2020 2020 2065 6c69 6620 7769           elif wi
+00012bb0: 7468 696e 5f62 6f75 6e64 7320 616e 6420  thin_bounds and 
+00012bc0: 2874 313c 302e 3020 6f72 2074 313e 312e  (t1<0.0 or t1>1.
+00012bd0: 3020 6f72 2074 333c 302e 3020 6f72 2074  0 or t3<0.0 or t
+00012be0: 333e 312e 3029 3a0d 0a20 2020 2020 2020  3>1.0):..       
 00012bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c00: 2020 2063 6f6e 7469 6e75 650d 0a20 2020     continue..   
-00012c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c20: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00012c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c40: 696a 5f63 7572 7665 2e61 7070 656e 6428  ij_curve.append(
-00012c50: 5b69 2c6a 5d29 0d0a 2020 2020 2020 2020  [i,j])..        
-00012c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c70: 6375 7276 652e 6170 7065 6e64 2878 692e  curve.append(xi.
-00012c80: 636f 7079 2829 290d 0a20 2020 2020 2020  copy())..       
-00012c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ca0: 2078 695f 6375 7276 652e 6170 7065 6e64   xi_curve.append
-00012cb0: 2874 3129 0d0a 2020 2020 2020 2020 2020  (t1)..          
-00012cc0: 2020 2020 2020 2020 2020 2020 2020 7974                yt
-00012cd0: 5f63 7572 7665 2e61 7070 656e 6428 7433  _curve.append(t3
-00012ce0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00012cf0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
-00012d00: 6e75 650d 0a0d 0a20 2020 2020 2020 2020  nue....         
-00012d10: 2020 2069 6620 6a3c 6e6a 2d31 3a0d 0a20     if j<nj-1:.. 
-00012d20: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00012d30: 6620 6e6f 726d 5f64 6973 5b69 2c6a 5d2a  f norm_dis[i,j]*
-00012d40: 6e6f 726d 5f64 6973 5b69 2c6a 2b31 5d3c  norm_dis[i,j+1]<
-00012d50: 3020 6f72 206e 6f72 6d5f 6469 735b 692c  0 or norm_dis[i,
-00012d60: 6a5d 3d3d 303a 0d0a 2020 2020 2020 2020  j]==0:..        
-00012d70: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00012c00: 2063 6f6e 7469 6e75 650d 0a20 2020 2020   continue..     
+00012c10: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00012c20: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00012c30: 2020 2020 2020 2020 2020 2020 2020 696a                ij
+00012c40: 5f63 7572 7665 2e61 7070 656e 6428 5b69  _curve.append([i
+00012c50: 2c6a 5d29 0d0a 2020 2020 2020 2020 2020  ,j])..          
+00012c60: 2020 2020 2020 2020 2020 2020 2020 6375                cu
+00012c70: 7276 652e 6170 7065 6e64 2878 692e 636f  rve.append(xi.co
+00012c80: 7079 2829 290d 0a20 2020 2020 2020 2020  py())..         
+00012c90: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+00012ca0: 695f 6375 7276 652e 6170 7065 6e64 2874  i_curve.append(t
+00012cb0: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
+00012cc0: 2020 2020 2020 2020 2020 2020 7974 5f63              yt_c
+00012cd0: 7572 7665 2e61 7070 656e 6428 7433 290d  urve.append(t3).
+00012ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012cf0: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+00012d00: 650d 0a0d 0a20 2020 2020 2020 2020 2020  e....           
+00012d10: 2069 6620 6a3c 6e6a 2d31 3a0d 0a20 2020   if j<nj-1:..   
+00012d20: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00012d30: 6e6f 726d 5f64 6973 5b69 2c6a 5d2a 6e6f  norm_dis[i,j]*no
+00012d40: 726d 5f64 6973 5b69 2c6a 2b31 5d3c 3020  rm_dis[i,j+1]<0 
+00012d50: 6f72 206e 6f72 6d5f 6469 735b 692c 6a5d  or norm_dis[i,j]
+00012d60: 3d3d 303a 0d0a 2020 2020 2020 2020 2020  ==0:..          
+00012d70: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
 00012d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d90: 2020 7869 2c20 7431 2c20 7433 2c20 7276    xi, t1, t3, rv
-00012da0: 203d 2069 6e74 6572 7365 6374 5f76 6563   = intersect_vec
-00012db0: 5f70 6c61 6e65 2873 7572 6661 6365 5b69  _plane(surface[i
-00012dc0: 2c6a 2c3a 5d2c 2073 7572 6661 6365 5b69  ,j,:], surface[i
-00012dd0: 2c6a 2b31 2c3a 5d2c 2050 302c 2050 312c  ,j+1,:], P0, P1,
-00012de0: 2050 3329 0d0a 2020 2020 2020 2020 2020   P3)..          
-00012df0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00012e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012e10: 6966 2072 763c 3d30 2e30 206f 7220 7276  if rv<=0.0 or rv
-00012e20: 3e3d 312e 303a 0d0a 2020 2020 2020 2020  >=1.0:..        
-00012e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012e40: 7261 6973 6520 4578 6365 7074 696f 6e28  raise Exception(
-00012e50: 276e 6f72 6d20 7072 6f64 7563 7420 7368  'norm product sh
-00012e60: 6f75 6c64 2067 7561 7261 6e74 6565 2072  ould guarantee r
-00012e70: 7620 696e 2028 302c 3129 2729 0d0a 2020  v in (0,1)')..  
+00012d90: 7869 2c20 7431 2c20 7433 2c20 7276 203d  xi, t1, t3, rv =
+00012da0: 2069 6e74 6572 7365 6374 5f76 6563 5f70   intersect_vec_p
+00012db0: 6c61 6e65 2873 7572 6661 6365 5b69 2c6a  lane(surface[i,j
+00012dc0: 2c3a 5d2c 2073 7572 6661 6365 5b69 2c6a  ,:], surface[i,j
+00012dd0: 2b31 2c3a 5d2c 2050 302c 2050 312c 2050  +1,:], P0, P1, P
+00012de0: 3329 0d0a 2020 2020 2020 2020 2020 2020  3)..            
+00012df0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00012e00: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00012e10: 2072 763c 3d30 2e30 206f 7220 7276 3e3d   rv<=0.0 or rv>=
+00012e20: 312e 303a 0d0a 2020 2020 2020 2020 2020  1.0:..          
+00012e30: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00012e40: 6973 6520 4578 6365 7074 696f 6e28 276e  ise Exception('n
+00012e50: 6f72 6d20 7072 6f64 7563 7420 7368 6f75  orm product shou
+00012e60: 6c64 2067 7561 7261 6e74 6565 2072 7620  ld guarantee rv 
+00012e70: 696e 2028 302c 3129 2729 0d0a 2020 2020  in (0,1)')..    
 00012e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012e90: 2020 656c 6966 2077 6974 6869 6e5f 626f    elif within_bo
-00012ea0: 756e 6473 2061 6e64 2028 7431 3c30 2e30  unds and (t1<0.0
-00012eb0: 206f 7220 7431 3e31 2e30 206f 7220 7433   or t1>1.0 or t3
-00012ec0: 3c30 2e30 206f 7220 7433 3e31 2e30 293a  <0.0 or t3>1.0):
-00012ed0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012ee0: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-00012ef0: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
-00012f00: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00012e90: 656c 6966 2077 6974 6869 6e5f 626f 756e  elif within_boun
+00012ea0: 6473 2061 6e64 2028 7431 3c30 2e30 206f  ds and (t1<0.0 o
+00012eb0: 7220 7431 3e31 2e30 206f 7220 7433 3c30  r t1>1.0 or t3<0
+00012ec0: 2e30 206f 7220 7433 3e31 2e30 293a 0d0a  .0 or t3>1.0):..
+00012ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012ee0: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
+00012ef0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012f00: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
 00012f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f20: 2020 2020 2020 2069 6a5f 6375 7276 652e         ij_curve.
-00012f30: 6170 7065 6e64 285b 692c 6a5d 290d 0a20  append([i,j]).. 
+00012f20: 2020 2020 2069 6a5f 6375 7276 652e 6170       ij_curve.ap
+00012f30: 7065 6e64 285b 692c 6a5d 290d 0a20 2020  pend([i,j])..   
 00012f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f50: 2020 2020 2020 2063 7572 7665 2e61 7070         curve.app
-00012f60: 656e 6428 7869 2e63 6f70 7928 2929 0d0a  end(xi.copy())..
+00012f50: 2020 2020 2063 7572 7665 2e61 7070 656e       curve.appen
+00012f60: 6428 7869 2e63 6f70 7928 2929 0d0a 2020  d(xi.copy())..  
 00012f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f80: 2020 2020 2020 2020 7869 5f63 7572 7665          xi_curve
-00012f90: 2e61 7070 656e 6428 7431 290d 0a20 2020  .append(t1)..   
+00012f80: 2020 2020 2020 7869 5f63 7572 7665 2e61        xi_curve.a
+00012f90: 7070 656e 6428 7431 290d 0a20 2020 2020  ppend(t1)..     
 00012fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012fb0: 2020 2020 2079 745f 6375 7276 652e 6170       yt_curve.ap
-00012fc0: 7065 6e64 2874 3329 0d0a 2020 2020 2020  pend(t3)..      
+00012fb0: 2020 2079 745f 6375 7276 652e 6170 7065     yt_curve.appe
+00012fc0: 6e64 2874 3329 0d0a 2020 2020 2020 2020  nd(t3)..        
 00012fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012fe0: 2020 636f 6e74 696e 7565 0d0a 0d0a 2020    continue....  
-00012ff0: 2020 232a 2052 6561 7272 616e 6765 2070    #* Rearrange p
-00013000: 6f69 6e74 7320 696e 2063 6f72 7265 6374  oints in correct
-00013010: 206f 7264 6572 0d0a 2020 2020 7869 5f63   order..    xi_c
-00013020: 7572 7665 203d 206e 702e 6172 7261 7928  urve = np.array(
-00013030: 7869 5f63 7572 7665 290d 0a20 2020 2079  xi_curve)..    y
-00013040: 745f 6375 7276 6520 3d20 6e70 2e61 7272  t_curve = np.arr
-00013050: 6179 2879 745f 6375 7276 6529 0d0a 2020  ay(yt_curve)..  
-00013060: 2020 0d0a 2020 2020 6966 206c 656e 2863    ..    if len(c
-00013070: 7572 7665 293e 3220 616e 6420 6e6f 7420  urve)>2 and not 
-00013080: 6f72 6967 696e 616c 5f6f 7264 6572 3a0d  original_order:.
-00013090: 0a20 2020 2020 2020 205f 2c20 6f6c 645f  .        _, old_
-000130a0: 696e 6465 7820 3d20 7265 6172 7261 6e67  index = rearrang
-000130b0: 655f 706f 696e 7473 2878 695f 6375 7276  e_points(xi_curv
-000130c0: 652c 2079 745f 6375 7276 6529 0d0a 2020  e, yt_curve)..  
-000130d0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000130e0: 6375 7276 6520 2020 203d 205b 6375 7276  curve    = [curv
-000130f0: 655b 6969 5d20 2020 2066 6f72 2069 6920  e[ii]    for ii 
-00013100: 696e 206f 6c64 5f69 6e64 6578 5d0d 0a20  in old_index].. 
-00013110: 2020 2020 2020 2069 6a5f 6375 7276 6520         ij_curve 
-00013120: 3d20 5b69 6a5f 6375 7276 655b 6969 5d20  = [ij_curve[ii] 
-00013130: 666f 7220 6969 2069 6e20 6f6c 645f 696e  for ii in old_in
-00013140: 6465 785d 0d0a 2020 2020 2020 2020 7869  dex]..        xi
-00013150: 5f63 7572 7665 203d 206e 702e 6172 7261  _curve = np.arra
-00013160: 7928 5b78 695f 6375 7276 655b 6969 5d20  y([xi_curve[ii] 
-00013170: 666f 7220 6969 2069 6e20 6f6c 645f 696e  for ii in old_in
-00013180: 6465 785d 290d 0a20 2020 2020 2020 2079  dex])..        y
-00013190: 745f 6375 7276 6520 3d20 6e70 2e61 7272  t_curve = np.arr
-000131a0: 6179 285b 7974 5f63 7572 7665 5b69 695d  ay([yt_curve[ii]
-000131b0: 2066 6f72 2069 6920 696e 206f 6c64 5f69   for ii in old_i
-000131c0: 6e64 6578 5d29 0d0a 0d0a 2020 2020 7265  ndex])....    re
-000131d0: 7475 726e 2063 7572 7665 2c20 696a 5f63  turn curve, ij_c
-000131e0: 7572 7665 2c20 7869 5f63 7572 7665 2c20  urve, xi_curve, 
-000131f0: 7974 5f63 7572 7665 0d0a 0d0a 6465 6620  yt_curve....def 
-00013200: 7265 6172 7261 6e67 655f 706f 696e 7473  rearrange_points
-00013210: 2878 693a 206e 702e 6e64 6172 7261 792c  (xi: np.ndarray,
-00013220: 2079 743a 206e 702e 6e64 6172 7261 792c   yt: np.ndarray,
-00013230: 2061 7667 5f64 6972 3d4e 6f6e 652c 200d   avg_dir=None, .
-00013240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013250: 2020 2020 2020 6372 695f 6272 6561 6b3d        cri_break=
-00013260: 302e 3032 2c20 6372 695f 6475 703d 3165  0.02, cri_dup=1e
-00013270: 2d36 2920 2d3e 2054 7570 6c65 5b6e 702e  -6) -> Tuple[np.
-00013280: 6e64 6172 7261 792c 204c 6973 745b 696e  ndarray, List[in
-00013290: 745d 5d3a 0d0a 2020 2020 2727 270d 0a20  t]]:..    '''.. 
-000132a0: 2020 2052 6561 7272 616e 6765 2061 206c     Rearrange a l
-000132b0: 6973 7420 6f66 2070 6f69 6e74 7320 696e  ist of points in
-000132c0: 2061 2032 4420 6375 7276 652e 0d0a 2020   a 2D curve...  
-000132d0: 2020 0d0a 2020 2020 5061 7261 6d65 7465    ..    Paramete
-000132e0: 7273 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  rs..    --------
-000132f0: 2d2d 0d0a 2020 2020 7869 2c20 7974 203a  --..    xi, yt :
-00013300: 206e 6461 7272 6179 205b 6e5d 0d0a 2020   ndarray [n]..  
-00013310: 2020 2020 2020 3244 2063 6f6f 7264 696e        2D coordin
-00013320: 6174 6573 206f 6620 7468 6520 706f 696e  ates of the poin
-00013330: 7473 2e0d 0a20 2020 2061 7667 5f64 6972  ts...    avg_dir
-00013340: 203a 204e 6f6e 6520 6f72 206e 6461 7272   : None or ndarr
-00013350: 6179 205b 325d 0d0a 2020 2020 2020 2020  ay [2]..        
-00013360: 6966 206e 6461 7272 6179 2c20 7370 6563  if ndarray, spec
-00013370: 6966 6965 6420 6176 6572 6167 6520 6469  ified average di
-00013380: 7265 6374 696f 6e2c 2074 6865 2073 7461  rection, the sta
-00013390: 7274 2070 6f69 6e74 2069 7320 6669 7865  rt point is fixe
-000133a0: 6420 666f 7220 7468 6520 6375 7276 652e  d for the curve.
-000133b0: 0d0a 2020 2020 6372 695f 6272 6561 6b20  ..    cri_break 
-000133c0: 3a20 666c 6f61 740d 0a20 2020 2020 2020  : float..       
-000133d0: 2063 7269 7469 6361 6c20 7261 7469 6f20   critical ratio 
-000133e0: 746f 2064 6563 6964 6520 7768 6574 6865  to decide whethe
-000133f0: 7220 7468 6520 706f 696e 7420 6973 2074  r the point is t
-00013400: 6865 2065 6e64 2070 6f69 6e74 206f 6620  he end point of 
-00013410: 7468 6520 6375 7276 652e 0d0a 2020 2020  the curve...    
-00013420: 6372 695f 6475 7020 3a20 666c 6f61 740d  cri_dup : float.
-00013430: 0a20 2020 2020 2020 2063 7269 7469 6361  .        critica
-00013440: 6c20 6469 7374 616e 6365 2074 6f20 6472  l distance to dr
-00013450: 6f70 2064 7570 6c69 6361 7465 6420 706f  op duplicated po
-00013460: 696e 7473 2e0d 0a20 2020 200d 0a20 2020  ints...    ..   
-00013470: 2052 6574 7572 6e73 0d0a 2020 2020 2d2d   Returns..    --
-00013480: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 6e65  --------..    ne
-00013490: 775f 6375 7276 6520 3a20 6e64 6172 7261  w_curve : ndarra
-000134a0: 7920 5b6e 2c32 5d0d 0a20 2020 2020 2020  y [n,2]..       
-000134b0: 206e 6577 2063 7572 7665 2e0d 0a20 2020   new curve...   
-000134c0: 206f 6c64 5f69 6e64 6578 203a 206c 6973   old_index : lis
-000134d0: 7420 6f66 2069 6e74 0d0a 2020 2020 2020  t of int..      
-000134e0: 2020 7468 6520 696e 6465 7820 6f66 2070    the index of p
-000134f0: 6f69 6e74 2069 6e20 7468 6520 6f72 6967  oint in the orig
-00013500: 696e 616c 2063 7572 7665 2e0d 0a20 2020  inal curve...   
-00013510: 200d 0a20 2020 2045 7861 6d70 6c65 730d   ..    Examples.
-00013520: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d  .    ----------.
-00013530: 0a20 2020 203e 3e3e 206e 6577 5f63 7572  .    >>> new_cur
-00013540: 7665 2c20 6f6c 645f 696e 6465 7820 3d20  ve, old_index = 
-00013550: 7265 6172 7261 6e67 655f 706f 696e 7473  rearrange_points
-00013560: 2878 692c 2079 742c 2061 7667 5f64 6972  (xi, yt, avg_dir
-00013570: 3d4e 6f6e 652c 2063 7269 5f62 7265 616b  =None, cri_break
-00013580: 3d30 2e31 290d 0a20 2020 200d 0a20 2020  =0.1)..    ..   
-00013590: 204e 6f74 6573 0d0a 2020 2020 2d2d 2d2d   Notes..    ----
-000135a0: 2d2d 2d0d 0a20 2020 2054 6865 7265 2061  ---..    There a
-000135b0: 7265 2061 2066 6577 2061 7373 756d 7074  re a few assumpt
-000135c0: 696f 6e73 3a20 0d0a 2020 2020 0d0a 2020  ions: ..    ..  
-000135d0: 2020 312e 2069 7420 6973 2061 6e20 6f70    1. it is an op
-000135e0: 656e 2063 7572 7665 2077 6974 6820 6e6f  en curve with no
-000135f0: 2069 6e74 6572 7365 6374 696f 6e73 0d0a   intersections..
-00013600: 2020 2020 0d0a 2020 2020 322e 206d 6f73      ..    2. mos
-00013610: 7420 6f66 2074 6865 2070 6f69 6e74 7320  t of the points 
-00013620: 6172 6520 696e 2074 6865 2063 6f72 7265  are in the corre
-00013630: 6374 2028 6c6f 6361 6c29 206f 7264 6572  ct (local) order
-00013640: 2c0d 0a20 2020 2074 6869 7320 6769 7665  ,..    this give
-00013650: 7320 7573 2061 2061 7665 7261 6765 2064  s us a average d
-00013660: 6972 6563 7469 6f6e 206f 6620 7468 6520  irection of the 
-00013670: 6375 7276 652c 2077 6869 6368 2063 616e  curve, which can
-00013680: 200d 0a20 2020 2068 656c 7020 7573 2066   ..    help us f
-00013690: 696e 6420 7468 6520 7374 6172 7469 6e67  ind the starting
-000136a0: 2f65 6e64 2070 6f69 6e74 206f 6620 7468  /end point of th
-000136b0: 6520 6375 7276 650d 0a20 2020 200d 0a20  e curve..    .. 
-000136c0: 2020 2033 2e20 7468 6520 6e65 7874 2070     3. the next p
-000136d0: 6f69 6e74 2069 7320 6974 7320 636c 6f73  oint is its clos
-000136e0: 6573 7420 706f 696e 7420 6f72 2074 6865  est point or the
-000136f0: 2063 6c6f 7365 7374 2070 6f69 6e74 2069   closest point i
-00013700: 6e20 7468 6520 6176 6572 6167 6520 6469  n the average di
-00013710: 7265 6374 696f 6e0d 0a20 2020 200d 0a20  rection..    .. 
-00013720: 2020 2034 2e20 6472 6f70 2064 7570 6c69     4. drop dupli
-00013730: 6361 7465 6420 706f 696e 7473 200d 0a20  cated points .. 
-00013740: 2020 200d 0a20 2020 2027 2727 0d0a 2020     ..    '''..  
-00013750: 2020 696e 6465 7865 7320 3d20 6e70 2e61    indexes = np.a
-00013760: 7261 6e67 6528 302e 302c 206c 656e 2878  range(0.0, len(x
-00013770: 6929 2c20 312e 3029 0d0a 2020 2020 706f  i), 1.0)..    po
-00013780: 696e 7473 2020 3d20 6e70 2e61 7272 6179  ints  = np.array
-00013790: 285b 7869 2c20 7974 2c20 696e 6465 7865  ([xi, yt, indexe
-000137a0: 735d 292e 7472 616e 7370 6f73 6528 290d  s]).transpose().
-000137b0: 0a20 2020 2070 6f69 6e74 7320 203d 2070  .    points  = p
-000137c0: 6f69 6e74 732e 636f 7079 2829 2e74 6f6c  oints.copy().tol
-000137d0: 6973 7428 2920 2020 2023 205b 6e2c 335d  ist()    # [n,3]
-000137e0: 0d0a 2020 2020 6e5f 706f 696e 7420 3d20  ..    n_point = 
-000137f0: 6c65 6e28 706f 696e 7473 290d 0a20 2020  len(points)..   
-00013800: 200d 0a20 2020 2063 7269 5f62 7265 616b   ..    cri_break
-00013810: 203d 206d 6178 2863 7269 5f62 7265 616b   = max(cri_break
-00013820: 2c20 322e 302f 6e5f 706f 696e 7429 0d0a  , 2.0/n_point)..
-00013830: 2020 2020 0d0a 2020 2020 232a 2043 616c      ..    #* Cal
-00013840: 6375 6c61 7465 2061 7665 7261 6765 2064  culate average d
-00013850: 6972 6563 7469 6f6e 0d0a 2020 2020 6966  irection..    if
-00013860: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00013870: 6176 675f 6469 722c 206e 702e 6e64 6172  avg_dir, np.ndar
-00013880: 7261 7929 3a0d 0a20 2020 2020 2020 200d  ray):..        .
-00013890: 0a20 2020 2020 2020 2061 7667 5f64 6972  .        avg_dir
-000138a0: 203d 206e 702e 7a65 726f 7328 3229 0d0a   = np.zeros(2)..
-000138b0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000138c0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-000138d0: 286c 656e 2878 6929 2d31 293a 0d0a 2020  (len(xi)-1):..  
-000138e0: 2020 2020 2020 2020 2020 6478 6920 3d20            dxi = 
-000138f0: 7869 5b69 2b31 5d2d 7869 5b69 5d0d 0a20  xi[i+1]-xi[i].. 
-00013900: 2020 2020 2020 2020 2020 2064 7974 203d             dyt =
-00013910: 2079 745b 692b 315d 2d79 745b 695d 0d0a   yt[i+1]-yt[i]..
-00013920: 2020 2020 2020 2020 2020 2020 6c6c 2020              ll  
-00013930: 3d20 6e70 2e73 7172 7428 6478 692a 2a32  = np.sqrt(dxi**2
-00013940: 2b64 7974 2a2a 3229 0d0a 2020 2020 2020  +dyt**2)..      
-00013950: 2020 2020 2020 6966 206c 6c20 3e20 6372        if ll > cr
-00013960: 695f 6475 703a 0d0a 2020 2020 2020 2020  i_dup:..        
-00013970: 2020 2020 2020 2020 6176 675f 6469 7220          avg_dir 
-00013980: 2b3d 206e 702e 6172 7261 7928 5b64 7869  += np.array([dxi
-00013990: 2c64 7974 5d29 0d0a 0d0a 2020 2020 2020  ,dyt])....      
-000139a0: 2020 6c61 203d 206e 702e 6c69 6e61 6c67    la = np.linalg
-000139b0: 2e6e 6f72 6d28 6176 675f 6469 7229 0d0a  .norm(avg_dir)..
-000139c0: 2020 2020 2020 2020 6c78 203d 2061 6273          lx = abs
-000139d0: 2878 695b 2d31 5d2d 7869 5b30 5d29 0d0a  (xi[-1]-xi[0])..
-000139e0: 2020 2020 2020 2020 6c79 203d 2061 6273          ly = abs
-000139f0: 2879 745b 2d31 5d2d 7974 5b30 5d29 0d0a  (yt[-1]-yt[0])..
-00013a00: 0d0a 2020 2020 2020 2020 6966 206c 6120  ..        if la 
-00013a10: 3e20 302e 322a 286c 782b 6c79 293a 0d0a  > 0.2*(lx+ly):..
-00013a20: 2020 2020 2020 2020 2020 2020 6176 675f              avg_
-00013a30: 6469 7220 3d20 6176 675f 6469 722f 6c61  dir = avg_dir/la
-00013a40: 0d0a 2020 2020 2020 2020 656c 6966 206c  ..        elif l
-00013a50: 7820 3e20 6c79 3a0d 0a20 2020 2020 2020  x > ly:..       
-00013a60: 2020 2020 2061 7667 5f64 6972 203d 206e       avg_dir = n
-00013a70: 702e 6172 7261 7928 5b31 2e2c 2030 2e5d  p.array([1., 0.]
-00013a80: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-00013a90: 0d0a 2020 2020 2020 2020 2020 2020 6176  ..            av
-00013aa0: 675f 6469 7220 3d20 6e70 2e61 7272 6179  g_dir = np.array
-00013ab0: 285b 302e 2c20 312e 5d29 0d0a 0d0a 2020  ([0., 1.])....  
-00013ac0: 2020 2020 2020 6969 203d 206e 702e 6172        ii = np.ar
-00013ad0: 676d 6178 286e 702e 6162 7328 6176 675f  gmax(np.abs(avg_
-00013ae0: 6469 7229 290d 0a20 2020 2020 2020 2069  dir))..        i
-00013af0: 6620 6176 675f 6469 725b 6969 5d3c 303a  f avg_dir[ii]<0:
-00013b00: 0d0a 2020 2020 2020 2020 2020 2020 6176  ..            av
-00013b10: 675f 6469 7220 3d20 2d61 7667 5f64 6972  g_dir = -avg_dir
-00013b20: 0d0a 0d0a 2020 2020 2020 2020 6669 785f  ....        fix_
-00013b30: 7374 6172 7420 3d20 4661 6c73 650d 0a20  start = False.. 
-00013b40: 2020 2020 2020 200d 0a20 2020 2065 6c73         ..    els
-00013b50: 653a 0d0a 2020 2020 2020 2020 0d0a 2020  e:..        ..  
-00013b60: 2020 2020 2020 6669 785f 7374 6172 7420        fix_start 
-00013b70: 3d20 5472 7565 0d0a 2020 2020 2020 2020  = True..        
-00013b80: 2020 2020 0d0a 2020 2020 232a 2046 696e      ..    #* Fin
-00013b90: 6420 7468 6520 706f 7465 6e74 6961 6c20  d the potential 
-00013ba0: 7374 6172 7420 706f 696e 740d 0a20 2020  start point..   
-00013bb0: 2064 6420 3d20 6e70 2e64 6f74 286e 702e   dd = np.dot(np.
-00013bc0: 6172 7261 7928 706f 696e 7473 295b 3a2c  array(points)[:,
-00013bd0: 3a32 5d2c 2061 7667 5f64 6972 290d 0a20  :2], avg_dir).. 
-00013be0: 2020 2069 6920 3d20 6e70 2e61 7267 6d69     ii = np.argmi
-00013bf0: 6e28 6464 290d 0a20 2020 206e 6577 5f63  n(dd)..    new_c
-00013c00: 7572 7665 203d 205b 706f 696e 7473 5b69  urve = [points[i
-00013c10: 695d 5d0d 0a20 2020 2070 6f69 6e74 732e  i]]..    points.
-00013c20: 706f 7028 6969 290d 0a20 2020 200d 0a20  pop(ii)..    .. 
-00013c30: 2020 2023 2a20 4765 7420 7468 6520 6c65     #* Get the le
-00013c40: 6e67 7468 2073 6361 6c65 206f 6620 7468  ngth scale of th
-00013c50: 6520 6375 7276 650d 0a20 2020 206a 6a20  e curve..    jj 
-00013c60: 3d20 6e70 2e61 7267 6d61 7828 6464 290d  = np.argmax(dd).
-00013c70: 0a20 2020 206c 7320 3d20 6464 5b6a 6a5d  .    ls = dd[jj]
-00013c80: 2d64 645b 6969 5d0d 0a0d 0a20 2020 2023  -dd[ii]....    #
-00013c90: 2a20 4170 7065 6e64 2063 7572 7665 2069  * Append curve i
-00013ca0: 6e20 7468 6520 6176 6572 6167 6520 6469  n the average di
-00013cb0: 7265 6374 696f 6e0d 0a20 2020 2077 6869  rection..    whi
-00013cc0: 6c65 206c 656e 2870 6f69 6e74 7329 3e30  le len(points)>0
-00013cd0: 3a0d 0a20 2020 2020 2020 200d 0a20 2020  :..        ..   
-00013ce0: 2020 2020 2064 6174 6120 3d20 6e70 2e61       data = np.a
-00013cf0: 7272 6179 2870 6f69 6e74 7329 5b3a 2c3a  rray(points)[:,:
-00013d00: 325d 2020 2023 205b 3a2c 325d 0d0a 2020  2]   # [:,2]..  
-00013d10: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00013d20: 2320 6361 6c63 756c 6174 6520 7468 6520  # calculate the 
-00013d30: 6469 7374 616e 6365 2074 6f20 7468 6520  distance to the 
-00013d40: 6c61 7374 2070 6f69 6e74 0d0a 2020 2020  last point..    
-00013d50: 2020 2020 6c61 7374 5f70 6f69 6e74 203d      last_point =
-00013d60: 206e 702e 6172 7261 7928 6e65 775f 6375   np.array(new_cu
-00013d70: 7276 655b 2d31 5d29 5b4e 6f6e 652c 3a32  rve[-1])[None,:2
-00013d80: 5d20 2020 2320 5b31 2c32 5d0d 0a20 2020  ]   # [1,2]..   
-00013d90: 2020 2020 2064 326c 203d 206e 702e 6c69       d2l = np.li
-00013da0: 6e61 6c67 2e6e 6f72 6d28 6461 7461 2d6c  nalg.norm(data-l
-00013db0: 6173 745f 706f 696e 742c 2061 7869 733d  ast_point, axis=
-00013dc0: 3129 2020 2023 205b 3a5d 0d0a 2020 2020  1)   # [:]..    
-00013dd0: 2020 2020 695f 6c20 3d20 6e70 2e61 7267      i_l = np.arg
-00013de0: 6d69 6e28 6432 6c29 0d0a 2020 2020 2020  min(d2l)..      
-00013df0: 2020 6d69 6e5f 6469 7332 6c61 7374 203d    min_dis2last =
-00013e00: 2064 326c 5b69 5f6c 5d0d 0a20 2020 2020   d2l[i_l]..     
-00013e10: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-00013e20: 6d69 6e5f 6469 7332 6c61 7374 3c63 7269  min_dis2last<cri
-00013e30: 5f64 7570 3a0d 0a20 2020 2020 2020 2020  _dup:..         
-00013e40: 2020 2070 6f69 6e74 732e 706f 7028 695f     points.pop(i_
-00013e50: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
-00013e60: 636f 6e74 696e 7565 0d0a 2020 2020 2020  continue..      
-00013e70: 2020 0d0a 2020 2020 2020 2020 2320 6361    ..        # ca
-00013e80: 6c63 756c 6174 6520 7468 6520 6469 7374  lculate the dist
-00013e90: 616e 6365 2074 6f20 7468 6520 7374 6172  ance to the star
-00013ea0: 7420 706f 696e 740d 0a20 2020 2020 2020  t point..       
-00013eb0: 2073 7461 7274 5f70 6f69 6e74 203d 206e   start_point = n
-00013ec0: 702e 6172 7261 7928 6e65 775f 6375 7276  p.array(new_curv
-00013ed0: 655b 305d 295b 4e6f 6e65 2c3a 325d 2020  e[0])[None,:2]  
-00013ee0: 2023 205b 312c 325d 0d0a 2020 2020 2020   # [1,2]..      
-00013ef0: 2020 6432 7320 3d20 6e70 2e6c 696e 616c    d2s = np.linal
-00013f00: 672e 6e6f 726d 2864 6174 612d 7374 6172  g.norm(data-star
-00013f10: 745f 706f 696e 742c 2061 7869 733d 3129  t_point, axis=1)
-00013f20: 2020 2320 5b3a 5d0d 0a20 2020 2020 2020    # [:]..       
-00013f30: 2069 5f73 203d 206e 702e 6172 676d 696e   i_s = np.argmin
-00013f40: 2864 3273 290d 0a20 2020 2020 2020 206d  (d2s)..        m
-00013f50: 696e 5f64 6973 3273 7461 7274 203d 2064  in_dis2start = d
-00013f60: 3273 5b69 5f73 5d0d 0a20 2020 2020 2020  2s[i_s]..       
-00013f70: 200d 0a20 2020 2020 2020 2069 6620 6432   ..        if d2
-00013f80: 735b 695f 735d 3c63 7269 5f64 7570 3a0d  s[i_s]<cri_dup:.
-00013f90: 0a20 2020 2020 2020 2020 2020 2070 6f69  .            poi
-00013fa0: 6e74 732e 706f 7028 695f 7329 0d0a 2020  nts.pop(i_s)..  
-00013fb0: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-00013fc0: 7565 0d0a 2020 2020 2020 2020 0d0a 2020  ue..        ..  
-00013fd0: 2020 2020 2020 6469 7265 6374 696f 6e5f        direction_
-00013fe0: 6c20 3d20 6e70 2e64 6f74 2864 6174 615b  l = np.dot(data[
-00013ff0: 695f 6c2c 3a5d 2d6c 6173 745f 706f 696e  i_l,:]-last_poin
-00014000: 742c 2020 6176 675f 6469 7229 5b30 5d0d  t,  avg_dir)[0].
-00014010: 0a20 2020 2020 2020 2064 6972 6563 7469  .        directi
-00014020: 6f6e 5f73 203d 206e 702e 646f 7428 6461  on_s = np.dot(da
-00014030: 7461 5b69 5f73 2c3a 5d2d 7374 6172 745f  ta[i_s,:]-start_
-00014040: 706f 696e 742c 2061 7667 5f64 6972 295b  point, avg_dir)[
-00014050: 305d 0d0a 2020 2020 2020 2020 0d0a 2020  0]..        ..  
-00014060: 2020 2020 2020 6966 2028 6d69 6e5f 6469        if (min_di
-00014070: 7332 6c61 7374 3c3d 6d69 6e5f 6469 7332  s2last<=min_dis2
-00014080: 7374 6172 7420 6f72 2066 6978 5f73 7461  start or fix_sta
-00014090: 7274 2920 616e 6420 2864 6972 6563 7469  rt) and (directi
-000140a0: 6f6e 5f6c 3e30 206f 7220 6d69 6e5f 6469  on_l>0 or min_di
-000140b0: 7332 6c61 7374 3c3d 6372 695f 6272 6561  s2last<=cri_brea
-000140c0: 6b2a 6c73 293a 0d0a 2020 2020 2020 2020  k*ls):..        
-000140d0: 2020 2020 2320 4170 7065 6e64 2074 6f20      # Append to 
-000140e0: 7468 6520 6c61 7374 2070 6f69 6e74 2069  the last point i
-000140f0: 6e20 7468 6520 6176 6572 6167 6520 6469  n the average di
-00014100: 7265 6374 696f 6e0d 0a20 2020 2020 2020  rection..       
-00014110: 2020 2020 206e 6577 5f63 7572 7665 2e61       new_curve.a
-00014120: 7070 656e 6428 706f 696e 7473 5b69 5f6c  ppend(points[i_l
-00014130: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00014140: 706f 696e 7473 2e70 6f70 2869 5f6c 290d  points.pop(i_l).
-00014150: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00014160: 7469 6e75 650d 0a20 2020 2020 2020 2020  tinue..         
-00014170: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-00014180: 6d69 6e5f 6469 7332 7374 6172 743c 3d6d  min_dis2start<=m
-00014190: 696e 5f64 6973 326c 6173 7420 616e 6420  in_dis2last and 
-000141a0: 2864 6972 6563 7469 6f6e 5f73 3c30 206f  (direction_s<0 o
-000141b0: 7220 6d69 6e5f 6469 7332 7374 6172 743c  r min_dis2start<
-000141c0: 3d63 7269 5f62 7265 616b 2a6c 7329 2061  =cri_break*ls) a
-000141d0: 6e64 206e 6f74 2066 6978 5f73 7461 7274  nd not fix_start
-000141e0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-000141f0: 2041 6464 2062 6566 6f72 6520 7468 6520   Add before the 
-00014200: 7374 6172 7420 706f 696e 7420 696e 2074  start point in t
-00014210: 6865 206f 7070 6f73 6974 6520 6f66 2074  he opposite of t
-00014220: 6865 2061 7665 7261 6765 2064 6972 6563  he average direc
-00014230: 7469 6f6e 0d0a 2020 2020 2020 2020 2020  tion..          
-00014240: 2020 6e65 775f 6375 7276 6520 3d20 5b70    new_curve = [p
-00014250: 6f69 6e74 735b 695f 735d 5d20 2b20 6e65  oints[i_s]] + ne
-00014260: 775f 6375 7276 650d 0a20 2020 2020 2020  w_curve..       
-00014270: 2020 2020 2070 6f69 6e74 732e 706f 7028       points.pop(
-00014280: 695f 7329 0d0a 2020 2020 2020 2020 2020  i_s)..          
-00014290: 2020 636f 6e74 696e 7565 0d0a 2020 2020    continue..    
-000142a0: 2020 2020 0d0a 2020 2020 2020 2020 6372      ..        cr
-000142b0: 695f 6272 6561 6b20 3d20 6372 695f 6272  i_break = cri_br
-000142c0: 6561 6b20 2a20 312e 310d 0a20 2020 2020  eak * 1.1..     
-000142d0: 2020 200d 0a20 2020 206e 6577 5f63 7572     ..    new_cur
-000142e0: 7665 203d 206e 702e 6172 7261 7928 6e65  ve = np.array(ne
-000142f0: 775f 6375 7276 6529 0d0a 2020 2020 6f6c  w_curve)..    ol
-00014300: 645f 696e 6465 7820 3d20 6e65 775f 6375  d_index = new_cu
-00014310: 7276 655b 3a2c 325d 2e61 7374 7970 6528  rve[:,2].astype(
-00014320: 696e 7429 0d0a 0d0a 2020 2020 7265 7475  int)....    retu
-00014330: 726e 206e 6577 5f63 7572 7665 5b3a 2c3a  rn new_curve[:,:
-00014340: 325d 2c20 6f6c 645f 696e 6465 782e 746f  2], old_index.to
-00014350: 6c69 7374 2829 0d0a 0d0a 6465 6620 6a6f  list()....def jo
-00014360: 696e 5f63 7572 7665 7328 6375 7276 6573  in_curves(curves
-00014370: 3a20 6c69 7374 2c20 6372 695f 6475 703d  : list, cri_dup=
-00014380: 3165 2d36 2920 2d3e 206e 702e 6e64 6172  1e-6) -> np.ndar
-00014390: 7261 793a 0d0a 2020 2020 2727 270d 0a20  ray:..    '''.. 
-000143a0: 2020 204a 6f69 6e20 7365 7665 7261 6c20     Join several 
-000143b0: 6375 7276 6573 2069 6e74 6f20 6f6e 6520  curves into one 
-000143c0: 7069 6563 652e 0d0a 2020 2020 0d0a 2020  piece...    ..  
-000143d0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-000143e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20    -----------.. 
-000143f0: 2020 2063 7572 7665 7320 3a20 6c69 7374     curves : list
-00014400: 206f 6620 6e64 6172 7261 7920 5b3a 2c33   of ndarray [:,3
-00014410: 206f 7220 332b 6e76 5d0d 0a20 2020 2020   or 3+nv]..     
-00014420: 2020 2063 6f6f 7264 696e 6174 6573 2061     coordinates a
-00014430: 6e64 2064 6174 6120 6f66 2074 6865 2063  nd data of the c
-00014440: 7572 7665 732e 0d0a 2020 2020 6372 695f  urves...    cri_
-00014450: 6475 7020 3a20 666c 6f61 740d 0a20 2020  dup : float..   
-00014460: 2020 2020 2063 7269 7469 6361 6c20 6469       critical di
-00014470: 7374 616e 6365 2074 6f20 6472 6f70 2064  stance to drop d
-00014480: 7570 6c69 6361 7465 6420 706f 696e 7473  uplicated points
-00014490: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
-000144a0: 2052 6574 7572 6e73 0d0a 2020 2020 2d2d   Returns..    --
-000144b0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 6e65  --------..    ne
-000144c0: 775f 6375 7276 6520 3a20 6e64 6172 7261  w_curve : ndarra
-000144d0: 7920 5b3a 2c33 206f 7220 332b 6e76 5d0d  y [:,3 or 3+nv].
-000144e0: 0a20 2020 2020 2020 206e 6577 2063 7572  .        new cur
-000144f0: 7665 0d0a 2020 2020 0d0a 2020 2020 4578  ve..    ..    Ex
-00014500: 616d 706c 6573 0d0a 2020 2020 2d2d 2d2d  amples..    ----
-00014510: 2d2d 2d2d 2d2d 0d0a 2020 2020 3e3e 3e20  ------..    >>> 
-00014520: 6e65 775f 6375 7276 6520 3d20 6a6f 696e  new_curve = join
-00014530: 5f63 7572 7665 7328 6375 7276 6573 3a20  _curves(curves: 
-00014540: 6c69 7374 2c20 6372 695f 6475 703d 3165  list, cri_dup=1e
-00014550: 2d36 290d 0a20 2020 200d 0a20 2020 2027  -6)..    ..    '
-00014560: 2727 0d0a 2020 2020 6e65 775f 6375 7276  ''..    new_curv
-00014570: 6520 3d20 6375 7276 6573 5b30 5d2e 636f  e = curves[0].co
-00014580: 7079 2829 2020 2020 2320 5b3a 2c33 5d0d  py()    # [:,3].
-00014590: 0a20 2020 200d 0a20 2020 2063 7572 7665  .    ..    curve
-000145a0: 7320 3d20 636f 7079 2e64 6565 7063 6f70  s = copy.deepcop
-000145b0: 7928 6375 7276 6573 290d 0a20 2020 2063  y(curves)..    c
-000145c0: 7572 7665 732e 706f 7028 3029 0d0a 2020  urves.pop(0)..  
-000145d0: 2020 0d0a 2020 2020 7768 696c 6520 6c65    ..    while le
-000145e0: 6e28 6375 7276 6573 293e 303a 0d0a 2020  n(curves)>0:..  
-000145f0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00014600: 6430 3020 3d20 5b5d 0d0a 2020 2020 2020  d00 = []..      
-00014610: 2020 6430 3120 3d20 5b5d 0d0a 2020 2020    d01 = []..    
-00014620: 2020 2020 6431 3020 3d20 5b5d 0d0a 2020      d10 = []..  
-00014630: 2020 2020 2020 6431 3120 3d20 5b5d 0d0a        d11 = []..
-00014640: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00014650: 2020 666f 7220 6375 7220 696e 2063 7572    for cur in cur
-00014660: 7665 733a 0d0a 2020 2020 2020 2020 2020  ves:..          
-00014670: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00014680: 6430 302e 6170 7065 6e64 286e 702e 6c69  d00.append(np.li
-00014690: 6e61 6c67 2e6e 6f72 6d28 6e65 775f 6375  nalg.norm(new_cu
-000146a0: 7276 655b 2030 2c3a 335d 2d63 7572 5b20  rve[ 0,:3]-cur[ 
-000146b0: 302c 3a33 5d29 290d 0a20 2020 2020 2020  0,:3]))..       
-000146c0: 2020 2020 2064 3031 2e61 7070 656e 6428       d01.append(
-000146d0: 6e70 2e6c 696e 616c 672e 6e6f 726d 286e  np.linalg.norm(n
-000146e0: 6577 5f63 7572 7665 5b20 302c 3a33 5d2d  ew_curve[ 0,:3]-
-000146f0: 6375 725b 2d31 2c3a 335d 2929 0d0a 2020  cur[-1,:3]))..  
-00014700: 2020 2020 2020 2020 2020 6431 302e 6170            d10.ap
-00014710: 7065 6e64 286e 702e 6c69 6e61 6c67 2e6e  pend(np.linalg.n
-00014720: 6f72 6d28 6e65 775f 6375 7276 655b 2d31  orm(new_curve[-1
-00014730: 2c3a 335d 2d63 7572 5b20 302c 3a33 5d29  ,:3]-cur[ 0,:3])
-00014740: 290d 0a20 2020 2020 2020 2020 2020 2064  )..            d
-00014750: 3131 2e61 7070 656e 6428 6e70 2e6c 696e  11.append(np.lin
-00014760: 616c 672e 6e6f 726d 286e 6577 5f63 7572  alg.norm(new_cur
-00014770: 7665 5b2d 312c 3a33 5d2d 6375 725b 2d31  ve[-1,:3]-cur[-1
-00014780: 2c3a 335d 2929 0d0a 2020 2020 2020 2020  ,:3]))..        
-00014790: 2020 2020 0d0a 2020 2020 2020 2020 6d69      ..        mi
-000147a0: 6e5f 6473 203d 205b 6e70 2e6d 696e 2864  n_ds = [np.min(d
-000147b0: 3030 292c 206e 702e 6d69 6e28 6430 3129  00), np.min(d01)
-000147c0: 2c20 6e70 2e6d 696e 2864 3130 292c 206e  , np.min(d10), n
-000147d0: 702e 6d69 6e28 6431 3129 5d0d 0a20 2020  p.min(d11)]..   
-000147e0: 2020 2020 2069 695f 6d69 6e20 3d20 6e70       ii_min = np
-000147f0: 2e61 7267 6d69 6e28 6d69 6e5f 6473 290d  .argmin(min_ds).
-00014800: 0a0d 0a20 2020 2020 2020 2069 6620 6969  ...        if ii
-00014810: 5f6d 696e 203d 3d20 303a 0d0a 2020 2020  _min == 0:..    
-00014820: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00014830: 2020 2020 2020 6a6a 5f6d 696e 2020 2020        jj_min    
-00014840: 3d20 6e70 2e61 7267 6d69 6e28 6430 3029  = np.argmin(d00)
-00014850: 0d0a 2020 2020 2020 2020 2020 2020 6164  ..            ad
-00014860: 645f 6375 7276 6520 3d20 6375 7276 6573  d_curve = curves
-00014870: 5b6a 6a5f 6d69 6e5d 2e63 6f70 7928 290d  [jj_min].copy().
-00014880: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
-00014890: 5f63 7572 7665 203d 206e 702e 666c 6970  _curve = np.flip
-000148a0: 286e 6577 5f63 7572 7665 2c20 6178 6973  (new_curve, axis
-000148b0: 3d30 290d 0a20 2020 2020 2020 2020 2020  =0)..           
-000148c0: 200d 0a20 2020 2020 2020 2065 6c69 6620   ..        elif 
-000148d0: 6969 5f6d 696e 203d 3d20 313a 0d0a 2020  ii_min == 1:..  
-000148e0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-000148f0: 2020 2020 2020 2020 6a6a 5f6d 696e 2020          jj_min  
-00014900: 2020 3d20 6e70 2e61 7267 6d69 6e28 6430    = np.argmin(d0
-00014910: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-00014920: 6164 645f 6375 7276 6520 3d20 6375 7276  add_curve = curv
-00014930: 6573 5b6a 6a5f 6d69 6e5d 2e63 6f70 7928  es[jj_min].copy(
-00014940: 290d 0a20 2020 2020 2020 2020 2020 206e  )..            n
-00014950: 6577 5f63 7572 7665 203d 206e 702e 666c  ew_curve = np.fl
-00014960: 6970 286e 6577 5f63 7572 7665 2c20 6178  ip(new_curve, ax
-00014970: 6973 3d30 290d 0a20 2020 2020 2020 2020  is=0)..         
-00014980: 2020 2061 6464 5f63 7572 7665 203d 206e     add_curve = n
-00014990: 702e 666c 6970 2861 6464 5f63 7572 7665  p.flip(add_curve
-000149a0: 2c20 6178 6973 3d30 290d 0a20 2020 2020  , axis=0)..     
-000149b0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000149c0: 2065 6c69 6620 6969 5f6d 696e 203d 3d20   elif ii_min == 
-000149d0: 323a 0d0a 2020 2020 2020 2020 2020 2020  2:..            
-000149e0: 0d0a 2020 2020 2020 2020 2020 2020 6a6a  ..            jj
-000149f0: 5f6d 696e 2020 2020 3d20 6e70 2e61 7267  _min    = np.arg
-00014a00: 6d69 6e28 6431 3029 0d0a 2020 2020 2020  min(d10)..      
-00014a10: 2020 2020 2020 6164 645f 6375 7276 6520        add_curve 
-00014a20: 3d20 6375 7276 6573 5b6a 6a5f 6d69 6e5d  = curves[jj_min]
-00014a30: 2e63 6f70 7928 290d 0a20 2020 2020 2020  .copy()..       
-00014a40: 2020 2020 200d 0a20 2020 2020 2020 2065       ..        e
-00014a50: 6c69 6620 6969 5f6d 696e 203d 3d20 333a  lif ii_min == 3:
-00014a60: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00014a70: 2020 2020 2020 2020 2020 2020 6a6a 5f6d              jj_m
-00014a80: 696e 2020 2020 3d20 6e70 2e61 7267 6d69  in    = np.argmi
-00014a90: 6e28 6431 3129 0d0a 2020 2020 2020 2020  n(d11)..        
-00014aa0: 2020 2020 6164 645f 6375 7276 6520 3d20      add_curve = 
-00014ab0: 6375 7276 6573 5b6a 6a5f 6d69 6e5d 2e63  curves[jj_min].c
-00014ac0: 6f70 7928 290d 0a20 2020 2020 2020 2020  opy()..         
-00014ad0: 2020 2061 6464 5f63 7572 7665 203d 206e     add_curve = n
-00014ae0: 702e 666c 6970 2861 6464 5f63 7572 7665  p.flip(add_curve
-00014af0: 2c20 6178 6973 3d30 290d 0a20 2020 2020  , axis=0)..     
-00014b00: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00014b10: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00014b20: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
-00014b30: 696f 6e28 290d 0a20 2020 2020 2020 200d  ion()..        .
-00014b40: 0a20 2020 2020 2020 2069 6620 6e70 2e6d  .        if np.m
-00014b50: 696e 286d 696e 5f64 7329 3c63 7269 5f64  in(min_ds)<cri_d
-00014b60: 7570 3a0d 0a20 2020 2020 2020 2020 2020  up:..           
-00014b70: 206e 6577 5f63 7572 7665 203d 206e 702e   new_curve = np.
-00014b80: 636f 6e63 6174 656e 6174 6528 286e 6577  concatenate((new
-00014b90: 5f63 7572 7665 2c20 6164 645f 6375 7276  _curve, add_curv
-00014ba0: 655b 313a 2c3a 5d29 2c61 7869 733d 3029  e[1:,:]),axis=0)
-00014bb0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00014bc0: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
-00014bd0: 5f63 7572 7665 203d 206e 702e 636f 6e63  _curve = np.conc
-00014be0: 6174 656e 6174 6528 286e 6577 5f63 7572  atenate((new_cur
-00014bf0: 7665 2c20 6164 645f 6375 7276 6529 2c61  ve, add_curve),a
-00014c00: 7869 733d 3029 0d0a 0d0a 2020 2020 2020  xis=0)....      
-00014c10: 2020 6375 7276 6573 2e70 6f70 286a 6a5f    curves.pop(jj_
-00014c20: 6d69 6e29 0d0a 2020 2020 2020 2020 0d0a  min)..        ..
-00014c30: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-00014c40: 7572 7665 0d0a 0d0a 6465 6620 7265 636f  urve....def reco
-00014c50: 6e73 7472 7563 745f 6375 7276 655f 6279  nstruct_curve_by
-00014c60: 5f6c 656e 6774 6828 6375 7276 653a 206e  _length(curve: n
-00014c70: 702e 6e64 6172 7261 792c 206e 3a69 6e74  p.ndarray, n:int
-00014c80: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
-00014c90: 0d0a 2020 2020 2727 270d 0a20 2020 2052  ..    '''..    R
-00014ca0: 6563 6f6e 7374 7275 6374 2074 6865 2063  econstruct the c
-00014cb0: 7572 7665 2077 6974 6820 6571 7569 6469  urve with equidi
-00014cc0: 7374 616e 7420 706f 696e 7473 2e0d 0a20  stant points... 
-00014cd0: 2020 200d 0a20 2020 2050 6172 616d 6574     ..    Paramet
-00014ce0: 6572 730d 0a20 2020 202d 2d2d 2d2d 2d2d  ers..    -------
-00014cf0: 2d2d 2d0d 0a20 2020 2063 7572 7665 203a  ---..    curve :
-00014d00: 206e 6461 7272 6179 205b 3a2c 335d 0d0a   ndarray [:,3]..
-00014d10: 2020 2020 2020 2020 636f 6f72 6469 6e61          coordina
-00014d20: 7465 7320 6f66 2074 6865 2063 7572 7665  tes of the curve
-00014d30: 0d0a 2020 2020 6e20 3a20 696e 740d 0a20  ..    n : int.. 
-00014d40: 2020 2020 2020 206e 756d 6265 7220 6f66         number of
-00014d50: 2070 6f69 6e74 730d 0a20 2020 200d 0a20   points..    .. 
-00014d60: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-00014d70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  -------------.. 
-00014d80: 2020 206e 6577 5f63 7572 7665 203a 206e     new_curve : n
-00014d90: 6461 7272 6179 205b 6e2c 335d 0d0a 2020  darray [n,3]..  
-00014da0: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
-00014db0: 7320 6f66 2074 6865 206e 6577 2063 7572  s of the new cur
-00014dc0: 7665 0d0a 2020 2020 2727 270d 0a20 2020  ve..    '''..   
-00014dd0: 200d 0a20 2020 2023 2a20 5061 7261 6d65   ..    #* Parame
-00014de0: 7472 6963 2063 7572 7665 3a20 7828 7429  tric curve: x(t)
-00014df0: 2c20 7928 7429 2c20 7a28 7429 2c20 7420  , y(t), z(t), t 
-00014e00: 696e 205b 302c 315d 0d0a 2020 2020 6e30  in [0,1]..    n0
-00014e10: 203d 2063 7572 7665 2e73 6861 7065 5b30   = curve.shape[0
-00014e20: 5d0d 0a20 2020 206c 3020 3d20 302e 300d  ]..    l0 = 0.0.
-00014e30: 0a20 2020 2074 7420 3d20 6e70 2e7a 6572  .    tt = np.zer
-00014e40: 6f73 286e 3029 0d0a 2020 2020 666f 7220  os(n0)..    for 
-00014e50: 6920 696e 2072 616e 6765 286e 302d 3129  i in range(n0-1)
-00014e60: 3a0d 0a20 2020 2020 2020 206c 3020 2b3d  :..        l0 +=
-00014e70: 206e 702e 6c69 6e61 6c67 2e6e 6f72 6d28   np.linalg.norm(
-00014e80: 6375 7276 655b 692b 312c 3a5d 2d63 7572  curve[i+1,:]-cur
-00014e90: 7665 5b69 2c3a 5d29 0d0a 2020 2020 2020  ve[i,:])..      
-00014ea0: 2020 7474 5b69 2b31 5d20 3d20 6c30 0d0a    tt[i+1] = l0..
-00014eb0: 2020 2020 7474 203d 2074 742f 6c30 0d0a      tt = tt/l0..
-00014ec0: 2020 2020 0d0a 2020 2020 232a 2052 6563      ..    #* Rec
-00014ed0: 6f6e 7374 7275 6374 696f 6e0d 0a20 2020  onstruction..   
-00014ee0: 2066 7820 3d20 696e 7465 7270 3164 2874   fx = interp1d(t
-00014ef0: 742c 2063 7572 7665 5b3a 2c30 5d2c 206b  t, curve[:,0], k
-00014f00: 696e 643d 2763 7562 6963 2729 0d0a 2020  ind='cubic')..  
-00014f10: 2020 6679 203d 2069 6e74 6572 7031 6428    fy = interp1d(
-00014f20: 7474 2c20 6375 7276 655b 3a2c 315d 2c20  tt, curve[:,1], 
-00014f30: 6b69 6e64 3d27 6375 6269 6327 290d 0a20  kind='cubic').. 
-00014f40: 2020 2066 7a20 3d20 696e 7465 7270 3164     fz = interp1d
-00014f50: 2874 742c 2063 7572 7665 5b3a 2c32 5d2c  (tt, curve[:,2],
-00014f60: 206b 696e 643d 2763 7562 6963 2729 0d0a   kind='cubic')..
-00014f70: 0d0a 2020 2020 6e65 775f 6375 7276 6520  ..    new_curve 
-00014f80: 3d20 6e70 2e7a 6572 6f73 2828 6e2c 3329  = np.zeros((n,3)
-00014f90: 290d 0a20 2020 200d 0a20 2020 2066 6f72  )..    ..    for
-00014fa0: 2069 2069 6e20 7261 6e67 6528 6e29 3a0d   i in range(n):.
-00014fb0: 0a20 2020 2020 2020 2074 203d 2069 2f28  .        t = i/(
-00014fc0: 6e2d 312e 3029 0d0a 2020 2020 2020 2020  n-1.0)..        
-00014fd0: 6e65 775f 6375 7276 655b 692c 305d 203d  new_curve[i,0] =
-00014fe0: 2066 7828 7429 0d0a 2020 2020 2020 2020   fx(t)..        
-00014ff0: 6e65 775f 6375 7276 655b 692c 315d 203d  new_curve[i,1] =
-00015000: 2066 7928 7429 0d0a 2020 2020 2020 2020   fy(t)..        
-00015010: 6e65 775f 6375 7276 655b 692c 325d 203d  new_curve[i,2] =
-00015020: 2066 7a28 7429 0d0a 2020 2020 2020 2020   fz(t)..        
-00015030: 0d0a 2020 2020 7265 7475 726e 206e 6577  ..    return new
-00015040: 5f63 7572 7665 0d0a 2020 2020 0d0a 6465  _curve..    ..de
-00015050: 6620 6578 7472 6163 745f 736c 6963 6528  f extract_slice(
-00015060: 6c6f 6361 7469 6f6e 733a 206c 6973 742c  locations: list,
-00015070: 2050 7265 663a 206e 702e 6e64 6172 7261   Pref: np.ndarra
-00015080: 792c 2064 6972 5f6e 6f72 6d3a 206e 702e  y, dir_norm: np.
-00015090: 6e64 6172 7261 792c 2064 6972 5f72 6566  ndarray, dir_ref
-000150a0: 3d6e 702e 6172 7261 7928 5b31 2e2c 302e  =np.array([1.,0.
-000150b0: 2c30 2e5d 292c 0d0a 2020 2020 2020 2020  ,0.]),..        
-000150c0: 2020 2020 2020 2020 2020 2020 666e 616d              fnam
-000150d0: 653d 2773 7572 6661 6365 2d61 6972 6372  e='surface-aircr
-000150e0: 6166 742e 6461 7427 2c20 7a6f 6e65 5f69  aft.dat', zone_i
-000150f0: 643d 5b5d 2c20 696e 6465 785f 7879 7a3d  d=[], index_xyz=
-00015100: 5b30 2c31 2c32 5d2c 2061 7272 616e 6765  [0,1,2], arrange
-00015110: 5f6d 6574 686f 643d 276a 6f69 6e27 293a  _method='join'):
-00015120: 0d0a 2020 2020 2727 270d 0a20 2020 2045  ..    '''..    E
-00015130: 7874 7261 6374 2064 6174 6120 736c 6963  xtract data slic
-00015140: 6564 2062 7920 706c 616e 6573 2e0d 0a20  ed by planes... 
-00015150: 2020 200d 0a20 2020 2050 6172 616d 6574     ..    Paramet
-00015160: 6572 730d 0a20 2020 202d 2d2d 2d2d 2d2d  ers..    -------
-00015170: 2d2d 2d2d 2d2d 2d0d 0a20 2020 206c 6f63  -------..    loc
-00015180: 6174 696f 6e73 203a 206c 6973 7420 6f66  ations : list of
-00015190: 2066 6c6f 6174 0d0a 2020 2020 2020 2020   float..        
-000151a0: 6c69 7374 206f 6620 6469 7374 616e 6365  list of distance
-000151b0: 7320 746f 2074 6865 2072 6566 6572 656e  s to the referen
-000151c0: 6365 2070 6f69 6e74 2069 6e20 7468 6520  ce point in the 
-000151d0: 6769 7665 6e20 6469 7265 6374 696f 6e2e  given direction.
-000151e0: 0d0a 2020 2020 5072 6566 203a 206e 6461  ..    Pref : nda
-000151f0: 7272 6179 205b 335d 0d0a 2020 2020 2020  rray [3]..      
-00015200: 2020 636f 6f72 6469 6e61 7465 7320 6f66    coordinates of
-00015210: 2074 6865 2072 6566 6572 656e 6365 2070   the reference p
-00015220: 6f69 6e74 2e0d 0a20 2020 2064 6972 5f6e  oint...    dir_n
-00015230: 6f72 6d20 3a20 6e64 6172 7261 7920 5b33  orm : ndarray [3
-00015240: 5d0d 0a20 2020 2020 2020 2064 6972 6563  ]..        direc
-00015250: 7469 6f6e 2076 6563 746f 7220 6e6f 726d  tion vector norm
-00015260: 616c 2074 6f20 7468 6520 736c 6963 6520  al to the slice 
-00015270: 706c 616e 6520 2877 696c 6c20 6265 206e  plane (will be n
-00015280: 6f72 6d61 6c69 7a65 6429 2e0d 0a20 2020  ormalized)...   
-00015290: 2064 6972 5f72 6566 203a 206e 6461 7272   dir_ref : ndarr
-000152a0: 6179 205b 335d 0d0a 2020 2020 2020 2020  ay [3]..        
-000152b0: 6469 7265 6374 696f 6e20 7665 6374 6f72  direction vector
-000152c0: 2074 6861 7420 726f 7567 686c 7920 7365   that roughly se
-000152d0: 7473 2074 6865 2078 692d 6178 6973 2069  ts the xi-axis i
-000152e0: 6e20 7468 6520 736c 6963 6520 706c 616e  n the slice plan
-000152f0: 652e 0d0a 2020 2020 666e 616d 6520 3a20  e...    fname : 
-00015300: 7374 720d 0a20 2020 2020 2020 2066 696c  str..        fil
-00015310: 6520 6e61 6d65 2e0d 0a20 2020 207a 6f6e  e name...    zon
-00015320: 655f 6964 203a 206c 6973 7420 6f66 2069  e_id : list of i
-00015330: 6e74 0d0a 2020 2020 2020 2020 696e 6465  nt..        inde
-00015340: 7820 6f66 207a 6f6e 6573 2069 6e20 7468  x of zones in th
-00015350: 6520 7465 6370 6c6f 7420 666f 726d 6174  e tecplot format
-00015360: 2066 696c 652c 2073 7461 7274 2066 726f   file, start fro
-00015370: 6d20 302e 0d0a 2020 2020 696e 6465 785f  m 0...    index_
-00015380: 7879 7a20 3a20 6c69 7374 206f 6620 696e  xyz : list of in
-00015390: 7420 0d0a 2020 2020 2020 2020 696e 6465  t ..        inde
-000153a0: 7820 6f66 2076 6172 6961 626c 6573 2069  x of variables i
-000153b0: 6e20 6669 6c65 2066 6f72 2058 2c20 5920  n file for X, Y 
-000153c0: 616e 6420 5a2e 0d0a 2020 2020 6172 7261  and Z...    arra
-000153d0: 6e67 655f 6d65 7468 6f64 203a 2073 7472  nge_method : str
-000153e0: 0d0a 2020 2020 2020 2020 6966 2027 6a6f  ..        if 'jo
-000153f0: 696e 272c 206b 6565 7073 2074 6865 206f  in', keeps the o
-00015400: 7269 6769 6e61 6c20 6f72 6465 7220 6f66  riginal order of
-00015410: 2070 6f69 6e74 7320 2873 7569 7461 626c   points (suitabl
-00015420: 6520 666f 7220 7375 7266 6163 6520 7769  e for surface wi
-00015430: 7468 2061 2066 6577 2062 6c6f 636b 7329  th a few blocks)
-00015440: 2e0d 0a20 2020 2020 2020 2049 6620 2772  ...        If 'r
-00015450: 6561 7272 616e 6765 272c 2072 6561 7272  earrange', rearr
-00015460: 616e 6765 2070 6f69 6e74 7320 6279 206d  ange points by m
-00015470: 696e 696d 616c 2064 6973 7461 6e63 652e  inimal distance.
-00015480: 0d0a 2020 2020 0d0a 2020 2020 5265 7475  ..    ..    Retu
-00015490: 726e 730d 0a20 2020 202d 2d2d 2d2d 2d2d  rns..    -------
-000154a0: 2d2d 2d2d 2d0d 0a20 2020 2073 6563 7469  -----..    secti
-000154b0: 6f6e 7320 3a20 6c69 7374 206f 6620 6e64  ons : list of nd
-000154c0: 6172 7261 7920 5b3a 2c33 2b6e 765d 0d0a  array [:,3+nv]..
-000154d0: 2020 2020 2020 2020 636f 6f72 6469 6e61          coordina
-000154e0: 7465 7320 616e 6420 6461 7461 206f 6e20  tes and data on 
-000154f0: 7468 6520 736c 6963 652e 0d0a 2020 2020  the slice...    
-00015500: 6e61 6d65 5f76 6172 203a 206c 6973 7420  name_var : list 
-00015510: 6f72 2073 7472 0d0a 2020 2020 2020 2020  or str..        
-00015520: 6e61 6d65 206f 6620 7661 7269 6162 6c65  name of variable
-00015530: 730d 0a20 2020 200d 0a20 2020 2045 7861  s..    ..    Exa
-00015540: 6d70 6c65 730d 0a20 2020 202d 2d2d 2d2d  mples..    -----
-00015550: 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e 2073  -----..    >>> s
-00015560: 6563 7469 6f6e 732c 206e 616d 655f 7661  ections, name_va
-00015570: 7220 3d20 6578 7472 6163 745f 736c 6963  r = extract_slic
-00015580: 6528 6c6f 6361 7469 6f6e 732c 2050 7265  e(locations, Pre
-00015590: 662c 2064 6972 5f6e 6f72 6d2c 2064 6972  f, dir_norm, dir
-000155a0: 5f72 6566 3d6e 702e 6172 7261 7928 5b31  _ref=np.array([1
-000155b0: 2e2c 302e 2c30 2e5d 292c 0d0a 2020 2020  .,0.,0.]),..    
-000155c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000155d0: 666e 616d 653d 2773 7572 6661 6365 2d61  fname='surface-a
-000155e0: 6972 6372 6166 742e 6461 7427 2c20 7a6f  ircraft.dat', zo
-000155f0: 6e65 5f69 643d 5b5d 2c20 696e 6465 785f  ne_id=[], index_
-00015600: 7879 7a3d 5b30 2c31 2c32 5d2c 2061 7272  xyz=[0,1,2], arr
-00015610: 616e 6765 5f6d 6574 686f 643d 276a 6f69  ange_method='joi
-00015620: 6e27 290d 0a20 2020 2027 2727 0d0a 2020  n')..    '''..  
-00015630: 2020 232a 2052 6561 6420 7375 7266 6163    #* Read surfac
-00015640: 6520 6461 7461 0d0a 2020 2020 6461 7461  e data..    data
-00015650: 5f2c 206e 616d 655f 7661 722c 205f 203d  _, name_var, _ =
-00015660: 2072 6561 645f 7465 6370 6c6f 7428 666e   read_tecplot(fn
-00015670: 616d 6529 0d0a 2020 2020 696e 6465 785f  ame)..    index_
-00015680: 7661 7220 3d20 5b69 2066 6f72 2069 2069  var = [i for i i
-00015690: 6e20 7261 6e67 6528 6c65 6e28 6e61 6d65  n range(len(name
-000156a0: 5f76 6172 2929 5d0d 0a20 2020 2066 6f72  _var))]..    for
-000156b0: 2069 2069 6e20 696e 6465 785f 7879 7a3a   i in index_xyz:
-000156c0: 0d0a 2020 2020 2020 2020 696e 6465 785f  ..        index_
-000156d0: 7661 722e 7265 6d6f 7665 2869 290d 0a20  var.remove(i).. 
-000156e0: 2020 200d 0a20 2020 2069 6620 6c65 6e28     ..    if len(
-000156f0: 7a6f 6e65 5f69 6429 3d3d 303a 0d0a 2020  zone_id)==0:..  
-00015700: 2020 2020 2020 6461 7461 203d 2064 6174        data = dat
-00015710: 615f 0d0a 2020 2020 656c 7365 3a0d 0a20  a_..    else:.. 
-00015720: 2020 2020 2020 2064 6174 6120 3d20 5b64         data = [d
-00015730: 6174 615f 5b69 5d20 666f 7220 6920 696e  ata_[i] for i in
-00015740: 207a 6f6e 655f 6964 5d0d 0a20 2020 200d   zone_id]..    .
-00015750: 0a20 2020 2023 2a20 496e 7465 7273 6563  .    #* Intersec
-00015760: 7420 7365 6374 696f 6e73 0d0a 2020 2020  t sections..    
-00015770: 646e 203d 2064 6972 5f6e 6f72 6d2f 6e70  dn = dir_norm/np
-00015780: 2e6c 696e 616c 672e 6e6f 726d 2864 6972  .linalg.norm(dir
-00015790: 5f6e 6f72 6d29 0d0a 2020 2020 6472 203d  _norm)..    dr =
-000157a0: 2064 6972 5f72 6566 202d 206e 702e 646f   dir_ref - np.do
-000157b0: 7428 6469 725f 7265 662c 2064 6e29 2a64  t(dir_ref, dn)*d
-000157c0: 6e0d 0a20 2020 2064 7220 3d20 6472 2f6e  n..    dr = dr/n
-000157d0: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 6469  p.linalg.norm(di
-000157e0: 725f 6e6f 726d 290d 0a20 2020 2064 7420  r_norm)..    dt 
-000157f0: 3d20 6e70 2e63 726f 7373 2864 6e2c 2064  = np.cross(dn, d
-00015800: 7229 0d0a 2020 2020 6474 203d 2064 742f  r)..    dt = dt/
-00015810: 6e70 2e6c 696e 616c 672e 6e6f 726d 2864  np.linalg.norm(d
-00015820: 7429 0d0a 2020 2020 0d0a 2020 2020 7365  t)..    ..    se
-00015830: 6374 696f 6e73 203d 205b 5d0d 0a0d 0a20  ctions = [].... 
-00015840: 2020 2066 6f72 206c 6f63 2069 6e20 6c6f     for loc in lo
-00015850: 6361 7469 6f6e 733a 0d0a 2020 2020 2020  cations:..      
-00015860: 2020 0d0a 2020 2020 2020 2020 5030 203d    ..        P0 =
-00015870: 2050 7265 6620 2b20 6c6f 632a 646e 0d0a   Pref + loc*dn..
-00015880: 2020 2020 2020 2020 5031 203d 2050 3020          P1 = P0 
-00015890: 2b20 6472 0d0a 2020 2020 2020 2020 5033  + dr..        P3
-000158a0: 203d 2050 3020 2b20 6474 0d0a 2020 2020   = P0 + dt..    
-000158b0: 2020 2020 0d0a 2020 2020 2020 2020 6375      ..        cu
-000158c0: 7276 6573 203d 205b 5d0d 0a20 2020 2020  rves = []..     
-000158d0: 2020 2078 695f 6375 7276 6573 203d 205b     xi_curves = [
-000158e0: 5d0d 0a20 2020 2020 2020 2079 745f 6375  ]..        yt_cu
-000158f0: 7276 6573 203d 205b 5d0d 0a20 2020 2020  rves = []..     
-00015900: 2020 200d 0a20 2020 2020 2020 2066 6f72     ..        for
-00015910: 2064 6174 615f 2069 6e20 6461 7461 3a0d   data_ in data:.
-00015920: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00015930: 2020 2020 2020 2020 2020 2073 7572 6661             surfa
-00015940: 6365 203d 206e 702e 636f 6e63 6174 656e  ce = np.concaten
-00015950: 6174 6528 2864 6174 615f 5b3a 2c3a 2c3a  ate((data_[:,:,:
-00015960: 2c69 6e64 6578 5f78 797a 5b30 5d3a 696e  ,index_xyz[0]:in
-00015970: 6465 785f 7879 7a5b 305d 2b31 5d2c 0d0a  dex_xyz[0]+1],..
+00012fe0: 636f 6e74 696e 7565 0d0a 0d0a 2020 2020  continue....    
+00012ff0: 232a 2052 6561 7272 616e 6765 2070 6f69  #* Rearrange poi
+00013000: 6e74 7320 696e 2063 6f72 7265 6374 206f  nts in correct o
+00013010: 7264 6572 0d0a 2020 2020 7869 5f63 7572  rder..    xi_cur
+00013020: 7665 203d 206e 702e 6172 7261 7928 7869  ve = np.array(xi
+00013030: 5f63 7572 7665 290d 0a20 2020 2079 745f  _curve)..    yt_
+00013040: 6375 7276 6520 3d20 6e70 2e61 7272 6179  curve = np.array
+00013050: 2879 745f 6375 7276 6529 0d0a 2020 2020  (yt_curve)..    
+00013060: 0d0a 2020 2020 6966 206c 656e 2863 7572  ..    if len(cur
+00013070: 7665 293e 3220 616e 6420 6e6f 7420 6f72  ve)>2 and not or
+00013080: 6967 696e 616c 5f6f 7264 6572 3a0d 0a20  iginal_order:.. 
+00013090: 2020 2020 2020 205f 2c20 6f6c 645f 696e         _, old_in
+000130a0: 6465 7820 3d20 7265 6172 7261 6e67 655f  dex = rearrange_
+000130b0: 706f 696e 7473 2878 695f 6375 7276 652c  points(xi_curve,
+000130c0: 2079 745f 6375 7276 6529 0d0a 2020 2020   yt_curve)..    
+000130d0: 2020 2020 0d0a 2020 2020 2020 2020 6375      ..        cu
+000130e0: 7276 6520 2020 203d 205b 6375 7276 655b  rve    = [curve[
+000130f0: 6969 5d20 2020 2066 6f72 2069 6920 696e  ii]    for ii in
+00013100: 206f 6c64 5f69 6e64 6578 5d0d 0a20 2020   old_index]..   
+00013110: 2020 2020 2069 6a5f 6375 7276 6520 3d20       ij_curve = 
+00013120: 5b69 6a5f 6375 7276 655b 6969 5d20 666f  [ij_curve[ii] fo
+00013130: 7220 6969 2069 6e20 6f6c 645f 696e 6465  r ii in old_inde
+00013140: 785d 0d0a 2020 2020 2020 2020 7869 5f63  x]..        xi_c
+00013150: 7572 7665 203d 206e 702e 6172 7261 7928  urve = np.array(
+00013160: 5b78 695f 6375 7276 655b 6969 5d20 666f  [xi_curve[ii] fo
+00013170: 7220 6969 2069 6e20 6f6c 645f 696e 6465  r ii in old_inde
+00013180: 785d 290d 0a20 2020 2020 2020 2079 745f  x])..        yt_
+00013190: 6375 7276 6520 3d20 6e70 2e61 7272 6179  curve = np.array
+000131a0: 285b 7974 5f63 7572 7665 5b69 695d 2066  ([yt_curve[ii] f
+000131b0: 6f72 2069 6920 696e 206f 6c64 5f69 6e64  or ii in old_ind
+000131c0: 6578 5d29 0d0a 0d0a 2020 2020 7265 7475  ex])....    retu
+000131d0: 726e 2063 7572 7665 2c20 696a 5f63 7572  rn curve, ij_cur
+000131e0: 7665 2c20 7869 5f63 7572 7665 2c20 7974  ve, xi_curve, yt
+000131f0: 5f63 7572 7665 0d0a 0d0a 6465 6620 7265  _curve....def re
+00013200: 6172 7261 6e67 655f 706f 696e 7473 2878  arrange_points(x
+00013210: 693a 206e 702e 6e64 6172 7261 792c 2079  i: np.ndarray, y
+00013220: 743a 206e 702e 6e64 6172 7261 792c 2061  t: np.ndarray, a
+00013230: 7667 5f64 6972 3d4e 6f6e 652c 200d 0a20  vg_dir=None, .. 
+00013240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013250: 2020 2020 6372 695f 6272 6561 6b3d 302e      cri_break=0.
+00013260: 3032 2c20 6372 695f 6475 703d 3165 2d36  02, cri_dup=1e-6
+00013270: 2920 2d3e 2054 7570 6c65 5b6e 702e 6e64  ) -> Tuple[np.nd
+00013280: 6172 7261 792c 204c 6973 745b 696e 745d  array, List[int]
+00013290: 5d3a 0d0a 2020 2020 2727 270d 0a20 2020  ]:..    '''..   
+000132a0: 2052 6561 7272 616e 6765 2061 206c 6973   Rearrange a lis
+000132b0: 7420 6f66 2070 6f69 6e74 7320 696e 2061  t of points in a
+000132c0: 2032 4420 6375 7276 652e 0d0a 2020 2020   2D curve...    
+000132d0: 0d0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+000132e0: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
+000132f0: 0d0a 2020 2020 7869 2c20 7974 203a 206e  ..    xi, yt : n
+00013300: 6461 7272 6179 205b 6e5d 0d0a 2020 2020  darray [n]..    
+00013310: 2020 2020 3244 2063 6f6f 7264 696e 6174      2D coordinat
+00013320: 6573 206f 6620 7468 6520 706f 696e 7473  es of the points
+00013330: 2e0d 0a20 2020 2061 7667 5f64 6972 203a  ...    avg_dir :
+00013340: 204e 6f6e 6520 6f72 206e 6461 7272 6179   None or ndarray
+00013350: 205b 325d 0d0a 2020 2020 2020 2020 6966   [2]..        if
+00013360: 206e 6461 7272 6179 2c20 7370 6563 6966   ndarray, specif
+00013370: 6965 6420 6176 6572 6167 6520 6469 7265  ied average dire
+00013380: 6374 696f 6e2c 2074 6865 2073 7461 7274  ction, the start
+00013390: 2070 6f69 6e74 2069 7320 6669 7865 6420   point is fixed 
+000133a0: 666f 7220 7468 6520 6375 7276 652e 0d0a  for the curve...
+000133b0: 2020 2020 6372 695f 6272 6561 6b20 3a20      cri_break : 
+000133c0: 666c 6f61 740d 0a20 2020 2020 2020 2063  float..        c
+000133d0: 7269 7469 6361 6c20 7261 7469 6f20 746f  ritical ratio to
+000133e0: 2064 6563 6964 6520 7768 6574 6865 7220   decide whether 
+000133f0: 7468 6520 706f 696e 7420 6973 2074 6865  the point is the
+00013400: 2065 6e64 2070 6f69 6e74 206f 6620 7468   end point of th
+00013410: 6520 6375 7276 652e 0d0a 2020 2020 6372  e curve...    cr
+00013420: 695f 6475 7020 3a20 666c 6f61 740d 0a20  i_dup : float.. 
+00013430: 2020 2020 2020 2063 7269 7469 6361 6c20         critical 
+00013440: 6469 7374 616e 6365 2074 6f20 6472 6f70  distance to drop
+00013450: 2064 7570 6c69 6361 7465 6420 706f 696e   duplicated poin
+00013460: 7473 2e0d 0a20 2020 200d 0a20 2020 2052  ts...    ..    R
+00013470: 6574 7572 6e73 0d0a 2020 2020 2d2d 2d2d  eturns..    ----
+00013480: 2d2d 2d2d 2d2d 0d0a 2020 2020 6e65 775f  ------..    new_
+00013490: 6375 7276 6520 3a20 6e64 6172 7261 7920  curve : ndarray 
+000134a0: 5b6e 2c32 5d0d 0a20 2020 2020 2020 206e  [n,2]..        n
+000134b0: 6577 2063 7572 7665 2e0d 0a20 2020 206f  ew curve...    o
+000134c0: 6c64 5f69 6e64 6578 203a 206c 6973 7420  ld_index : list 
+000134d0: 6f66 2069 6e74 0d0a 2020 2020 2020 2020  of int..        
+000134e0: 7468 6520 696e 6465 7820 6f66 2070 6f69  the index of poi
+000134f0: 6e74 2069 6e20 7468 6520 6f72 6967 696e  nt in the origin
+00013500: 616c 2063 7572 7665 2e0d 0a20 2020 200d  al curve...    .
+00013510: 0a20 2020 2045 7861 6d70 6c65 730d 0a20  .    Examples.. 
+00013520: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00013530: 2020 203e 3e3e 206e 6577 5f63 7572 7665     >>> new_curve
+00013540: 2c20 6f6c 645f 696e 6465 7820 3d20 7265  , old_index = re
+00013550: 6172 7261 6e67 655f 706f 696e 7473 2878  arrange_points(x
+00013560: 692c 2079 742c 2061 7667 5f64 6972 3d4e  i, yt, avg_dir=N
+00013570: 6f6e 652c 2063 7269 5f62 7265 616b 3d30  one, cri_break=0
+00013580: 2e31 290d 0a20 2020 200d 0a20 2020 204e  .1)..    ..    N
+00013590: 6f74 6573 0d0a 2020 2020 2d2d 2d2d 2d2d  otes..    ------
+000135a0: 2d0d 0a20 2020 2054 6865 7265 2061 7265  -..    There are
+000135b0: 2061 2066 6577 2061 7373 756d 7074 696f   a few assumptio
+000135c0: 6e73 3a20 0d0a 2020 2020 0d0a 2020 2020  ns: ..    ..    
+000135d0: 312e 2069 7420 6973 2061 6e20 6f70 656e  1. it is an open
+000135e0: 2063 7572 7665 2077 6974 6820 6e6f 2069   curve with no i
+000135f0: 6e74 6572 7365 6374 696f 6e73 0d0a 2020  ntersections..  
+00013600: 2020 0d0a 2020 2020 322e 206d 6f73 7420    ..    2. most 
+00013610: 6f66 2074 6865 2070 6f69 6e74 7320 6172  of the points ar
+00013620: 6520 696e 2074 6865 2063 6f72 7265 6374  e in the correct
+00013630: 2028 6c6f 6361 6c29 206f 7264 6572 2c0d   (local) order,.
+00013640: 0a20 2020 2074 6869 7320 6769 7665 7320  .    this gives 
+00013650: 7573 2061 2061 7665 7261 6765 2064 6972  us a average dir
+00013660: 6563 7469 6f6e 206f 6620 7468 6520 6375  ection of the cu
+00013670: 7276 652c 2077 6869 6368 2063 616e 200d  rve, which can .
+00013680: 0a20 2020 2068 656c 7020 7573 2066 696e  .    help us fin
+00013690: 6420 7468 6520 7374 6172 7469 6e67 2f65  d the starting/e
+000136a0: 6e64 2070 6f69 6e74 206f 6620 7468 6520  nd point of the 
+000136b0: 6375 7276 650d 0a20 2020 200d 0a20 2020  curve..    ..   
+000136c0: 2033 2e20 7468 6520 6e65 7874 2070 6f69   3. the next poi
+000136d0: 6e74 2069 7320 6974 7320 636c 6f73 6573  nt is its closes
+000136e0: 7420 706f 696e 7420 6f72 2074 6865 2063  t point or the c
+000136f0: 6c6f 7365 7374 2070 6f69 6e74 2069 6e20  losest point in 
+00013700: 7468 6520 6176 6572 6167 6520 6469 7265  the average dire
+00013710: 6374 696f 6e0d 0a20 2020 200d 0a20 2020  ction..    ..   
+00013720: 2034 2e20 6472 6f70 2064 7570 6c69 6361   4. drop duplica
+00013730: 7465 6420 706f 696e 7473 200d 0a20 2020  ted points ..   
+00013740: 200d 0a20 2020 2027 2727 0d0a 2020 2020   ..    '''..    
+00013750: 696e 6465 7865 7320 3d20 6e70 2e61 7261  indexes = np.ara
+00013760: 6e67 6528 302e 302c 206c 656e 2878 6929  nge(0.0, len(xi)
+00013770: 2c20 312e 3029 0d0a 2020 2020 706f 696e  , 1.0)..    poin
+00013780: 7473 2020 3d20 6e70 2e61 7272 6179 285b  ts  = np.array([
+00013790: 7869 2c20 7974 2c20 696e 6465 7865 735d  xi, yt, indexes]
+000137a0: 292e 7472 616e 7370 6f73 6528 290d 0a20  ).transpose().. 
+000137b0: 2020 2070 6f69 6e74 7320 203d 2070 6f69     points  = poi
+000137c0: 6e74 732e 636f 7079 2829 2e74 6f6c 6973  nts.copy().tolis
+000137d0: 7428 2920 2020 2023 205b 6e2c 335d 0d0a  t()    # [n,3]..
+000137e0: 2020 2020 6e5f 706f 696e 7420 3d20 6c65      n_point = le
+000137f0: 6e28 706f 696e 7473 290d 0a20 2020 200d  n(points)..    .
+00013800: 0a20 2020 2063 7269 5f62 7265 616b 203d  .    cri_break =
+00013810: 206d 6178 2863 7269 5f62 7265 616b 2c20   max(cri_break, 
+00013820: 322e 302f 6e5f 706f 696e 7429 0d0a 2020  2.0/n_point)..  
+00013830: 2020 0d0a 2020 2020 232a 2043 616c 6375    ..    #* Calcu
+00013840: 6c61 7465 2061 7665 7261 6765 2064 6972  late average dir
+00013850: 6563 7469 6f6e 0d0a 2020 2020 6966 206e  ection..    if n
+00013860: 6f74 2069 7369 6e73 7461 6e63 6528 6176  ot isinstance(av
+00013870: 675f 6469 722c 206e 702e 6e64 6172 7261  g_dir, np.ndarra
+00013880: 7929 3a0d 0a20 2020 2020 2020 200d 0a20  y):..        .. 
+00013890: 2020 2020 2020 2061 7667 5f64 6972 203d         avg_dir =
+000138a0: 206e 702e 7a65 726f 7328 3229 0d0a 2020   np.zeros(2)..  
+000138b0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000138c0: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
+000138d0: 656e 2878 6929 2d31 293a 0d0a 2020 2020  en(xi)-1):..    
+000138e0: 2020 2020 2020 2020 6478 6920 3d20 7869          dxi = xi
+000138f0: 5b69 2b31 5d2d 7869 5b69 5d0d 0a20 2020  [i+1]-xi[i]..   
+00013900: 2020 2020 2020 2020 2064 7974 203d 2079           dyt = y
+00013910: 745b 692b 315d 2d79 745b 695d 0d0a 2020  t[i+1]-yt[i]..  
+00013920: 2020 2020 2020 2020 2020 6c6c 2020 3d20            ll  = 
+00013930: 6e70 2e73 7172 7428 6478 692a 2a32 2b64  np.sqrt(dxi**2+d
+00013940: 7974 2a2a 3229 0d0a 2020 2020 2020 2020  yt**2)..        
+00013950: 2020 2020 6966 206c 6c20 3e20 6372 695f      if ll > cri_
+00013960: 6475 703a 0d0a 2020 2020 2020 2020 2020  dup:..          
+00013970: 2020 2020 2020 6176 675f 6469 7220 2b3d        avg_dir +=
+00013980: 206e 702e 6172 7261 7928 5b64 7869 2c64   np.array([dxi,d
+00013990: 7974 5d29 0d0a 0d0a 2020 2020 2020 2020  yt])....        
+000139a0: 6c61 203d 206e 702e 6c69 6e61 6c67 2e6e  la = np.linalg.n
+000139b0: 6f72 6d28 6176 675f 6469 7229 0d0a 2020  orm(avg_dir)..  
+000139c0: 2020 2020 2020 6c78 203d 2061 6273 2878        lx = abs(x
+000139d0: 695b 2d31 5d2d 7869 5b30 5d29 0d0a 2020  i[-1]-xi[0])..  
+000139e0: 2020 2020 2020 6c79 203d 2061 6273 2879        ly = abs(y
+000139f0: 745b 2d31 5d2d 7974 5b30 5d29 0d0a 0d0a  t[-1]-yt[0])....
+00013a00: 2020 2020 2020 2020 6966 206c 6120 3e20          if la > 
+00013a10: 302e 322a 286c 782b 6c79 293a 0d0a 2020  0.2*(lx+ly):..  
+00013a20: 2020 2020 2020 2020 2020 6176 675f 6469            avg_di
+00013a30: 7220 3d20 6176 675f 6469 722f 6c61 0d0a  r = avg_dir/la..
+00013a40: 2020 2020 2020 2020 656c 6966 206c 7820          elif lx 
+00013a50: 3e20 6c79 3a0d 0a20 2020 2020 2020 2020  > ly:..         
+00013a60: 2020 2061 7667 5f64 6972 203d 206e 702e     avg_dir = np.
+00013a70: 6172 7261 7928 5b31 2e2c 2030 2e5d 290d  array([1., 0.]).
+00013a80: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00013a90: 2020 2020 2020 2020 2020 2020 6176 675f              avg_
+00013aa0: 6469 7220 3d20 6e70 2e61 7272 6179 285b  dir = np.array([
+00013ab0: 302e 2c20 312e 5d29 0d0a 0d0a 2020 2020  0., 1.])....    
+00013ac0: 2020 2020 6969 203d 206e 702e 6172 676d      ii = np.argm
+00013ad0: 6178 286e 702e 6162 7328 6176 675f 6469  ax(np.abs(avg_di
+00013ae0: 7229 290d 0a20 2020 2020 2020 2069 6620  r))..        if 
+00013af0: 6176 675f 6469 725b 6969 5d3c 303a 0d0a  avg_dir[ii]<0:..
+00013b00: 2020 2020 2020 2020 2020 2020 6176 675f              avg_
+00013b10: 6469 7220 3d20 2d61 7667 5f64 6972 0d0a  dir = -avg_dir..
+00013b20: 0d0a 2020 2020 2020 2020 6669 785f 7374  ..        fix_st
+00013b30: 6172 7420 3d20 4661 6c73 650d 0a20 2020  art = False..   
+00013b40: 2020 2020 200d 0a20 2020 2065 6c73 653a       ..    else:
+00013b50: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00013b60: 2020 2020 6669 785f 7374 6172 7420 3d20      fix_start = 
+00013b70: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
+00013b80: 2020 0d0a 2020 2020 232a 2046 696e 6420    ..    #* Find 
+00013b90: 7468 6520 706f 7465 6e74 6961 6c20 7374  the potential st
+00013ba0: 6172 7420 706f 696e 740d 0a20 2020 2064  art point..    d
+00013bb0: 6420 3d20 6e70 2e64 6f74 286e 702e 6172  d = np.dot(np.ar
+00013bc0: 7261 7928 706f 696e 7473 295b 3a2c 3a32  ray(points)[:,:2
+00013bd0: 5d2c 2061 7667 5f64 6972 290d 0a20 2020  ], avg_dir)..   
+00013be0: 2069 6920 3d20 6e70 2e61 7267 6d69 6e28   ii = np.argmin(
+00013bf0: 6464 290d 0a20 2020 206e 6577 5f63 7572  dd)..    new_cur
+00013c00: 7665 203d 205b 706f 696e 7473 5b69 695d  ve = [points[ii]
+00013c10: 5d0d 0a20 2020 2070 6f69 6e74 732e 706f  ]..    points.po
+00013c20: 7028 6969 290d 0a20 2020 200d 0a20 2020  p(ii)..    ..   
+00013c30: 2023 2a20 4765 7420 7468 6520 6c65 6e67   #* Get the leng
+00013c40: 7468 2073 6361 6c65 206f 6620 7468 6520  th scale of the 
+00013c50: 6375 7276 650d 0a20 2020 206a 6a20 3d20  curve..    jj = 
+00013c60: 6e70 2e61 7267 6d61 7828 6464 290d 0a20  np.argmax(dd).. 
+00013c70: 2020 206c 7320 3d20 6464 5b6a 6a5d 2d64     ls = dd[jj]-d
+00013c80: 645b 6969 5d0d 0a0d 0a20 2020 2023 2a20  d[ii]....    #* 
+00013c90: 4170 7065 6e64 2063 7572 7665 2069 6e20  Append curve in 
+00013ca0: 7468 6520 6176 6572 6167 6520 6469 7265  the average dire
+00013cb0: 6374 696f 6e0d 0a20 2020 2077 6869 6c65  ction..    while
+00013cc0: 206c 656e 2870 6f69 6e74 7329 3e30 3a0d   len(points)>0:.
+00013cd0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00013ce0: 2020 2064 6174 6120 3d20 6e70 2e61 7272     data = np.arr
+00013cf0: 6179 2870 6f69 6e74 7329 5b3a 2c3a 325d  ay(points)[:,:2]
+00013d00: 2020 2023 205b 3a2c 325d 0d0a 2020 2020     # [:,2]..    
+00013d10: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
+00013d20: 6361 6c63 756c 6174 6520 7468 6520 6469  calculate the di
+00013d30: 7374 616e 6365 2074 6f20 7468 6520 6c61  stance to the la
+00013d40: 7374 2070 6f69 6e74 0d0a 2020 2020 2020  st point..      
+00013d50: 2020 6c61 7374 5f70 6f69 6e74 203d 206e    last_point = n
+00013d60: 702e 6172 7261 7928 6e65 775f 6375 7276  p.array(new_curv
+00013d70: 655b 2d31 5d29 5b4e 6f6e 652c 3a32 5d20  e[-1])[None,:2] 
+00013d80: 2020 2320 5b31 2c32 5d0d 0a20 2020 2020    # [1,2]..     
+00013d90: 2020 2064 326c 203d 206e 702e 6c69 6e61     d2l = np.lina
+00013da0: 6c67 2e6e 6f72 6d28 6461 7461 2d6c 6173  lg.norm(data-las
+00013db0: 745f 706f 696e 742c 2061 7869 733d 3129  t_point, axis=1)
+00013dc0: 2020 2023 205b 3a5d 0d0a 2020 2020 2020     # [:]..      
+00013dd0: 2020 695f 6c20 3d20 6e70 2e61 7267 6d69    i_l = np.argmi
+00013de0: 6e28 6432 6c29 0d0a 2020 2020 2020 2020  n(d2l)..        
+00013df0: 6d69 6e5f 6469 7332 6c61 7374 203d 2064  min_dis2last = d
+00013e00: 326c 5b69 5f6c 5d0d 0a20 2020 2020 2020  2l[i_l]..       
+00013e10: 200d 0a20 2020 2020 2020 2069 6620 6d69   ..        if mi
+00013e20: 6e5f 6469 7332 6c61 7374 3c63 7269 5f64  n_dis2last<cri_d
+00013e30: 7570 3a0d 0a20 2020 2020 2020 2020 2020  up:..           
+00013e40: 2070 6f69 6e74 732e 706f 7028 695f 6c29   points.pop(i_l)
+00013e50: 0d0a 2020 2020 2020 2020 2020 2020 636f  ..            co
+00013e60: 6e74 696e 7565 0d0a 2020 2020 2020 2020  ntinue..        
+00013e70: 0d0a 2020 2020 2020 2020 2320 6361 6c63  ..        # calc
+00013e80: 756c 6174 6520 7468 6520 6469 7374 616e  ulate the distan
+00013e90: 6365 2074 6f20 7468 6520 7374 6172 7420  ce to the start 
+00013ea0: 706f 696e 740d 0a20 2020 2020 2020 2073  point..        s
+00013eb0: 7461 7274 5f70 6f69 6e74 203d 206e 702e  tart_point = np.
+00013ec0: 6172 7261 7928 6e65 775f 6375 7276 655b  array(new_curve[
+00013ed0: 305d 295b 4e6f 6e65 2c3a 325d 2020 2023  0])[None,:2]   #
+00013ee0: 205b 312c 325d 0d0a 2020 2020 2020 2020   [1,2]..        
+00013ef0: 6432 7320 3d20 6e70 2e6c 696e 616c 672e  d2s = np.linalg.
+00013f00: 6e6f 726d 2864 6174 612d 7374 6172 745f  norm(data-start_
+00013f10: 706f 696e 742c 2061 7869 733d 3129 2020  point, axis=1)  
+00013f20: 2320 5b3a 5d0d 0a20 2020 2020 2020 2069  # [:]..        i
+00013f30: 5f73 203d 206e 702e 6172 676d 696e 2864  _s = np.argmin(d
+00013f40: 3273 290d 0a20 2020 2020 2020 206d 696e  2s)..        min
+00013f50: 5f64 6973 3273 7461 7274 203d 2064 3273  _dis2start = d2s
+00013f60: 5b69 5f73 5d0d 0a20 2020 2020 2020 200d  [i_s]..        .
+00013f70: 0a20 2020 2020 2020 2069 6620 6432 735b  .        if d2s[
+00013f80: 695f 735d 3c63 7269 5f64 7570 3a0d 0a20  i_s]<cri_dup:.. 
+00013f90: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
+00013fa0: 732e 706f 7028 695f 7329 0d0a 2020 2020  s.pop(i_s)..    
+00013fb0: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
+00013fc0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00013fd0: 2020 2020 6469 7265 6374 696f 6e5f 6c20      direction_l 
+00013fe0: 3d20 6e70 2e64 6f74 2864 6174 615b 695f  = np.dot(data[i_
+00013ff0: 6c2c 3a5d 2d6c 6173 745f 706f 696e 742c  l,:]-last_point,
+00014000: 2020 6176 675f 6469 7229 5b30 5d0d 0a20    avg_dir)[0].. 
+00014010: 2020 2020 2020 2064 6972 6563 7469 6f6e         direction
+00014020: 5f73 203d 206e 702e 646f 7428 6461 7461  _s = np.dot(data
+00014030: 5b69 5f73 2c3a 5d2d 7374 6172 745f 706f  [i_s,:]-start_po
+00014040: 696e 742c 2061 7667 5f64 6972 295b 305d  int, avg_dir)[0]
+00014050: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00014060: 2020 2020 6966 2028 6d69 6e5f 6469 7332      if (min_dis2
+00014070: 6c61 7374 3c3d 6d69 6e5f 6469 7332 7374  last<=min_dis2st
+00014080: 6172 7420 6f72 2066 6978 5f73 7461 7274  art or fix_start
+00014090: 2920 616e 6420 2864 6972 6563 7469 6f6e  ) and (direction
+000140a0: 5f6c 3e30 206f 7220 6d69 6e5f 6469 7332  _l>0 or min_dis2
+000140b0: 6c61 7374 3c3d 6372 695f 6272 6561 6b2a  last<=cri_break*
+000140c0: 6c73 293a 0d0a 2020 2020 2020 2020 2020  ls):..          
+000140d0: 2020 2320 4170 7065 6e64 2074 6f20 7468    # Append to th
+000140e0: 6520 6c61 7374 2070 6f69 6e74 2069 6e20  e last point in 
+000140f0: 7468 6520 6176 6572 6167 6520 6469 7265  the average dire
+00014100: 6374 696f 6e0d 0a20 2020 2020 2020 2020  ction..         
+00014110: 2020 206e 6577 5f63 7572 7665 2e61 7070     new_curve.app
+00014120: 656e 6428 706f 696e 7473 5b69 5f6c 5d29  end(points[i_l])
+00014130: 0d0a 2020 2020 2020 2020 2020 2020 706f  ..            po
+00014140: 696e 7473 2e70 6f70 2869 5f6c 290d 0a20  ints.pop(i_l).. 
+00014150: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+00014160: 6e75 650d 0a20 2020 2020 2020 2020 2020  nue..           
+00014170: 200d 0a20 2020 2020 2020 2069 6620 6d69   ..        if mi
+00014180: 6e5f 6469 7332 7374 6172 743c 3d6d 696e  n_dis2start<=min
+00014190: 5f64 6973 326c 6173 7420 616e 6420 2864  _dis2last and (d
+000141a0: 6972 6563 7469 6f6e 5f73 3c30 206f 7220  irection_s<0 or 
+000141b0: 6d69 6e5f 6469 7332 7374 6172 743c 3d63  min_dis2start<=c
+000141c0: 7269 5f62 7265 616b 2a6c 7329 2061 6e64  ri_break*ls) and
+000141d0: 206e 6f74 2066 6978 5f73 7461 7274 3a0d   not fix_start:.
+000141e0: 0a20 2020 2020 2020 2020 2020 2023 2041  .            # A
+000141f0: 6464 2062 6566 6f72 6520 7468 6520 7374  dd before the st
+00014200: 6172 7420 706f 696e 7420 696e 2074 6865  art point in the
+00014210: 206f 7070 6f73 6974 6520 6f66 2074 6865   opposite of the
+00014220: 2061 7665 7261 6765 2064 6972 6563 7469   average directi
+00014230: 6f6e 0d0a 2020 2020 2020 2020 2020 2020  on..            
+00014240: 6e65 775f 6375 7276 6520 3d20 5b70 6f69  new_curve = [poi
+00014250: 6e74 735b 695f 735d 5d20 2b20 6e65 775f  nts[i_s]] + new_
+00014260: 6375 7276 650d 0a20 2020 2020 2020 2020  curve..         
+00014270: 2020 2070 6f69 6e74 732e 706f 7028 695f     points.pop(i_
+00014280: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+00014290: 636f 6e74 696e 7565 0d0a 2020 2020 2020  continue..      
+000142a0: 2020 0d0a 2020 2020 2020 2020 6372 695f    ..        cri_
+000142b0: 6272 6561 6b20 3d20 6372 695f 6272 6561  break = cri_brea
+000142c0: 6b20 2a20 312e 310d 0a20 2020 2020 2020  k * 1.1..       
+000142d0: 200d 0a20 2020 206e 6577 5f63 7572 7665   ..    new_curve
+000142e0: 203d 206e 702e 6172 7261 7928 6e65 775f   = np.array(new_
+000142f0: 6375 7276 6529 0d0a 2020 2020 6f6c 645f  curve)..    old_
+00014300: 696e 6465 7820 3d20 6e65 775f 6375 7276  index = new_curv
+00014310: 655b 3a2c 325d 2e61 7374 7970 6528 696e  e[:,2].astype(in
+00014320: 7429 0d0a 0d0a 2020 2020 7265 7475 726e  t)....    return
+00014330: 206e 6577 5f63 7572 7665 5b3a 2c3a 325d   new_curve[:,:2]
+00014340: 2c20 6f6c 645f 696e 6465 782e 746f 6c69  , old_index.toli
+00014350: 7374 2829 0d0a 0d0a 6465 6620 6a6f 696e  st()....def join
+00014360: 5f63 7572 7665 7328 6375 7276 6573 3a20  _curves(curves: 
+00014370: 6c69 7374 2c20 6372 695f 6475 703d 3165  list, cri_dup=1e
+00014380: 2d36 2920 2d3e 206e 702e 6e64 6172 7261  -6) -> np.ndarra
+00014390: 793a 0d0a 2020 2020 2727 270d 0a20 2020  y:..    '''..   
+000143a0: 204a 6f69 6e20 7365 7665 7261 6c20 6375   Join several cu
+000143b0: 7276 6573 2069 6e74 6f20 6f6e 6520 7069  rves into one pi
+000143c0: 6563 652e 0d0a 2020 2020 0d0a 2020 2020  ece...    ..    
+000143d0: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+000143e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
+000143f0: 2063 7572 7665 7320 3a20 6c69 7374 206f   curves : list o
+00014400: 6620 6e64 6172 7261 7920 5b3a 2c33 206f  f ndarray [:,3 o
+00014410: 7220 332b 6e76 5d0d 0a20 2020 2020 2020  r 3+nv]..       
+00014420: 2063 6f6f 7264 696e 6174 6573 2061 6e64   coordinates and
+00014430: 2064 6174 6120 6f66 2074 6865 2063 7572   data of the cur
+00014440: 7665 732e 0d0a 2020 2020 6372 695f 6475  ves...    cri_du
+00014450: 7020 3a20 666c 6f61 740d 0a20 2020 2020  p : float..     
+00014460: 2020 2063 7269 7469 6361 6c20 6469 7374     critical dist
+00014470: 616e 6365 2074 6f20 6472 6f70 2064 7570  ance to drop dup
+00014480: 6c69 6361 7465 6420 706f 696e 7473 2e0d  licated points..
+00014490: 0a20 2020 2020 2020 200d 0a20 2020 2052  .        ..    R
+000144a0: 6574 7572 6e73 0d0a 2020 2020 2d2d 2d2d  eturns..    ----
+000144b0: 2d2d 2d2d 2d2d 0d0a 2020 2020 6e65 775f  ------..    new_
+000144c0: 6375 7276 6520 3a20 6e64 6172 7261 7920  curve : ndarray 
+000144d0: 5b3a 2c33 206f 7220 332b 6e76 5d0d 0a20  [:,3 or 3+nv].. 
+000144e0: 2020 2020 2020 206e 6577 2063 7572 7665         new curve
+000144f0: 0d0a 2020 2020 0d0a 2020 2020 4578 616d  ..    ..    Exam
+00014500: 706c 6573 0d0a 2020 2020 2d2d 2d2d 2d2d  ples..    ------
+00014510: 2d2d 2d2d 0d0a 2020 2020 3e3e 3e20 6e65  ----..    >>> ne
+00014520: 775f 6375 7276 6520 3d20 6a6f 696e 5f63  w_curve = join_c
+00014530: 7572 7665 7328 6375 7276 6573 3a20 6c69  urves(curves: li
+00014540: 7374 2c20 6372 695f 6475 703d 3165 2d36  st, cri_dup=1e-6
+00014550: 290d 0a20 2020 200d 0a20 2020 2027 2727  )..    ..    '''
+00014560: 0d0a 2020 2020 6e65 775f 6375 7276 6520  ..    new_curve 
+00014570: 3d20 6375 7276 6573 5b30 5d2e 636f 7079  = curves[0].copy
+00014580: 2829 2020 2020 2320 5b3a 2c33 5d0d 0a20  ()    # [:,3].. 
+00014590: 2020 200d 0a20 2020 2063 7572 7665 7320     ..    curves 
+000145a0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+000145b0: 6375 7276 6573 290d 0a20 2020 2063 7572  curves)..    cur
+000145c0: 7665 732e 706f 7028 3029 0d0a 2020 2020  ves.pop(0)..    
+000145d0: 0d0a 2020 2020 7768 696c 6520 6c65 6e28  ..    while len(
+000145e0: 6375 7276 6573 293e 303a 0d0a 2020 2020  curves)>0:..    
+000145f0: 2020 2020 0d0a 2020 2020 2020 2020 6430      ..        d0
+00014600: 3020 3d20 5b5d 0d0a 2020 2020 2020 2020  0 = []..        
+00014610: 6430 3120 3d20 5b5d 0d0a 2020 2020 2020  d01 = []..      
+00014620: 2020 6431 3020 3d20 5b5d 0d0a 2020 2020    d10 = []..    
+00014630: 2020 2020 6431 3120 3d20 5b5d 0d0a 2020      d11 = []..  
+00014640: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00014650: 666f 7220 6375 7220 696e 2063 7572 7665  for cur in curve
+00014660: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+00014670: 0d0a 2020 2020 2020 2020 2020 2020 6430  ..            d0
+00014680: 302e 6170 7065 6e64 286e 702e 6c69 6e61  0.append(np.lina
+00014690: 6c67 2e6e 6f72 6d28 6e65 775f 6375 7276  lg.norm(new_curv
+000146a0: 655b 2030 2c3a 335d 2d63 7572 5b20 302c  e[ 0,:3]-cur[ 0,
+000146b0: 3a33 5d29 290d 0a20 2020 2020 2020 2020  :3]))..         
+000146c0: 2020 2064 3031 2e61 7070 656e 6428 6e70     d01.append(np
+000146d0: 2e6c 696e 616c 672e 6e6f 726d 286e 6577  .linalg.norm(new
+000146e0: 5f63 7572 7665 5b20 302c 3a33 5d2d 6375  _curve[ 0,:3]-cu
+000146f0: 725b 2d31 2c3a 335d 2929 0d0a 2020 2020  r[-1,:3]))..    
+00014700: 2020 2020 2020 2020 6431 302e 6170 7065          d10.appe
+00014710: 6e64 286e 702e 6c69 6e61 6c67 2e6e 6f72  nd(np.linalg.nor
+00014720: 6d28 6e65 775f 6375 7276 655b 2d31 2c3a  m(new_curve[-1,:
+00014730: 335d 2d63 7572 5b20 302c 3a33 5d29 290d  3]-cur[ 0,:3])).
+00014740: 0a20 2020 2020 2020 2020 2020 2064 3131  .            d11
+00014750: 2e61 7070 656e 6428 6e70 2e6c 696e 616c  .append(np.linal
+00014760: 672e 6e6f 726d 286e 6577 5f63 7572 7665  g.norm(new_curve
+00014770: 5b2d 312c 3a33 5d2d 6375 725b 2d31 2c3a  [-1,:3]-cur[-1,:
+00014780: 335d 2929 0d0a 2020 2020 2020 2020 2020  3]))..          
+00014790: 2020 0d0a 2020 2020 2020 2020 6d69 6e5f    ..        min_
+000147a0: 6473 203d 205b 6e70 2e6d 696e 2864 3030  ds = [np.min(d00
+000147b0: 292c 206e 702e 6d69 6e28 6430 3129 2c20  ), np.min(d01), 
+000147c0: 6e70 2e6d 696e 2864 3130 292c 206e 702e  np.min(d10), np.
+000147d0: 6d69 6e28 6431 3129 5d0d 0a20 2020 2020  min(d11)]..     
+000147e0: 2020 2069 695f 6d69 6e20 3d20 6e70 2e61     ii_min = np.a
+000147f0: 7267 6d69 6e28 6d69 6e5f 6473 290d 0a0d  rgmin(min_ds)...
+00014800: 0a20 2020 2020 2020 2069 6620 6969 5f6d  .        if ii_m
+00014810: 696e 203d 3d20 303a 0d0a 2020 2020 2020  in == 0:..      
+00014820: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00014830: 2020 2020 6a6a 5f6d 696e 2020 2020 3d20      jj_min    = 
+00014840: 6e70 2e61 7267 6d69 6e28 6430 3029 0d0a  np.argmin(d00)..
+00014850: 2020 2020 2020 2020 2020 2020 6164 645f              add_
+00014860: 6375 7276 6520 3d20 6375 7276 6573 5b6a  curve = curves[j
+00014870: 6a5f 6d69 6e5d 2e63 6f70 7928 290d 0a20  j_min].copy().. 
+00014880: 2020 2020 2020 2020 2020 206e 6577 5f63             new_c
+00014890: 7572 7665 203d 206e 702e 666c 6970 286e  urve = np.flip(n
+000148a0: 6577 5f63 7572 7665 2c20 6178 6973 3d30  ew_curve, axis=0
+000148b0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
+000148c0: 0a20 2020 2020 2020 2065 6c69 6620 6969  .        elif ii
+000148d0: 5f6d 696e 203d 3d20 313a 0d0a 2020 2020  _min == 1:..    
+000148e0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000148f0: 2020 2020 2020 6a6a 5f6d 696e 2020 2020        jj_min    
+00014900: 3d20 6e70 2e61 7267 6d69 6e28 6430 3129  = np.argmin(d01)
+00014910: 0d0a 2020 2020 2020 2020 2020 2020 6164  ..            ad
+00014920: 645f 6375 7276 6520 3d20 6375 7276 6573  d_curve = curves
+00014930: 5b6a 6a5f 6d69 6e5d 2e63 6f70 7928 290d  [jj_min].copy().
+00014940: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+00014950: 5f63 7572 7665 203d 206e 702e 666c 6970  _curve = np.flip
+00014960: 286e 6577 5f63 7572 7665 2c20 6178 6973  (new_curve, axis
+00014970: 3d30 290d 0a20 2020 2020 2020 2020 2020  =0)..           
+00014980: 2061 6464 5f63 7572 7665 203d 206e 702e   add_curve = np.
+00014990: 666c 6970 2861 6464 5f63 7572 7665 2c20  flip(add_curve, 
+000149a0: 6178 6973 3d30 290d 0a20 2020 2020 2020  axis=0)..       
+000149b0: 2020 2020 200d 0a20 2020 2020 2020 2065       ..        e
+000149c0: 6c69 6620 6969 5f6d 696e 203d 3d20 323a  lif ii_min == 2:
+000149d0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+000149e0: 2020 2020 2020 2020 2020 2020 6a6a 5f6d              jj_m
+000149f0: 696e 2020 2020 3d20 6e70 2e61 7267 6d69  in    = np.argmi
+00014a00: 6e28 6431 3029 0d0a 2020 2020 2020 2020  n(d10)..        
+00014a10: 2020 2020 6164 645f 6375 7276 6520 3d20      add_curve = 
+00014a20: 6375 7276 6573 5b6a 6a5f 6d69 6e5d 2e63  curves[jj_min].c
+00014a30: 6f70 7928 290d 0a20 2020 2020 2020 2020  opy()..         
+00014a40: 2020 200d 0a20 2020 2020 2020 2065 6c69     ..        eli
+00014a50: 6620 6969 5f6d 696e 203d 3d20 333a 0d0a  f ii_min == 3:..
+00014a60: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00014a70: 2020 2020 2020 2020 2020 6a6a 5f6d 696e            jj_min
+00014a80: 2020 2020 3d20 6e70 2e61 7267 6d69 6e28      = np.argmin(
+00014a90: 6431 3129 0d0a 2020 2020 2020 2020 2020  d11)..          
+00014aa0: 2020 6164 645f 6375 7276 6520 3d20 6375    add_curve = cu
+00014ab0: 7276 6573 5b6a 6a5f 6d69 6e5d 2e63 6f70  rves[jj_min].cop
+00014ac0: 7928 290d 0a20 2020 2020 2020 2020 2020  y()..           
+00014ad0: 2061 6464 5f63 7572 7665 203d 206e 702e   add_curve = np.
+00014ae0: 666c 6970 2861 6464 5f63 7572 7665 2c20  flip(add_curve, 
+00014af0: 6178 6973 3d30 290d 0a20 2020 2020 2020  axis=0)..       
+00014b00: 2020 2020 200d 0a20 2020 2020 2020 2065       ..        e
+00014b10: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00014b20: 2020 7261 6973 6520 4578 6365 7074 696f    raise Exceptio
+00014b30: 6e28 290d 0a20 2020 2020 2020 200d 0a20  n()..        .. 
+00014b40: 2020 2020 2020 2069 6620 6e70 2e6d 696e         if np.min
+00014b50: 286d 696e 5f64 7329 3c63 7269 5f64 7570  (min_ds)<cri_dup
+00014b60: 3a0d 0a20 2020 2020 2020 2020 2020 206e  :..            n
+00014b70: 6577 5f63 7572 7665 203d 206e 702e 636f  ew_curve = np.co
+00014b80: 6e63 6174 656e 6174 6528 286e 6577 5f63  ncatenate((new_c
+00014b90: 7572 7665 2c20 6164 645f 6375 7276 655b  urve, add_curve[
+00014ba0: 313a 2c3a 5d29 2c61 7869 733d 3029 0d0a  1:,:]),axis=0)..
+00014bb0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00014bc0: 2020 2020 2020 2020 2020 206e 6577 5f63             new_c
+00014bd0: 7572 7665 203d 206e 702e 636f 6e63 6174  urve = np.concat
+00014be0: 656e 6174 6528 286e 6577 5f63 7572 7665  enate((new_curve
+00014bf0: 2c20 6164 645f 6375 7276 6529 2c61 7869  , add_curve),axi
+00014c00: 733d 3029 0d0a 0d0a 2020 2020 2020 2020  s=0)....        
+00014c10: 6375 7276 6573 2e70 6f70 286a 6a5f 6d69  curves.pop(jj_mi
+00014c20: 6e29 0d0a 2020 2020 2020 2020 0d0a 2020  n)..        ..  
+00014c30: 2020 7265 7475 726e 206e 6577 5f63 7572    return new_cur
+00014c40: 7665 0d0a 0d0a 6465 6620 7265 636f 6e73  ve....def recons
+00014c50: 7472 7563 745f 6375 7276 655f 6279 5f6c  truct_curve_by_l
+00014c60: 656e 6774 6828 6375 7276 653a 206e 702e  ength(curve: np.
+00014c70: 6e64 6172 7261 792c 206e 3a69 6e74 2920  ndarray, n:int) 
+00014c80: 2d3e 206e 702e 6e64 6172 7261 793a 0d0a  -> np.ndarray:..
+00014c90: 2020 2020 2727 270d 0a20 2020 2052 6563      '''..    Rec
+00014ca0: 6f6e 7374 7275 6374 2074 6865 2063 7572  onstruct the cur
+00014cb0: 7665 2077 6974 6820 6571 7569 6469 7374  ve with equidist
+00014cc0: 616e 7420 706f 696e 7473 2e0d 0a20 2020  ant points...   
+00014cd0: 200d 0a20 2020 2050 6172 616d 6574 6572   ..    Parameter
+00014ce0: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
+00014cf0: 2d0d 0a20 2020 2063 7572 7665 203a 206e  -..    curve : n
+00014d00: 6461 7272 6179 205b 3a2c 335d 0d0a 2020  darray [:,3]..  
+00014d10: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
+00014d20: 7320 6f66 2074 6865 2063 7572 7665 0d0a  s of the curve..
+00014d30: 2020 2020 6e20 3a20 696e 740d 0a20 2020      n : int..   
+00014d40: 2020 2020 206e 756d 6265 7220 6f66 2070       number of p
+00014d50: 6f69 6e74 730d 0a20 2020 200d 0a20 2020  oints..    ..   
+00014d60: 2052 6574 7572 6e73 0d0a 2020 2020 2d2d   Returns..    --
+00014d70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
+00014d80: 206e 6577 5f63 7572 7665 203a 206e 6461   new_curve : nda
+00014d90: 7272 6179 205b 6e2c 335d 0d0a 2020 2020  rray [n,3]..    
+00014da0: 2020 2020 636f 6f72 6469 6e61 7465 7320      coordinates 
+00014db0: 6f66 2074 6865 206e 6577 2063 7572 7665  of the new curve
+00014dc0: 0d0a 2020 2020 2727 270d 0a20 2020 200d  ..    '''..    .
+00014dd0: 0a20 2020 2023 2a20 5061 7261 6d65 7472  .    #* Parametr
+00014de0: 6963 2063 7572 7665 3a20 7828 7429 2c20  ic curve: x(t), 
+00014df0: 7928 7429 2c20 7a28 7429 2c20 7420 696e  y(t), z(t), t in
+00014e00: 205b 302c 315d 0d0a 2020 2020 6e30 203d   [0,1]..    n0 =
+00014e10: 2063 7572 7665 2e73 6861 7065 5b30 5d0d   curve.shape[0].
+00014e20: 0a20 2020 206c 3020 3d20 302e 300d 0a20  .    l0 = 0.0.. 
+00014e30: 2020 2074 7420 3d20 6e70 2e7a 6572 6f73     tt = np.zeros
+00014e40: 286e 3029 0d0a 2020 2020 666f 7220 6920  (n0)..    for i 
+00014e50: 696e 2072 616e 6765 286e 302d 3129 3a0d  in range(n0-1):.
+00014e60: 0a20 2020 2020 2020 206c 3020 2b3d 206e  .        l0 += n
+00014e70: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 6375  p.linalg.norm(cu
+00014e80: 7276 655b 692b 312c 3a5d 2d63 7572 7665  rve[i+1,:]-curve
+00014e90: 5b69 2c3a 5d29 0d0a 2020 2020 2020 2020  [i,:])..        
+00014ea0: 7474 5b69 2b31 5d20 3d20 6c30 0d0a 2020  tt[i+1] = l0..  
+00014eb0: 2020 7474 203d 2074 742f 6c30 0d0a 2020    tt = tt/l0..  
+00014ec0: 2020 0d0a 2020 2020 232a 2052 6563 6f6e    ..    #* Recon
+00014ed0: 7374 7275 6374 696f 6e0d 0a20 2020 2066  struction..    f
+00014ee0: 7820 3d20 696e 7465 7270 3164 2874 742c  x = interp1d(tt,
+00014ef0: 2063 7572 7665 5b3a 2c30 5d2c 206b 696e   curve[:,0], kin
+00014f00: 643d 2763 7562 6963 2729 0d0a 2020 2020  d='cubic')..    
+00014f10: 6679 203d 2069 6e74 6572 7031 6428 7474  fy = interp1d(tt
+00014f20: 2c20 6375 7276 655b 3a2c 315d 2c20 6b69  , curve[:,1], ki
+00014f30: 6e64 3d27 6375 6269 6327 290d 0a20 2020  nd='cubic')..   
+00014f40: 2066 7a20 3d20 696e 7465 7270 3164 2874   fz = interp1d(t
+00014f50: 742c 2063 7572 7665 5b3a 2c32 5d2c 206b  t, curve[:,2], k
+00014f60: 696e 643d 2763 7562 6963 2729 0d0a 0d0a  ind='cubic')....
+00014f70: 2020 2020 6e65 775f 6375 7276 6520 3d20      new_curve = 
+00014f80: 6e70 2e7a 6572 6f73 2828 6e2c 3329 290d  np.zeros((n,3)).
+00014f90: 0a20 2020 200d 0a20 2020 2066 6f72 2069  .    ..    for i
+00014fa0: 2069 6e20 7261 6e67 6528 6e29 3a0d 0a20   in range(n):.. 
+00014fb0: 2020 2020 2020 2074 203d 2069 2f28 6e2d         t = i/(n-
+00014fc0: 312e 3029 0d0a 2020 2020 2020 2020 6e65  1.0)..        ne
+00014fd0: 775f 6375 7276 655b 692c 305d 203d 2066  w_curve[i,0] = f
+00014fe0: 7828 7429 0d0a 2020 2020 2020 2020 6e65  x(t)..        ne
+00014ff0: 775f 6375 7276 655b 692c 315d 203d 2066  w_curve[i,1] = f
+00015000: 7928 7429 0d0a 2020 2020 2020 2020 6e65  y(t)..        ne
+00015010: 775f 6375 7276 655b 692c 325d 203d 2066  w_curve[i,2] = f
+00015020: 7a28 7429 0d0a 2020 2020 2020 2020 0d0a  z(t)..        ..
+00015030: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+00015040: 7572 7665 0d0a 2020 2020 0d0a 6465 6620  urve..    ..def 
+00015050: 6578 7472 6163 745f 736c 6963 6528 6c6f  extract_slice(lo
+00015060: 6361 7469 6f6e 733a 206c 6973 742c 2050  cations: list, P
+00015070: 7265 663a 206e 702e 6e64 6172 7261 792c  ref: np.ndarray,
+00015080: 2064 6972 5f6e 6f72 6d3a 206e 702e 6e64   dir_norm: np.nd
+00015090: 6172 7261 792c 2064 6972 5f72 6566 3d6e  array, dir_ref=n
+000150a0: 702e 6172 7261 7928 5b31 2e2c 302e 2c30  p.array([1.,0.,0
+000150b0: 2e5d 292c 0d0a 2020 2020 2020 2020 2020  .]),..          
+000150c0: 2020 2020 2020 2020 2020 666e 616d 653d            fname=
+000150d0: 2773 7572 6661 6365 2d61 6972 6372 6166  'surface-aircraf
+000150e0: 742e 6461 7427 2c20 7a6f 6e65 5f69 643d  t.dat', zone_id=
+000150f0: 5b5d 2c20 696e 6465 785f 7879 7a3d 5b30  [], index_xyz=[0
+00015100: 2c31 2c32 5d2c 2061 7272 616e 6765 5f6d  ,1,2], arrange_m
+00015110: 6574 686f 643d 276a 6f69 6e27 293a 0d0a  ethod='join'):..
+00015120: 2020 2020 2727 270d 0a20 2020 2045 7874      '''..    Ext
+00015130: 7261 6374 2064 6174 6120 736c 6963 6564  ract data sliced
+00015140: 2062 7920 706c 616e 6573 2e0d 0a20 2020   by planes...   
+00015150: 200d 0a20 2020 2050 6172 616d 6574 6572   ..    Parameter
+00015160: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
+00015170: 2d2d 2d2d 2d0d 0a20 2020 206c 6f63 6174  -----..    locat
+00015180: 696f 6e73 203a 206c 6973 7420 6f66 2066  ions : list of f
+00015190: 6c6f 6174 0d0a 2020 2020 2020 2020 6c69  loat..        li
+000151a0: 7374 206f 6620 6469 7374 616e 6365 7320  st of distances 
+000151b0: 746f 2074 6865 2072 6566 6572 656e 6365  to the reference
+000151c0: 2070 6f69 6e74 2069 6e20 7468 6520 6769   point in the gi
+000151d0: 7665 6e20 6469 7265 6374 696f 6e2e 0d0a  ven direction...
+000151e0: 2020 2020 5072 6566 203a 206e 6461 7272      Pref : ndarr
+000151f0: 6179 205b 335d 0d0a 2020 2020 2020 2020  ay [3]..        
+00015200: 636f 6f72 6469 6e61 7465 7320 6f66 2074  coordinates of t
+00015210: 6865 2072 6566 6572 656e 6365 2070 6f69  he reference poi
+00015220: 6e74 2e0d 0a20 2020 2064 6972 5f6e 6f72  nt...    dir_nor
+00015230: 6d20 3a20 6e64 6172 7261 7920 5b33 5d0d  m : ndarray [3].
+00015240: 0a20 2020 2020 2020 2064 6972 6563 7469  .        directi
+00015250: 6f6e 2076 6563 746f 7220 6e6f 726d 616c  on vector normal
+00015260: 2074 6f20 7468 6520 736c 6963 6520 706c   to the slice pl
+00015270: 616e 6520 2877 696c 6c20 6265 206e 6f72  ane (will be nor
+00015280: 6d61 6c69 7a65 6429 2e0d 0a20 2020 2064  malized)...    d
+00015290: 6972 5f72 6566 203a 206e 6461 7272 6179  ir_ref : ndarray
+000152a0: 205b 335d 0d0a 2020 2020 2020 2020 6469   [3]..        di
+000152b0: 7265 6374 696f 6e20 7665 6374 6f72 2074  rection vector t
+000152c0: 6861 7420 726f 7567 686c 7920 7365 7473  hat roughly sets
+000152d0: 2074 6865 2078 692d 6178 6973 2069 6e20   the xi-axis in 
+000152e0: 7468 6520 736c 6963 6520 706c 616e 652e  the slice plane.
+000152f0: 0d0a 2020 2020 666e 616d 6520 3a20 7374  ..    fname : st
+00015300: 720d 0a20 2020 2020 2020 2066 696c 6520  r..        file 
+00015310: 6e61 6d65 2e0d 0a20 2020 207a 6f6e 655f  name...    zone_
+00015320: 6964 203a 206c 6973 7420 6f66 2069 6e74  id : list of int
+00015330: 0d0a 2020 2020 2020 2020 696e 6465 7820  ..        index 
+00015340: 6f66 207a 6f6e 6573 2069 6e20 7468 6520  of zones in the 
+00015350: 7465 6370 6c6f 7420 666f 726d 6174 2066  tecplot format f
+00015360: 696c 652c 2073 7461 7274 2066 726f 6d20  ile, start from 
+00015370: 302e 0d0a 2020 2020 696e 6465 785f 7879  0...    index_xy
+00015380: 7a20 3a20 6c69 7374 206f 6620 696e 7420  z : list of int 
+00015390: 0d0a 2020 2020 2020 2020 696e 6465 7820  ..        index 
+000153a0: 6f66 2076 6172 6961 626c 6573 2069 6e20  of variables in 
+000153b0: 6669 6c65 2066 6f72 2058 2c20 5920 616e  file for X, Y an
+000153c0: 6420 5a2e 0d0a 2020 2020 6172 7261 6e67  d Z...    arrang
+000153d0: 655f 6d65 7468 6f64 203a 2073 7472 0d0a  e_method : str..
+000153e0: 2020 2020 2020 2020 6966 2027 6a6f 696e          if 'join
+000153f0: 272c 206b 6565 7073 2074 6865 206f 7269  ', keeps the ori
+00015400: 6769 6e61 6c20 6f72 6465 7220 6f66 2070  ginal order of p
+00015410: 6f69 6e74 7320 2873 7569 7461 626c 6520  oints (suitable 
+00015420: 666f 7220 7375 7266 6163 6520 7769 7468  for surface with
+00015430: 2061 2066 6577 2062 6c6f 636b 7329 2e0d   a few blocks)..
+00015440: 0a20 2020 2020 2020 2049 6620 2772 6561  .        If 'rea
+00015450: 7272 616e 6765 272c 2072 6561 7272 616e  rrange', rearran
+00015460: 6765 2070 6f69 6e74 7320 6279 206d 696e  ge points by min
+00015470: 696d 616c 2064 6973 7461 6e63 652e 0d0a  imal distance...
+00015480: 2020 2020 0d0a 2020 2020 5265 7475 726e      ..    Return
+00015490: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
+000154a0: 2d2d 2d0d 0a20 2020 2073 6563 7469 6f6e  ---..    section
+000154b0: 7320 3a20 6c69 7374 206f 6620 6e64 6172  s : list of ndar
+000154c0: 7261 7920 5b3a 2c33 2b6e 765d 0d0a 2020  ray [:,3+nv]..  
+000154d0: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
+000154e0: 7320 616e 6420 6461 7461 206f 6e20 7468  s and data on th
+000154f0: 6520 736c 6963 652e 0d0a 2020 2020 6e61  e slice...    na
+00015500: 6d65 5f76 6172 203a 206c 6973 7420 6f72  me_var : list or
+00015510: 2073 7472 0d0a 2020 2020 2020 2020 6e61   str..        na
+00015520: 6d65 206f 6620 7661 7269 6162 6c65 730d  me of variables.
+00015530: 0a20 2020 200d 0a20 2020 2045 7861 6d70  .    ..    Examp
+00015540: 6c65 730d 0a20 2020 202d 2d2d 2d2d 2d2d  les..    -------
+00015550: 2d2d 2d0d 0a20 2020 203e 3e3e 2073 6563  ---..    >>> sec
+00015560: 7469 6f6e 732c 206e 616d 655f 7661 7220  tions, name_var 
+00015570: 3d20 6578 7472 6163 745f 736c 6963 6528  = extract_slice(
+00015580: 6c6f 6361 7469 6f6e 732c 2050 7265 662c  locations, Pref,
+00015590: 2064 6972 5f6e 6f72 6d2c 2064 6972 5f72   dir_norm, dir_r
+000155a0: 6566 3d6e 702e 6172 7261 7928 5b31 2e2c  ef=np.array([1.,
+000155b0: 302e 2c30 2e5d 292c 0d0a 2020 2020 2020  0.,0.]),..      
+000155c0: 2020 2020 2020 2020 2020 2020 2020 666e                fn
+000155d0: 616d 653d 2773 7572 6661 6365 2d61 6972  ame='surface-air
+000155e0: 6372 6166 742e 6461 7427 2c20 7a6f 6e65  craft.dat', zone
+000155f0: 5f69 643d 5b5d 2c20 696e 6465 785f 7879  _id=[], index_xy
+00015600: 7a3d 5b30 2c31 2c32 5d2c 2061 7272 616e  z=[0,1,2], arran
+00015610: 6765 5f6d 6574 686f 643d 276a 6f69 6e27  ge_method='join'
+00015620: 290d 0a20 2020 2027 2727 0d0a 2020 2020  )..    '''..    
+00015630: 232a 2052 6561 6420 7375 7266 6163 6520  #* Read surface 
+00015640: 6461 7461 0d0a 2020 2020 6461 7461 5f2c  data..    data_,
+00015650: 206e 616d 655f 7661 722c 205f 203d 2072   name_var, _ = r
+00015660: 6561 645f 7465 6370 6c6f 7428 666e 616d  ead_tecplot(fnam
+00015670: 6529 0d0a 2020 2020 696e 6465 785f 7661  e)..    index_va
+00015680: 7220 3d20 5b69 2066 6f72 2069 2069 6e20  r = [i for i in 
+00015690: 7261 6e67 6528 6c65 6e28 6e61 6d65 5f76  range(len(name_v
+000156a0: 6172 2929 5d0d 0a20 2020 2066 6f72 2069  ar))]..    for i
+000156b0: 2069 6e20 696e 6465 785f 7879 7a3a 0d0a   in index_xyz:..
+000156c0: 2020 2020 2020 2020 696e 6465 785f 7661          index_va
+000156d0: 722e 7265 6d6f 7665 2869 290d 0a20 2020  r.remove(i)..   
+000156e0: 200d 0a20 2020 2069 6620 6c65 6e28 7a6f   ..    if len(zo
+000156f0: 6e65 5f69 6429 3d3d 303a 0d0a 2020 2020  ne_id)==0:..    
+00015700: 2020 2020 6461 7461 203d 2064 6174 615f      data = data_
+00015710: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+00015720: 2020 2020 2064 6174 6120 3d20 5b64 6174       data = [dat
+00015730: 615f 5b69 5d20 666f 7220 6920 696e 207a  a_[i] for i in z
+00015740: 6f6e 655f 6964 5d0d 0a20 2020 200d 0a20  one_id]..    .. 
+00015750: 2020 2023 2a20 496e 7465 7273 6563 7420     #* Intersect 
+00015760: 7365 6374 696f 6e73 0d0a 2020 2020 646e  sections..    dn
+00015770: 203d 2064 6972 5f6e 6f72 6d2f 6e70 2e6c   = dir_norm/np.l
+00015780: 696e 616c 672e 6e6f 726d 2864 6972 5f6e  inalg.norm(dir_n
+00015790: 6f72 6d29 0d0a 2020 2020 6472 203d 2064  orm)..    dr = d
+000157a0: 6972 5f72 6566 202d 206e 702e 646f 7428  ir_ref - np.dot(
+000157b0: 6469 725f 7265 662c 2064 6e29 2a64 6e0d  dir_ref, dn)*dn.
+000157c0: 0a20 2020 2064 7220 3d20 6472 2f6e 702e  .    dr = dr/np.
+000157d0: 6c69 6e61 6c67 2e6e 6f72 6d28 6469 725f  linalg.norm(dir_
+000157e0: 6e6f 726d 290d 0a20 2020 2064 7420 3d20  norm)..    dt = 
+000157f0: 6e70 2e63 726f 7373 2864 6e2c 2064 7229  np.cross(dn, dr)
+00015800: 0d0a 2020 2020 6474 203d 2064 742f 6e70  ..    dt = dt/np
+00015810: 2e6c 696e 616c 672e 6e6f 726d 2864 7429  .linalg.norm(dt)
+00015820: 0d0a 2020 2020 0d0a 2020 2020 7365 6374  ..    ..    sect
+00015830: 696f 6e73 203d 205b 5d0d 0a0d 0a20 2020  ions = []....   
+00015840: 2066 6f72 206c 6f63 2069 6e20 6c6f 6361   for loc in loca
+00015850: 7469 6f6e 733a 0d0a 2020 2020 2020 2020  tions:..        
+00015860: 0d0a 2020 2020 2020 2020 5030 203d 2050  ..        P0 = P
+00015870: 7265 6620 2b20 6c6f 632a 646e 0d0a 2020  ref + loc*dn..  
+00015880: 2020 2020 2020 5031 203d 2050 3020 2b20        P1 = P0 + 
+00015890: 6472 0d0a 2020 2020 2020 2020 5033 203d  dr..        P3 =
+000158a0: 2050 3020 2b20 6474 0d0a 2020 2020 2020   P0 + dt..      
+000158b0: 2020 0d0a 2020 2020 2020 2020 6375 7276    ..        curv
+000158c0: 6573 203d 205b 5d0d 0a20 2020 2020 2020  es = []..       
+000158d0: 2078 695f 6375 7276 6573 203d 205b 5d0d   xi_curves = [].
+000158e0: 0a20 2020 2020 2020 2079 745f 6375 7276  .        yt_curv
+000158f0: 6573 203d 205b 5d0d 0a20 2020 2020 2020  es = []..       
+00015900: 200d 0a20 2020 2020 2020 2066 6f72 2064   ..        for d
+00015910: 6174 615f 2069 6e20 6461 7461 3a0d 0a20  ata_ in data:.. 
+00015920: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00015930: 2020 2020 2020 2020 2073 7572 6661 6365           surface
+00015940: 203d 206e 702e 636f 6e63 6174 656e 6174   = np.concatenat
+00015950: 6528 2864 6174 615f 5b3a 2c3a 2c3a 2c69  e((data_[:,:,:,i
+00015960: 6e64 6578 5f78 797a 5b30 5d3a 696e 6465  ndex_xyz[0]:inde
+00015970: 785f 7879 7a5b 305d 2b31 5d2c 0d0a 2020  x_xyz[0]+1],..  
 00015980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015990: 2020 2020 2020 2020 6461 7461 5f5b 3a2c          data_[:,
-000159a0: 3a2c 3a2c 696e 6465 785f 7879 7a5b 315d  :,:,index_xyz[1]
-000159b0: 3a69 6e64 6578 5f78 797a 5b31 5d2b 315d  :index_xyz[1]+1]
-000159c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000159d0: 2020 2020 2020 2020 2020 2064 6174 615f             data_
-000159e0: 5b3a 2c3a 2c3a 2c69 6e64 6578 5f78 797a  [:,:,:,index_xyz
-000159f0: 5b32 5d3a 696e 6465 785f 7879 7a5b 325d  [2]:index_xyz[2]
-00015a00: 2b31 5d29 2c20 6178 6973 3d33 290d 0a20  +1]), axis=3).. 
-00015a10: 2020 2020 2020 2020 2020 2073 7572 6661             surfa
-00015a20: 6365 203d 2073 7572 6661 6365 2e73 7175  ce = surface.squ
-00015a30: 6565 7a65 2829 0d0a 2020 2020 2020 2020  eeze()..        
-00015a40: 2020 2020 6375 7276 652c 2069 6a5f 6375      curve, ij_cu
-00015a50: 7276 652c 2078 695f 6375 7276 652c 2079  rve, xi_curve, y
-00015a60: 745f 6375 7276 6520 3d20 696e 7465 7273  t_curve = inters
-00015a70: 6563 745f 7375 7266 6163 655f 706c 616e  ect_surface_plan
-00015a80: 6528 7375 7266 6163 652c 0d0a 2020 2020  e(surface,..    
+00015990: 2020 2020 2020 6461 7461 5f5b 3a2c 3a2c        data_[:,:,
+000159a0: 3a2c 696e 6465 785f 7879 7a5b 315d 3a69  :,index_xyz[1]:i
+000159b0: 6e64 6578 5f78 797a 5b31 5d2b 315d 2c0d  ndex_xyz[1]+1],.
+000159c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000159d0: 2020 2020 2020 2020 2064 6174 615f 5b3a           data_[:
+000159e0: 2c3a 2c3a 2c69 6e64 6578 5f78 797a 5b32  ,:,:,index_xyz[2
+000159f0: 5d3a 696e 6465 785f 7879 7a5b 325d 2b31  ]:index_xyz[2]+1
+00015a00: 5d29 2c20 6178 6973 3d33 290d 0a20 2020  ]), axis=3)..   
+00015a10: 2020 2020 2020 2020 2073 7572 6661 6365           surface
+00015a20: 203d 2073 7572 6661 6365 2e73 7175 6565   = surface.squee
+00015a30: 7a65 2829 0d0a 2020 2020 2020 2020 2020  ze()..          
+00015a40: 2020 6375 7276 652c 2069 6a5f 6375 7276    curve, ij_curv
+00015a50: 652c 2078 695f 6375 7276 652c 2079 745f  e, xi_curve, yt_
+00015a60: 6375 7276 6520 3d20 696e 7465 7273 6563  curve = intersec
+00015a70: 745f 7375 7266 6163 655f 706c 616e 6528  t_surface_plane(
+00015a80: 7375 7266 6163 652c 0d0a 2020 2020 2020  surface,..      
 00015a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015aa0: 2020 2020 5030 2c20 5031 2c20 5033 2c20      P0, P1, P3, 
-00015ab0: 7769 7468 696e 5f62 6f75 6e64 733d 4661  within_bounds=Fa
-00015ac0: 6c73 652c 206f 7269 6769 6e61 6c5f 6f72  lse, original_or
-00015ad0: 6465 723d 2861 7272 616e 6765 5f6d 6574  der=(arrange_met
-00015ae0: 686f 643d 3d27 6a6f 696e 2729 290d 0a20  hod=='join')).. 
-00015af0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00015b00: 2020 2020 2020 2020 2073 7572 6661 6365           surface
-00015b10: 5f76 6172 203d 205b 5d0d 0a20 2020 2020  _var = []..     
-00015b20: 2020 2020 2020 2066 6f72 2069 7620 696e         for iv in
-00015b30: 2069 6e64 6578 5f76 6172 3a0d 0a20 2020   index_var:..   
-00015b40: 2020 2020 2020 2020 2020 2020 2073 7572               sur
-00015b50: 6661 6365 5f76 6172 2e61 7070 656e 6428  face_var.append(
-00015b60: 6461 7461 5f5b 3a2c 3a2c 3a2c 6976 5d29  data_[:,:,:,iv])
-00015b70: 0d0a 2020 2020 2020 2020 2020 2020 7375  ..            su
-00015b80: 7266 6163 655f 7661 7220 3d20 6e70 2e74  rface_var = np.t
-00015b90: 7261 6e73 706f 7365 286e 702e 6172 7261  ranspose(np.arra
-00015ba0: 7928 7375 7266 6163 655f 7661 7229 2c20  y(surface_var), 
-00015bb0: 5b31 2c32 2c33 2c30 5d29 2e73 7175 6565  [1,2,3,0]).squee
-00015bc0: 7a65 2829 2020 2320 5b3a 2c3a 2c6e 765d  ze()  # [:,:,nv]
-00015bd0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00015be0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00015bf0: 656e 2863 7572 7665 2920 3d3d 2030 3a0d  en(curve) == 0:.
-00015c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015c10: 2063 6f6e 7469 6e75 650d 0a0d 0a20 2020   continue....   
-00015c20: 2020 2020 2020 2020 206e 6577 5f63 7572           new_cur
-00015c30: 7665 203d 205b 5d0d 0a20 2020 2020 2020  ve = []..       
-00015c40: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00015c50: 6e67 6528 6c65 6e28 6375 7276 6529 293a  nge(len(curve)):
-00015c60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015c70: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00015c80: 2020 2020 6969 2c20 6a6a 203d 2069 6a5f      ii, jj = ij_
-00015c90: 6375 7276 655b 695d 0d0a 2020 2020 2020  curve[i]..      
-00015ca0: 2020 2020 2020 2020 2020 6969 203d 206d            ii = m
-00015cb0: 696e 2873 7572 6661 6365 2e73 6861 7065  in(surface.shape
-00015cc0: 5b30 5d2d 322c 2069 6929 0d0a 2020 2020  [0]-2, ii)..    
-00015cd0: 2020 2020 2020 2020 2020 2020 6a6a 203d              jj =
-00015ce0: 206d 696e 2873 7572 6661 6365 2e73 6861   min(surface.sha
-00015cf0: 7065 5b31 5d2d 322c 206a 6a29 0d0a 2020  pe[1]-2, jj)..  
-00015d00: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-00015d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d20: 7873 203d 205b 7375 7266 6163 655b 6969  xs = [surface[ii
-00015d30: 2c6a 6a2c 3a5d 2c20 7375 7266 6163 655b  ,jj,:], surface[
-00015d40: 6969 2b31 2c6a 6a2c 3a5d 2c20 7375 7266  ii+1,jj,:], surf
-00015d50: 6163 655b 6969 2c6a 6a2b 312c 3a5d 2c20  ace[ii,jj+1,:], 
-00015d60: 7375 7266 6163 655b 6969 2b31 2c6a 6a2b  surface[ii+1,jj+
-00015d70: 312c 3a5d 5d0d 0a20 2020 2020 2020 2020  1,:]]..         
-00015d80: 2020 2020 2020 2079 7320 3d20 5b73 7572         ys = [sur
-00015d90: 6661 6365 5f76 6172 5b69 692c 6a6a 2c3a  face_var[ii,jj,:
-00015da0: 5d2c 2073 7572 6661 6365 5f76 6172 5b69  ], surface_var[i
-00015db0: 692b 312c 6a6a 2c3a 5d2c 2073 7572 6661  i+1,jj,:], surfa
-00015dc0: 6365 5f76 6172 5b69 692c 6a6a 2b31 2c3a  ce_var[ii,jj+1,:
-00015dd0: 5d2c 2073 7572 6661 6365 5f76 6172 5b69  ], surface_var[i
-00015de0: 692b 312c 6a6a 2b31 2c3a 5d5d 0d0a 2020  i+1,jj+1,:]]..  
-00015df0: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-00015e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e10: 7879 7a20 3d20 6375 7276 655b 695d 5b4e  xyz = curve[i][N
-00015e20: 6f6e 652c 3a5d 0d0a 2020 2020 2020 2020  one,:]..        
-00015e30: 2020 2020 2020 2020 7661 7220 3d20 696e          var = in
-00015e40: 7465 7270 6f6c 6174 655f 4944 5728 7879  terpolate_IDW(xy
-00015e50: 7a2c 206e 702e 6172 7261 7928 7873 292c  z, np.array(xs),
-00015e60: 206e 702e 6172 7261 7928 7973 2929 0d0a   np.array(ys))..
-00015e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e80: 746d 7020 3d20 6e70 2e63 6f6e 6361 7465  tmp = np.concate
-00015e90: 6e61 7465 2828 7879 7a2c 2076 6172 292c  nate((xyz, var),
-00015ea0: 2061 7869 733d 3129 2e73 7175 6565 7a65   axis=1).squeeze
-00015eb0: 2829 0d0a 0d0a 2020 2020 2020 2020 2020  ()....          
-00015ec0: 2020 2020 2020 6e65 775f 6375 7276 652e        new_curve.
-00015ed0: 6170 7065 6e64 2874 6d70 290d 0a20 2020  append(tmp)..   
-00015ee0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00015ef0: 2020 2020 2020 2069 6620 6172 7261 6e67         if arrang
-00015f00: 655f 6d65 7468 6f64 203d 3d20 276a 6f69  e_method == 'joi
-00015f10: 6e27 3a0d 0a20 2020 2020 2020 2020 2020  n':..           
-00015f20: 2020 2020 2063 7572 7665 732e 6170 7065       curves.appe
-00015f30: 6e64 286e 702e 6172 7261 7928 6e65 775f  nd(np.array(new_
-00015f40: 6375 7276 6529 290d 0a20 2020 2020 2020  curve))..       
-00015f50: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00015f60: 2020 2020 2020 2020 2020 2020 6375 7276              curv
-00015f70: 6573 202b 3d20 6e65 775f 6375 7276 650d  es += new_curve.
-00015f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015f90: 2078 695f 6375 7276 6573 202b 3d20 7869   xi_curves += xi
-00015fa0: 5f63 7572 7665 2e74 6f6c 6973 7428 290d  _curve.tolist().
-00015fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015fc0: 2079 745f 6375 7276 6573 202b 3d20 7974   yt_curves += yt
-00015fd0: 5f63 7572 7665 2e74 6f6c 6973 7428 290d  _curve.tolist().
-00015fe0: 0a0d 0a20 2020 2020 2020 2069 6620 6172  ...        if ar
-00015ff0: 7261 6e67 655f 6d65 7468 6f64 203d 3d20  range_method == 
-00016000: 276a 6f69 6e27 3a0d 0a20 2020 2020 2020  'join':..       
-00016010: 2020 2020 2063 7572 7665 203d 206a 6f69       curve = joi
-00016020: 6e5f 6375 7276 6573 2863 7572 7665 7329  n_curves(curves)
-00016030: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00016040: 0a20 2020 2020 2020 2020 2020 205f 2c20  .            _, 
-00016050: 6f6c 645f 696e 6465 7820 3d20 7265 6172  old_index = rear
-00016060: 7261 6e67 655f 706f 696e 7473 286e 702e  range_points(np.
-00016070: 6172 7261 7928 7869 5f63 7572 7665 7329  array(xi_curves)
-00016080: 2c20 6e70 2e61 7272 6179 2879 745f 6375  , np.array(yt_cu
-00016090: 7276 6573 292c 2061 7667 5f64 6972 3d6e  rves), avg_dir=n
-000160a0: 702e 6172 7261 7928 5b31 2e2c 302e 5d29  p.array([1.,0.])
-000160b0: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
-000160c0: 7572 7665 203d 206e 702e 6172 7261 7928  urve = np.array(
-000160d0: 5b63 7572 7665 735b 6969 5d20 666f 7220  [curves[ii] for 
-000160e0: 6969 2069 6e20 6f6c 645f 696e 6465 785d  ii in old_index]
-000160f0: 290d 0a0d 0a20 2020 2020 2020 2073 6563  )....        sec
-00016100: 7469 6f6e 732e 6170 7065 6e64 2863 7572  tions.append(cur
-00016110: 7665 2e63 6f70 7928 2929 0d0a 0d0a 2020  ve.copy())....  
-00016120: 2020 7265 7475 726e 2073 6563 7469 6f6e    return section
-00016130: 732c 206e 616d 655f 7661 720d 0a0d 0a20  s, name_var.... 
-00016140: 2020 200d 0a23 2a20 3d3d 3d3d 3d3d 3d3d     ..#* ========
+00015aa0: 2020 5030 2c20 5031 2c20 5033 2c20 7769    P0, P1, P3, wi
+00015ab0: 7468 696e 5f62 6f75 6e64 733d 4661 6c73  thin_bounds=Fals
+00015ac0: 652c 206f 7269 6769 6e61 6c5f 6f72 6465  e, original_orde
+00015ad0: 723d 2861 7272 616e 6765 5f6d 6574 686f  r=(arrange_metho
+00015ae0: 643d 3d27 6a6f 696e 2729 290d 0a20 2020  d=='join'))..   
+00015af0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00015b00: 2020 2020 2020 2073 7572 6661 6365 5f76         surface_v
+00015b10: 6172 203d 205b 5d0d 0a20 2020 2020 2020  ar = []..       
+00015b20: 2020 2020 2066 6f72 2069 7620 696e 2069       for iv in i
+00015b30: 6e64 6578 5f76 6172 3a0d 0a20 2020 2020  ndex_var:..     
+00015b40: 2020 2020 2020 2020 2020 2073 7572 6661             surfa
+00015b50: 6365 5f76 6172 2e61 7070 656e 6428 6461  ce_var.append(da
+00015b60: 7461 5f5b 3a2c 3a2c 3a2c 6976 5d29 0d0a  ta_[:,:,:,iv])..
+00015b70: 2020 2020 2020 2020 2020 2020 7375 7266              surf
+00015b80: 6163 655f 7661 7220 3d20 6e70 2e74 7261  ace_var = np.tra
+00015b90: 6e73 706f 7365 286e 702e 6172 7261 7928  nspose(np.array(
+00015ba0: 7375 7266 6163 655f 7661 7229 2c20 5b31  surface_var), [1
+00015bb0: 2c32 2c33 2c30 5d29 2e73 7175 6565 7a65  ,2,3,0]).squeeze
+00015bc0: 2829 2020 2320 5b3a 2c3a 2c6e 765d 0d0a  ()  # [:,:,nv]..
+00015bd0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00015be0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+00015bf0: 2863 7572 7665 2920 3d3d 2030 3a0d 0a20  (curve) == 0:.. 
+00015c00: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00015c10: 6f6e 7469 6e75 650d 0a0d 0a20 2020 2020  ontinue....     
+00015c20: 2020 2020 2020 206e 6577 5f63 7572 7665         new_curve
+00015c30: 203d 205b 5d0d 0a20 2020 2020 2020 2020   = []..         
+00015c40: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00015c50: 6528 6c65 6e28 6375 7276 6529 293a 0d0a  e(len(curve)):..
+00015c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015c70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015c80: 2020 6969 2c20 6a6a 203d 2069 6a5f 6375    ii, jj = ij_cu
+00015c90: 7276 655b 695d 0d0a 2020 2020 2020 2020  rve[i]..        
+00015ca0: 2020 2020 2020 2020 6969 203d 206d 696e          ii = min
+00015cb0: 2873 7572 6661 6365 2e73 6861 7065 5b30  (surface.shape[0
+00015cc0: 5d2d 322c 2069 6929 0d0a 2020 2020 2020  ]-2, ii)..      
+00015cd0: 2020 2020 2020 2020 2020 6a6a 203d 206d            jj = m
+00015ce0: 696e 2873 7572 6661 6365 2e73 6861 7065  in(surface.shape
+00015cf0: 5b31 5d2d 322c 206a 6a29 0d0a 2020 2020  [1]-2, jj)..    
+00015d00: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00015d10: 2020 2020 2020 2020 2020 2020 2020 7873                xs
+00015d20: 203d 205b 7375 7266 6163 655b 6969 2c6a   = [surface[ii,j
+00015d30: 6a2c 3a5d 2c20 7375 7266 6163 655b 6969  j,:], surface[ii
+00015d40: 2b31 2c6a 6a2c 3a5d 2c20 7375 7266 6163  +1,jj,:], surfac
+00015d50: 655b 6969 2c6a 6a2b 312c 3a5d 2c20 7375  e[ii,jj+1,:], su
+00015d60: 7266 6163 655b 6969 2b31 2c6a 6a2b 312c  rface[ii+1,jj+1,
+00015d70: 3a5d 5d0d 0a20 2020 2020 2020 2020 2020  :]]..           
+00015d80: 2020 2020 2079 7320 3d20 5b73 7572 6661       ys = [surfa
+00015d90: 6365 5f76 6172 5b69 692c 6a6a 2c3a 5d2c  ce_var[ii,jj,:],
+00015da0: 2073 7572 6661 6365 5f76 6172 5b69 692b   surface_var[ii+
+00015db0: 312c 6a6a 2c3a 5d2c 2073 7572 6661 6365  1,jj,:], surface
+00015dc0: 5f76 6172 5b69 692c 6a6a 2b31 2c3a 5d2c  _var[ii,jj+1,:],
+00015dd0: 2073 7572 6661 6365 5f76 6172 5b69 692b   surface_var[ii+
+00015de0: 312c 6a6a 2b31 2c3a 5d5d 0d0a 2020 2020  1,jj+1,:]]..    
+00015df0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00015e00: 2020 2020 2020 2020 2020 2020 2020 7879                xy
+00015e10: 7a20 3d20 6375 7276 655b 695d 5b4e 6f6e  z = curve[i][Non
+00015e20: 652c 3a5d 0d0a 2020 2020 2020 2020 2020  e,:]..          
+00015e30: 2020 2020 2020 7661 7220 3d20 696e 7465        var = inte
+00015e40: 7270 6f6c 6174 655f 4944 5728 7879 7a2c  rpolate_IDW(xyz,
+00015e50: 206e 702e 6172 7261 7928 7873 292c 206e   np.array(xs), n
+00015e60: 702e 6172 7261 7928 7973 2929 0d0a 2020  p.array(ys))..  
+00015e70: 2020 2020 2020 2020 2020 2020 2020 746d                tm
+00015e80: 7020 3d20 6e70 2e63 6f6e 6361 7465 6e61  p = np.concatena
+00015e90: 7465 2828 7879 7a2c 2076 6172 292c 2061  te((xyz, var), a
+00015ea0: 7869 733d 3129 2e73 7175 6565 7a65 2829  xis=1).squeeze()
+00015eb0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00015ec0: 2020 2020 6e65 775f 6375 7276 652e 6170      new_curve.ap
+00015ed0: 7065 6e64 2874 6d70 290d 0a20 2020 2020  pend(tmp)..     
+00015ee0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00015ef0: 2020 2020 2069 6620 6172 7261 6e67 655f       if arrange_
+00015f00: 6d65 7468 6f64 203d 3d20 276a 6f69 6e27  method == 'join'
+00015f10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00015f20: 2020 2063 7572 7665 732e 6170 7065 6e64     curves.append
+00015f30: 286e 702e 6172 7261 7928 6e65 775f 6375  (np.array(new_cu
+00015f40: 7276 6529 290d 0a20 2020 2020 2020 2020  rve))..         
+00015f50: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00015f60: 2020 2020 2020 2020 2020 6375 7276 6573            curves
+00015f70: 202b 3d20 6e65 775f 6375 7276 650d 0a20   += new_curve.. 
+00015f80: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+00015f90: 695f 6375 7276 6573 202b 3d20 7869 5f63  i_curves += xi_c
+00015fa0: 7572 7665 2e74 6f6c 6973 7428 290d 0a20  urve.tolist().. 
+00015fb0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+00015fc0: 745f 6375 7276 6573 202b 3d20 7974 5f63  t_curves += yt_c
+00015fd0: 7572 7665 2e74 6f6c 6973 7428 290d 0a0d  urve.tolist()...
+00015fe0: 0a20 2020 2020 2020 2069 6620 6172 7261  .        if arra
+00015ff0: 6e67 655f 6d65 7468 6f64 203d 3d20 276a  nge_method == 'j
+00016000: 6f69 6e27 3a0d 0a20 2020 2020 2020 2020  oin':..         
+00016010: 2020 2063 7572 7665 203d 206a 6f69 6e5f     curve = join_
+00016020: 6375 7276 6573 2863 7572 7665 7329 0d0a  curves(curves)..
+00016030: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00016040: 2020 2020 2020 2020 2020 205f 2c20 6f6c             _, ol
+00016050: 645f 696e 6465 7820 3d20 7265 6172 7261  d_index = rearra
+00016060: 6e67 655f 706f 696e 7473 286e 702e 6172  nge_points(np.ar
+00016070: 7261 7928 7869 5f63 7572 7665 7329 2c20  ray(xi_curves), 
+00016080: 6e70 2e61 7272 6179 2879 745f 6375 7276  np.array(yt_curv
+00016090: 6573 292c 2061 7667 5f64 6972 3d6e 702e  es), avg_dir=np.
+000160a0: 6172 7261 7928 5b31 2e2c 302e 5d29 290d  array([1.,0.])).
+000160b0: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
+000160c0: 7665 203d 206e 702e 6172 7261 7928 5b63  ve = np.array([c
+000160d0: 7572 7665 735b 6969 5d20 666f 7220 6969  urves[ii] for ii
+000160e0: 2069 6e20 6f6c 645f 696e 6465 785d 290d   in old_index]).
+000160f0: 0a0d 0a20 2020 2020 2020 2073 6563 7469  ...        secti
+00016100: 6f6e 732e 6170 7065 6e64 2863 7572 7665  ons.append(curve
+00016110: 2e63 6f70 7928 2929 0d0a 0d0a 2020 2020  .copy())....    
+00016120: 7265 7475 726e 2073 6563 7469 6f6e 732c  return sections,
+00016130: 206e 616d 655f 7661 720d 0a0d 0a20 2020   name_var....   
+00016140: 200d 0a23 2a20 3d3d 3d3d 3d3d 3d3d 3d3d   ..#* ==========
 00016150: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00016160: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00016170: 3d3d 3d0d 0a23 2a20 492f 4f20 616e 6420  ===..#* I/O and 
-00016180: 666f 726d 6174 2074 7261 6e73 6665 720d  format transfer.
-00016190: 0a23 2a20 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  .#* ============
+00016170: 3d0d 0a23 2a20 492f 4f20 616e 6420 666f  =..#* I/O and fo
+00016180: 726d 6174 2074 7261 6e73 6665 720d 0a23  rmat transfer..#
+00016190: 2a20 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  * ==============
 000161a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000161b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
-000161c0: 0a0d 0a64 6566 206f 7574 7075 745f 6375  ...def output_cu
-000161d0: 7276 6528 783a 206e 702e 6e64 6172 7261  rve(x: np.ndarra
-000161e0: 792c 2079 3a20 6e70 2e6e 6461 7272 6179  y, y: np.ndarray
-000161f0: 2c20 666e 616d 653d 2763 7572 7665 2e64  , fname='curve.d
-00016200: 6174 272c 2049 443d 3029 202d 3e20 4e6f  at', ID=0) -> No
-00016210: 6e65 3a0d 0a20 2020 2027 2727 0d0a 2020  ne:..    '''..  
-00016220: 2020 4f75 7470 7574 2061 6972 666f 696c    Output airfoil
-00016230: 2064 6174 6120 746f 2074 6563 706c 6f74   data to tecplot
-00016240: 2041 5343 4949 2066 6f72 6d61 7420 6669   ASCII format fi
-00016250: 6c65 2e0d 0a0d 0a20 2020 2050 6172 616d  le.....    Param
-00016260: 6574 6572 730d 0a20 2020 202d 2d2d 2d2d  eters..    -----
-00016270: 2d2d 2d2d 2d2d 0d0a 2020 2020 782c 2079  ------..    x, y
-00016280: 203a 206e 6461 7272 6179 0d0a 2020 2020   : ndarray..    
-00016290: 2020 2020 636f 6f72 6469 6e61 7465 7320      coordinates 
-000162a0: 6f66 2074 6865 2063 7572 7665 2e0d 0a20  of the curve... 
-000162b0: 2020 2049 4420 3a20 696e 740d 0a20 2020     ID : int..   
-000162c0: 2020 2020 2069 6620 6049 4460 3d30 2c20       if `ID`=0, 
-000162d0: 6372 6561 7465 206e 6577 2066 696c 6520  create new file 
-000162e0: 616e 6420 7772 6974 6520 6865 6164 6572  and write header
-000162f0: 2e0d 0a20 2020 2020 2020 2049 6620 6049  ...        If `I
-00016300: 4460 3e30 2c20 6170 7065 6e64 2074 6f20  D`>0, append to 
-00016310: 6578 6973 7465 6420 6669 6c65 2e0d 0a20  existed file... 
-00016320: 2020 2027 2727 0d0a 2020 2020 6e6e 203d     '''..    nn =
-00016330: 2078 2e73 6861 7065 5b30 5d0d 0a0d 0a20   x.shape[0].... 
-00016340: 2020 2069 6620 4944 203d 3d20 303a 0d0a     if ID == 0:..
-00016350: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
-00016360: 6e28 666e 616d 652c 2027 7727 2920 6173  n(fname, 'w') as
-00016370: 2066 3a0d 0a20 2020 2020 2020 2020 2020   f:..           
-00016380: 2066 2e77 7269 7465 2827 5661 7269 6162   f.write('Variab
-00016390: 6c65 733d 2058 2020 5920 205c 6e20 2729  les= X  Y  \n ')
-000163a0: 0d0a 0d0a 2020 2020 7769 7468 206f 7065  ....    with ope
-000163b0: 6e28 666e 616d 652c 2027 6127 2920 6173  n(fname, 'a') as
-000163c0: 2066 3a0d 0a20 2020 2020 2020 2066 2e77   f:..        f.w
-000163d0: 7269 7465 2827 7a6f 6e65 2054 3d22 2564  rite('zone T="%d
-000163e0: 2220 693d 2025 6420 5c6e 2725 2849 442c  " i= %d \n'%(ID,
-000163f0: 206e 6e29 290d 0a20 2020 2020 2020 2066   nn))..        f
-00016400: 6f72 2069 2069 6e20 7261 6e67 6528 6e6e  or i in range(nn
-00016410: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00016420: 662e 7772 6974 6528 2720 2020 2532 302e  f.write('   %20.
-00016430: 3966 2020 2532 302e 3966 205c 6e27 2528  9f  %20.9f \n'%(
-00016440: 785b 695d 2c20 795b 695d 2929 0d0a 2020  x[i], y[i]))..  
-00016450: 2020 2020 2020 662e 7772 6974 6528 275c        f.write('\
-00016460: 6e27 290d 0a0d 0a64 6566 206f 7574 7075  n')....def outpu
-00016470: 745f 666f 696c 2878 3a20 6e70 2e6e 6461  t_foil(x: np.nda
-00016480: 7272 6179 2c20 7975 3a20 6e70 2e6e 6461  rray, yu: np.nda
-00016490: 7272 6179 2c20 796c 3a20 6e70 2e6e 6461  rray, yl: np.nda
-000164a0: 7272 6179 2c20 666e 616d 653d 2761 6972  rray, fname='air
-000164b0: 666f 696c 2e64 6174 272c 2049 443d 302c  foil.dat', ID=0,
-000164c0: 2069 6e66 6f3d 4661 6c73 6529 202d 3e20   info=False) -> 
-000164d0: 4e6f 6e65 3a0d 0a20 2020 2027 2727 0d0a  None:..    '''..
-000164e0: 2020 2020 4f75 7470 7574 2061 6972 666f      Output airfo
-000164f0: 696c 2064 6174 6120 746f 2074 6563 706c  il data to tecpl
-00016500: 6f74 2041 5343 4949 2066 6f72 6d61 7420  ot ASCII format 
-00016510: 6669 6c65 0d0a 0d0a 2020 2020 5061 7261  file....    Para
-00016520: 6d65 7465 7273 0d0a 2020 2020 2d2d 2d2d  meters..    ----
-00016530: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2078 2c20  -------..    x, 
-00016540: 7975 2c20 796c 203a 206e 6461 7272 6179  yu, yl : ndarray
-00016550: 0d0a 2020 2020 2020 2020 636f 6f72 6469  ..        coordi
-00016560: 6e61 7465 7320 6f66 2074 6865 2062 6173  nates of the bas
-00016570: 656c 696e 6520 6169 7266 6f69 6c2e 0d0a  eline airfoil...
-00016580: 2020 2020 4944 203a 2069 6e74 0d0a 2020      ID : int..  
-00016590: 2020 2020 2020 6966 2060 4944 603d 302c        if `ID`=0,
-000165a0: 2063 7265 6174 6520 6e65 7720 6669 6c65   create new file
-000165b0: 2061 6e64 2077 7269 7465 2068 6561 6465   and write heade
-000165c0: 722e 0d0a 2020 2020 2020 2020 4966 2060  r...        If `
-000165d0: 4944 603e 302c 2061 7070 656e 6420 746f  ID`>0, append to
-000165e0: 2065 7869 7374 6564 2066 696c 652e 0d0a   existed file...
-000165f0: 2020 2020 696e 666f 3a20 626f 6f6c 0d0a      info: bool..
-00016600: 2020 2020 2020 2020 6966 2054 7275 652c          if True,
-00016610: 2069 6e63 6c75 6465 2063 7572 7661 7475   include curvatu
-00016620: 7265 2c20 7468 6963 6b6e 6573 7320 616e  re, thickness an
-00016630: 6420 6361 6d62 6572 0d0a 2020 2020 2727  d camber..    ''
-00016640: 270d 0a20 2020 206e 6e20 3d20 782e 7368  '..    nn = x.sh
-00016650: 6170 655b 305d 0d0a 2020 2020 6375 7276  ape[0]..    curv
-00016660: 5f75 203d 206e 702e 7a65 726f 7328 6e6e  _u = np.zeros(nn
-00016670: 290d 0a20 2020 2063 7572 765f 6c20 3d20  )..    curv_l = 
-00016680: 6e70 2e7a 6572 6f73 286e 6e29 0d0a 2020  np.zeros(nn)..  
-00016690: 2020 6361 6d62 6572 203d 206e 702e 7a65    camber = np.ze
-000166a0: 726f 7328 6e6e 290d 0a20 2020 2074 6869  ros(nn)..    thi
-000166b0: 636b 6e65 7373 203d 206e 702e 7a65 726f  ckness = np.zero
-000166c0: 7328 6e6e 290d 0a20 2020 200d 0a20 2020  s(nn)..    ..   
-000166d0: 2069 6620 4944 203d 3d20 303a 0d0a 2020   if ID == 0:..  
-000166e0: 2020 2020 2020 2320 5772 6974 6520 6865        # Write he
-000166f0: 6164 6572 0d0a 2020 2020 2020 2020 7769  ader..        wi
-00016700: 7468 206f 7065 6e28 666e 616d 652c 2027  th open(fname, '
-00016710: 7727 2920 6173 2066 3a0d 0a20 2020 2020  w') as f:..     
-00016720: 2020 2020 2020 2069 6620 696e 666f 3a20         if info: 
-00016730: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016740: 2020 6c69 6e65 203d 2027 5661 7269 6162    line = 'Variab
-00016750: 6c65 733d 2058 2020 5920 2043 7572 7661  les= X  Y  Curva
-00016760: 7475 7265 2054 6869 636b 6e65 7373 2043  ture Thickness C
-00016770: 616d 6265 7220 5c6e 2027 0d0a 2020 2020  amber \n '..    
-00016780: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00016790: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-000167a0: 696e 6520 3d20 2756 6172 6961 626c 6573  ine = 'Variables
-000167b0: 3d20 5820 2059 2020 5c6e 2027 0d0a 2020  = X  Y  \n '..  
-000167c0: 2020 2020 2020 2020 2020 662e 7772 6974            f.writ
-000167d0: 6528 6c69 6e65 290d 0a0d 0a20 2020 2069  e(line)....    i
-000167e0: 6620 696e 666f 3a0d 0a20 2020 2020 2020  f info:..       
-000167f0: 200d 0a20 2020 2020 2020 2063 7572 765f   ..        curv_
-00016800: 7520 3d20 6375 7276 655f 6375 7276 6174  u = curve_curvat
-00016810: 7572 6528 782c 2079 7529 0d0a 2020 2020  ure(x, yu)..    
-00016820: 2020 2020 6375 7276 5f6c 203d 2063 7572      curv_l = cur
-00016830: 7665 5f63 7572 7661 7475 7265 2878 2c20  ve_curvature(x, 
-00016840: 796c 290d 0a0d 0a20 2020 2020 2020 2074  yl)....        t
-00016850: 6869 636b 6e65 7373 203d 2079 752d 796c  hickness = yu-yl
-00016860: 0d0a 2020 2020 2020 2020 6361 6d62 6572  ..        camber
-00016870: 203d 2030 2e35 2a28 7975 2b79 6c29 0d0a   = 0.5*(yu+yl)..
-00016880: 2020 2020 2020 2020 0d0a 2020 2020 7769          ..    wi
-00016890: 7468 206f 7065 6e28 666e 616d 652c 2027  th open(fname, '
-000168a0: 6127 2920 6173 2066 3a0d 0a20 2020 2020  a') as f:..     
-000168b0: 2020 2066 2e77 7269 7465 2827 7a6f 6e65     f.write('zone
-000168c0: 2054 3d22 5570 702d 2564 2220 693d 2025   T="Upp-%d" i= %
-000168d0: 6420 5c6e 2725 2849 442c 206e 6e29 290d  d \n'%(ID, nn)).
-000168e0: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-000168f0: 6e20 7261 6e67 6528 6e6e 293a 0d0a 2020  n range(nn):..  
-00016900: 2020 2020 2020 2020 2020 6c69 6e65 203d            line =
-00016910: 2027 2020 2025 3230 2e39 6620 2025 3230   '   %20.9f  %20
-00016920: 2e39 6627 2528 785b 695d 2c20 7975 5b69  .9f'%(x[i], yu[i
-00016930: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00016940: 6966 2069 6e66 6f3a 0d0a 2020 2020 2020  if info:..      
-00016950: 2020 2020 2020 2020 2020 6c69 6e65 203d            line =
-00016960: 206c 696e 6520 2b20 2720 2025 3230 2e39   line + '  %20.9
-00016970: 6620 2025 3230 2e39 6620 2025 3230 2e39  f  %20.9f  %20.9
-00016980: 6627 2528 6375 7276 5f75 5b69 5d2c 2074  f'%(curv_u[i], t
-00016990: 6869 636b 6e65 7373 5b69 5d2c 2063 616d  hickness[i], cam
-000169a0: 6265 725b 695d 290d 0a20 2020 2020 2020  ber[i])..       
-000169b0: 2020 2020 2066 2e77 7269 7465 286c 696e       f.write(lin
-000169c0: 652b 275c 6e27 290d 0a20 2020 2020 2020  e+'\n')..       
-000169d0: 2020 2020 200d 0a20 2020 2020 2020 2066       ..        f
-000169e0: 2e77 7269 7465 2827 7a6f 6e65 2054 3d22  .write('zone T="
-000169f0: 4c6f 772d 2564 2220 693d 2025 6420 5c6e  Low-%d" i= %d \n
-00016a00: 2725 2849 442c 206e 6e29 290d 0a20 2020  '%(ID, nn))..   
-00016a10: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00016a20: 6e67 6528 6e6e 293a 0d0a 2020 2020 2020  nge(nn):..      
-00016a30: 2020 2020 2020 6c69 6e65 203d 2027 2020        line = '  
-00016a40: 2025 3230 2e39 6620 2025 3230 2e39 6627   %20.9f  %20.9f'
-00016a50: 2528 785b 695d 2c20 796c 5b69 5d29 0d0a  %(x[i], yl[i])..
-00016a60: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00016a70: 6e66 6f3a 0d0a 2020 2020 2020 2020 2020  nfo:..          
-00016a80: 2020 2020 2020 6c69 6e65 203d 206c 696e        line = lin
-00016a90: 6520 2b20 2720 2025 3230 2e39 6620 2025  e + '  %20.9f  %
-00016aa0: 3230 2e39 6620 2025 3230 2e39 6627 2528  20.9f  %20.9f'%(
-00016ab0: 6375 7276 5f6c 5b69 5d2c 2074 6869 636b  curv_l[i], thick
-00016ac0: 6e65 7373 5b69 5d2c 2063 616d 6265 725b  ness[i], camber[
-00016ad0: 695d 290d 0a20 2020 2020 2020 2020 2020  i])..           
-00016ae0: 2066 2e77 7269 7465 286c 696e 652b 275c   f.write(line+'\
-00016af0: 6e27 290d 0a0d 0a64 6566 2072 6561 645f  n')....def read_
-00016b00: 6375 7276 6573 2866 6e61 6d65 3d27 6375  curves(fname='cu
-00016b10: 7276 652e 6461 7427 293a 0d0a 2020 2020  rve.dat'):..    
-00016b20: 2727 270d 0a20 2020 2052 6561 6420 6375  '''..    Read cu
-00016b30: 7276 6573 2066 726f 6d20 6120 7465 6370  rves from a tecp
-00016b40: 6c6f 7420 666f 726d 6174 2066 696c 652e  lot format file.
-00016b50: 0d0a 2020 2020 0d0a 2020 2020 5061 7261  ..    ..    Para
-00016b60: 6d65 7465 7273 0d0a 2020 2020 2d2d 2d2d  meters..    ----
-00016b70: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 666e  --------..    fn
-00016b80: 616d 6520 3a20 7374 720d 0a20 2020 2020  ame : str..     
-00016b90: 2020 2066 696c 6520 6e61 6d65 2e0d 0a20     file name... 
-00016ba0: 2020 200d 0a20 2020 2052 6574 7572 6e73     ..    Returns
-00016bb0: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
-00016bc0: 2d0d 0a20 2020 2078 732c 2079 7320 3a20  -..    xs, ys : 
-00016bd0: 6c69 7374 206f 6620 6c69 7374 206f 6620  list of list of 
-00016be0: 666c 6f61 740d 0a20 2020 2020 2020 2063  float..        c
-00016bf0: 6f6f 7264 696e 6174 6573 206f 6620 6d75  oordinates of mu
-00016c00: 6c74 6970 6c65 2063 7572 7665 730d 0a0d  ltiple curves...
-00016c10: 0a20 2020 2045 7861 6d70 6c65 730d 0a20  .    Examples.. 
-00016c20: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a     -----------..
-00016c30: 2020 2020 3e3e 3e20 7873 2c20 7973 203d      >>> xs, ys =
-00016c40: 2072 6561 645f 6375 7276 6573 2866 6e61   read_curves(fna
-00016c50: 6d65 3d27 6375 7276 652e 6461 7427 290d  me='curve.dat').
-00016c60: 0a0d 0a20 2020 2027 2727 0d0a 0d0a 2020  ...    '''....  
-00016c70: 2020 7873 203d 205b 5d0d 0a20 2020 2079    xs = []..    y
-00016c80: 7320 3d20 5b5d 0d0a 2020 2020 7769 7468  s = []..    with
-00016c90: 206f 7065 6e28 666e 616d 652c 2027 7227   open(fname, 'r'
-00016ca0: 2920 6173 2066 3a0d 0a20 2020 2020 2020  ) as f:..       
-00016cb0: 206c 696e 6573 203d 2066 2e72 6561 646c   lines = f.readl
-00016cc0: 696e 6573 2829 0d0a 0d0a 2020 2020 2020  ines()....      
-00016cd0: 2020 666f 7220 6c69 6e65 2069 6e20 6c69    for line in li
-00016ce0: 6e65 733a 0d0a 0d0a 2020 2020 2020 2020  nes:....        
-00016cf0: 2020 2020 6c69 6e65 203d 206c 696e 652e      line = line.
-00016d00: 7370 6c69 7428 290d 0a20 2020 2020 2020  split()..       
-00016d10: 2020 2020 2069 6620 6c65 6e28 6c69 6e65       if len(line
-00016d20: 293c 3d31 3a0d 0a20 2020 2020 2020 2020  )<=1:..         
-00016d30: 2020 2020 2020 2063 6f6e 7469 6e75 650d         continue.
-00016d40: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
-00016d50: 6620 6c69 6e65 5b30 5d20 696e 2027 7a6f  f line[0] in 'zo
-00016d60: 6e65 273a 0d0a 2020 2020 2020 2020 2020  ne':..          
-00016d70: 2020 2020 2020 7873 2e61 7070 656e 6428        xs.append(
-00016d80: 5b5d 290d 0a20 2020 2020 2020 2020 2020  [])..           
-00016d90: 2020 2020 2079 732e 6170 7065 6e64 285b       ys.append([
-00016da0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00016db0: 2020 2020 636f 6e74 696e 7565 0d0a 0d0a      continue....
-00016dc0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00016dd0: 656e 286c 696e 6529 213d 323a 0d0a 2020  en(line)!=2:..  
-00016de0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00016df0: 6e74 696e 7565 2020 2020 2020 2020 2020  ntinue          
-00016e00: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00016e10: 0d0a 2020 2020 2020 2020 2020 2020 7873  ..            xs
-00016e20: 5b2d 315d 2e61 7070 656e 6428 666c 6f61  [-1].append(floa
-00016e30: 7428 6c69 6e65 5b30 5d29 290d 0a20 2020  t(line[0]))..   
-00016e40: 2020 2020 2020 2020 2079 735b 2d31 5d2e           ys[-1].
-00016e50: 6170 7065 6e64 2866 6c6f 6174 286c 696e  append(float(lin
-00016e60: 655b 315d 2929 0d0a 0d0a 2020 2020 7265  e[1]))....    re
-00016e70: 7475 726e 2078 732c 2079 730d 0a0d 0a64  turn xs, ys....d
-00016e80: 6566 2072 6561 645f 7465 6370 6c6f 7428  ef read_tecplot(
-00016e90: 666e 616d 653d 2774 6563 706c 6f74 2e64  fname='tecplot.d
-00016ea0: 6174 2729 3a0d 0a20 2020 2027 2727 0d0a  at'):..    '''..
-00016eb0: 2020 2020 5265 6164 2061 2074 6563 706c      Read a tecpl
-00016ec0: 6f74 2066 6f72 6d61 7420 6461 7461 2066  ot format data f
-00016ed0: 696c 652e 0d0a 2020 2020 0d0a 2020 2020  ile...    ..    
-00016ee0: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
-00016ef0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-00016f00: 2020 666e 616d 6520 3a20 7374 720d 0a20    fname : str.. 
-00016f10: 2020 2020 2020 2066 696c 6520 6e61 6d65         file name
-00016f20: 2e0d 0a20 2020 200d 0a20 2020 2052 6574  ...    ..    Ret
-00016f30: 7572 6e73 0d0a 2020 2020 2d2d 2d2d 2d2d  urns..    ------
-00016f40: 2d2d 2d2d 2d0d 0a20 2020 2064 6174 6120  -----..    data 
-00016f50: 3a20 6c69 7374 206f 6620 6e64 6172 7261  : list of ndarra
-00016f60: 790d 0a20 2020 2020 2020 2064 6174 6120  y..        data 
-00016f70: 6f66 2061 6c6c 207a 6f6e 6573 2c20 7368  of all zones, sh
-00016f80: 6170 6520 5b6e 692c 6e6a 2c6e 6b2c 6e76  ape [ni,nj,nk,nv
-00016f90: 5d2e 200d 0a20 2020 206e 616d 655f 7661  ]. ..    name_va
-00016fa0: 7220 3a20 6c69 7374 206f 6620 7374 720d  r : list of str.
-00016fb0: 0a20 2020 2020 2020 206e 616d 6520 6f66  .        name of
-00016fc0: 2076 6172 6961 626c 6573 2e0d 0a20 2020   variables...   
-00016fd0: 2074 6974 6c65 7320 3a20 6c69 7374 206f   titles : list o
-00016fe0: 6620 7374 720d 0a20 2020 2020 2020 2074  f str..        t
-00016ff0: 6974 6c65 206f 6620 7a6f 6e65 730d 0a20  itle of zones.. 
-00017000: 2020 200d 0a20 2020 2045 7861 6d70 6c65     ..    Example
-00017010: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
-00017020: 2d2d 2d2d 0d0a 2020 2020 3e3e 3e20 6461  ----..    >>> da
-00017030: 7461 2c20 6e61 6d65 5f76 6172 2c20 7469  ta, name_var, ti
-00017040: 746c 6573 203d 2072 6561 645f 7465 6370  tles = read_tecp
-00017050: 6c6f 7428 666e 616d 653d 2774 6563 706c  lot(fname='tecpl
-00017060: 6f74 2e64 6174 2729 0d0a 2020 2020 0d0a  ot.dat')..    ..
-00017070: 0d0a 2020 2020 2727 270d 0a20 2020 206e  ..    '''..    n
-00017080: 616d 655f 7661 7220 3d20 5b5d 0d0a 2020  ame_var = []..  
-00017090: 2020 6461 7461 203d 205b 5d0d 0a20 2020    data = []..   
-000170a0: 2074 6974 6c65 7320 3d20 5b5d 0d0a 2020   titles = []..  
-000170b0: 2020 6e5f 7661 7220 3d20 300d 0a20 2020    n_var = 0..   
-000170c0: 200d 0a20 2020 2077 6974 6820 6f70 656e   ..    with open
-000170d0: 2866 6e61 6d65 2c20 2772 2729 2061 7320  (fname, 'r') as 
-000170e0: 663a 0d0a 2020 2020 2020 2020 0d0a 2020  f:..        ..  
-000170f0: 2020 2020 2020 6c69 6e65 7320 3d20 662e        lines = f.
-00017100: 7265 6164 6c69 6e65 7328 290d 0a20 2020  readlines()..   
-00017110: 2020 2020 206e 4c69 6e65 203d 206c 656e       nLine = len
-00017120: 286c 696e 6573 290d 0a20 2020 2020 2020  (lines)..       
-00017130: 2069 4c69 6e65 203d 2030 0d0a 2020 2020   iLine = 0..    
-00017140: 0d0a 2020 2020 2020 2020 7768 696c 6520  ..        while 
-00017150: 694c 696e 6520 3c20 6e4c 696e 653a 0d0a  iLine < nLine:..
-00017160: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00017170: 2020 2020 2020 2020 2020 6c69 6e65 203d            line =
-00017180: 206c 696e 6573 5b69 4c69 6e65 5d2e 7370   lines[iLine].sp
-00017190: 6c69 7428 290d 0a20 2020 2020 2020 2020  lit()..         
-000171a0: 2020 2069 6620 6c65 6e28 6c69 6e65 2920     if len(line) 
-000171b0: 3d3d 2030 3a0d 0a20 2020 2020 2020 2020  == 0:..         
-000171c0: 2020 2020 2020 2069 4c69 6e65 202b 3d20         iLine += 
-000171d0: 310d 0a20 2020 2020 2020 2020 2020 2020  1..             
-000171e0: 2020 2063 6f6e 7469 6e75 650d 0a20 2020     continue..   
-000171f0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00017200: 2020 2020 2020 2069 6620 6c69 6e65 5b30         if line[0
-00017210: 5d20 696e 2027 5661 7269 6162 6c65 733d  ] in 'Variables=
-00017220: 2720 6f72 206c 696e 655b 305d 2069 6e20  ' or line[0] in 
-00017230: 2756 4152 4941 424c 4553 3d27 203a 0d0a  'VARIABLES=' :..
-00017240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017250: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00017260: 2020 6c69 6e65 203d 2072 652e 7370 6c69    line = re.spli
-00017270: 7428 7227 5b3d 222c 5c73 5d27 2c20 6c69  t(r'[=",\s]', li
-00017280: 6e65 735b 694c 696e 655d 290d 0a20 2020  nes[iLine])..   
-00017290: 2020 2020 2020 2020 2020 2020 2077 6869               whi
-000172a0: 6c65 2027 2720 696e 206c 696e 653a 0d0a  le '' in line:..
+000161b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d  =============...
+000161c0: 0a64 6566 206f 7574 7075 745f 6375 7276  .def output_curv
+000161d0: 6528 783a 206e 702e 6e64 6172 7261 792c  e(x: np.ndarray,
+000161e0: 2079 3a20 6e70 2e6e 6461 7272 6179 2c20   y: np.ndarray, 
+000161f0: 666e 616d 653d 2763 7572 7665 2e64 6174  fname='curve.dat
+00016200: 272c 2049 443d 3029 202d 3e20 4e6f 6e65  ', ID=0) -> None
+00016210: 3a0d 0a20 2020 2027 2727 0d0a 2020 2020  :..    '''..    
+00016220: 4f75 7470 7574 2061 6972 666f 696c 2064  Output airfoil d
+00016230: 6174 6120 746f 2074 6563 706c 6f74 2041  ata to tecplot A
+00016240: 5343 4949 2066 6f72 6d61 7420 6669 6c65  SCII format file
+00016250: 2e0d 0a0d 0a20 2020 2050 6172 616d 6574  .....    Paramet
+00016260: 6572 730d 0a20 2020 202d 2d2d 2d2d 2d2d  ers..    -------
+00016270: 2d2d 2d2d 0d0a 2020 2020 782c 2079 203a  ----..    x, y :
+00016280: 206e 6461 7272 6179 0d0a 2020 2020 2020   ndarray..      
+00016290: 2020 636f 6f72 6469 6e61 7465 7320 6f66    coordinates of
+000162a0: 2074 6865 2063 7572 7665 2e0d 0a20 2020   the curve...   
+000162b0: 2049 4420 3a20 696e 740d 0a20 2020 2020   ID : int..     
+000162c0: 2020 2069 6620 6049 4460 3d30 2c20 6372     if `ID`=0, cr
+000162d0: 6561 7465 206e 6577 2066 696c 6520 616e  eate new file an
+000162e0: 6420 7772 6974 6520 6865 6164 6572 2e0d  d write header..
+000162f0: 0a20 2020 2020 2020 2049 6620 6049 4460  .        If `ID`
+00016300: 3e30 2c20 6170 7065 6e64 2074 6f20 6578  >0, append to ex
+00016310: 6973 7465 6420 6669 6c65 2e0d 0a20 2020  isted file...   
+00016320: 2027 2727 0d0a 2020 2020 6e6e 203d 2078   '''..    nn = x
+00016330: 2e73 6861 7065 5b30 5d0d 0a0d 0a20 2020  .shape[0]....   
+00016340: 2069 6620 4944 203d 3d20 303a 0d0a 2020   if ID == 0:..  
+00016350: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
+00016360: 666e 616d 652c 2027 7727 2920 6173 2066  fname, 'w') as f
+00016370: 3a0d 0a20 2020 2020 2020 2020 2020 2066  :..            f
+00016380: 2e77 7269 7465 2827 5661 7269 6162 6c65  .write('Variable
+00016390: 733d 2058 2020 5920 205c 6e20 2729 0d0a  s= X  Y  \n ')..
+000163a0: 0d0a 2020 2020 7769 7468 206f 7065 6e28  ..    with open(
+000163b0: 666e 616d 652c 2027 6127 2920 6173 2066  fname, 'a') as f
+000163c0: 3a0d 0a20 2020 2020 2020 2066 2e77 7269  :..        f.wri
+000163d0: 7465 2827 7a6f 6e65 2054 3d22 2564 2220  te('zone T="%d" 
+000163e0: 693d 2025 6420 5c6e 2725 2849 442c 206e  i= %d \n'%(ID, n
+000163f0: 6e29 290d 0a20 2020 2020 2020 2066 6f72  n))..        for
+00016400: 2069 2069 6e20 7261 6e67 6528 6e6e 293a   i in range(nn):
+00016410: 0d0a 2020 2020 2020 2020 2020 2020 662e  ..            f.
+00016420: 7772 6974 6528 2720 2020 2532 302e 3966  write('   %20.9f
+00016430: 2020 2532 302e 3966 205c 6e27 2528 785b    %20.9f \n'%(x[
+00016440: 695d 2c20 795b 695d 2929 0d0a 2020 2020  i], y[i]))..    
+00016450: 2020 2020 662e 7772 6974 6528 275c 6e27      f.write('\n'
+00016460: 290d 0a0d 0a64 6566 206f 7574 7075 745f  )....def output_
+00016470: 666f 696c 2878 3a20 6e70 2e6e 6461 7272  foil(x: np.ndarr
+00016480: 6179 2c20 7975 3a20 6e70 2e6e 6461 7272  ay, yu: np.ndarr
+00016490: 6179 2c20 796c 3a20 6e70 2e6e 6461 7272  ay, yl: np.ndarr
+000164a0: 6179 2c20 666e 616d 653d 2761 6972 666f  ay, fname='airfo
+000164b0: 696c 2e64 6174 272c 2049 443d 302c 2069  il.dat', ID=0, i
+000164c0: 6e66 6f3d 4661 6c73 6529 202d 3e20 4e6f  nfo=False) -> No
+000164d0: 6e65 3a0d 0a20 2020 2027 2727 0d0a 2020  ne:..    '''..  
+000164e0: 2020 4f75 7470 7574 2061 6972 666f 696c    Output airfoil
+000164f0: 2064 6174 6120 746f 2074 6563 706c 6f74   data to tecplot
+00016500: 2041 5343 4949 2066 6f72 6d61 7420 6669   ASCII format fi
+00016510: 6c65 0d0a 0d0a 2020 2020 5061 7261 6d65  le....    Parame
+00016520: 7465 7273 0d0a 2020 2020 2d2d 2d2d 2d2d  ters..    ------
+00016530: 2d2d 2d2d 2d0d 0a20 2020 2078 2c20 7975  -----..    x, yu
+00016540: 2c20 796c 203a 206e 6461 7272 6179 0d0a  , yl : ndarray..
+00016550: 2020 2020 2020 2020 636f 6f72 6469 6e61          coordina
+00016560: 7465 7320 6f66 2074 6865 2062 6173 656c  tes of the basel
+00016570: 696e 6520 6169 7266 6f69 6c2e 0d0a 2020  ine airfoil...  
+00016580: 2020 4944 203a 2069 6e74 0d0a 2020 2020    ID : int..    
+00016590: 2020 2020 6966 2060 4944 603d 302c 2063      if `ID`=0, c
+000165a0: 7265 6174 6520 6e65 7720 6669 6c65 2061  reate new file a
+000165b0: 6e64 2077 7269 7465 2068 6561 6465 722e  nd write header.
+000165c0: 0d0a 2020 2020 2020 2020 4966 2060 4944  ..        If `ID
+000165d0: 603e 302c 2061 7070 656e 6420 746f 2065  `>0, append to e
+000165e0: 7869 7374 6564 2066 696c 652e 0d0a 2020  xisted file...  
+000165f0: 2020 696e 666f 3a20 626f 6f6c 0d0a 2020    info: bool..  
+00016600: 2020 2020 2020 6966 2054 7275 652c 2069        if True, i
+00016610: 6e63 6c75 6465 2063 7572 7661 7475 7265  nclude curvature
+00016620: 2c20 7468 6963 6b6e 6573 7320 616e 6420  , thickness and 
+00016630: 6361 6d62 6572 0d0a 2020 2020 2727 270d  camber..    '''.
+00016640: 0a20 2020 206e 6e20 3d20 782e 7368 6170  .    nn = x.shap
+00016650: 655b 305d 0d0a 2020 2020 6375 7276 5f75  e[0]..    curv_u
+00016660: 203d 206e 702e 7a65 726f 7328 6e6e 290d   = np.zeros(nn).
+00016670: 0a20 2020 2063 7572 765f 6c20 3d20 6e70  .    curv_l = np
+00016680: 2e7a 6572 6f73 286e 6e29 0d0a 2020 2020  .zeros(nn)..    
+00016690: 6361 6d62 6572 203d 206e 702e 7a65 726f  camber = np.zero
+000166a0: 7328 6e6e 290d 0a20 2020 2074 6869 636b  s(nn)..    thick
+000166b0: 6e65 7373 203d 206e 702e 7a65 726f 7328  ness = np.zeros(
+000166c0: 6e6e 290d 0a20 2020 200d 0a20 2020 2069  nn)..    ..    i
+000166d0: 6620 4944 203d 3d20 303a 0d0a 2020 2020  f ID == 0:..    
+000166e0: 2020 2020 2320 5772 6974 6520 6865 6164      # Write head
+000166f0: 6572 0d0a 2020 2020 2020 2020 7769 7468  er..        with
+00016700: 206f 7065 6e28 666e 616d 652c 2027 7727   open(fname, 'w'
+00016710: 2920 6173 2066 3a0d 0a20 2020 2020 2020  ) as f:..       
+00016720: 2020 2020 2069 6620 696e 666f 3a20 0d0a       if info: ..
+00016730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016740: 6c69 6e65 203d 2027 5661 7269 6162 6c65  line = 'Variable
+00016750: 733d 2058 2020 5920 2043 7572 7661 7475  s= X  Y  Curvatu
+00016760: 7265 2054 6869 636b 6e65 7373 2043 616d  re Thickness Cam
+00016770: 6265 7220 5c6e 2027 0d0a 2020 2020 2020  ber \n '..      
+00016780: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00016790: 2020 2020 2020 2020 2020 2020 206c 696e               lin
+000167a0: 6520 3d20 2756 6172 6961 626c 6573 3d20  e = 'Variables= 
+000167b0: 5820 2059 2020 5c6e 2027 0d0a 2020 2020  X  Y  \n '..    
+000167c0: 2020 2020 2020 2020 662e 7772 6974 6528          f.write(
+000167d0: 6c69 6e65 290d 0a0d 0a20 2020 2069 6620  line)....    if 
+000167e0: 696e 666f 3a0d 0a20 2020 2020 2020 200d  info:..        .
+000167f0: 0a20 2020 2020 2020 2063 7572 765f 7520  .        curv_u 
+00016800: 3d20 6375 7276 655f 6375 7276 6174 7572  = curve_curvatur
+00016810: 6528 782c 2079 7529 0d0a 2020 2020 2020  e(x, yu)..      
+00016820: 2020 6375 7276 5f6c 203d 2063 7572 7665    curv_l = curve
+00016830: 5f63 7572 7661 7475 7265 2878 2c20 796c  _curvature(x, yl
+00016840: 290d 0a0d 0a20 2020 2020 2020 2074 6869  )....        thi
+00016850: 636b 6e65 7373 203d 2079 752d 796c 0d0a  ckness = yu-yl..
+00016860: 2020 2020 2020 2020 6361 6d62 6572 203d          camber =
+00016870: 2030 2e35 2a28 7975 2b79 6c29 0d0a 2020   0.5*(yu+yl)..  
+00016880: 2020 2020 2020 0d0a 2020 2020 7769 7468        ..    with
+00016890: 206f 7065 6e28 666e 616d 652c 2027 6127   open(fname, 'a'
+000168a0: 2920 6173 2066 3a0d 0a20 2020 2020 2020  ) as f:..       
+000168b0: 2066 2e77 7269 7465 2827 7a6f 6e65 2054   f.write('zone T
+000168c0: 3d22 5570 702d 2564 2220 693d 2025 6420  ="Upp-%d" i= %d 
+000168d0: 5c6e 2725 2849 442c 206e 6e29 290d 0a20  \n'%(ID, nn)).. 
+000168e0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+000168f0: 7261 6e67 6528 6e6e 293a 0d0a 2020 2020  range(nn):..    
+00016900: 2020 2020 2020 2020 6c69 6e65 203d 2027          line = '
+00016910: 2020 2025 3230 2e39 6620 2025 3230 2e39     %20.9f  %20.9
+00016920: 6627 2528 785b 695d 2c20 7975 5b69 5d29  f'%(x[i], yu[i])
+00016930: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00016940: 2069 6e66 6f3a 0d0a 2020 2020 2020 2020   info:..        
+00016950: 2020 2020 2020 2020 6c69 6e65 203d 206c          line = l
+00016960: 696e 6520 2b20 2720 2025 3230 2e39 6620  ine + '  %20.9f 
+00016970: 2025 3230 2e39 6620 2025 3230 2e39 6627   %20.9f  %20.9f'
+00016980: 2528 6375 7276 5f75 5b69 5d2c 2074 6869  %(curv_u[i], thi
+00016990: 636b 6e65 7373 5b69 5d2c 2063 616d 6265  ckness[i], cambe
+000169a0: 725b 695d 290d 0a20 2020 2020 2020 2020  r[i])..         
+000169b0: 2020 2066 2e77 7269 7465 286c 696e 652b     f.write(line+
+000169c0: 275c 6e27 290d 0a20 2020 2020 2020 2020  '\n')..         
+000169d0: 2020 200d 0a20 2020 2020 2020 2066 2e77     ..        f.w
+000169e0: 7269 7465 2827 7a6f 6e65 2054 3d22 4c6f  rite('zone T="Lo
+000169f0: 772d 2564 2220 693d 2025 6420 5c6e 2725  w-%d" i= %d \n'%
+00016a00: 2849 442c 206e 6e29 290d 0a20 2020 2020  (ID, nn))..     
+00016a10: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00016a20: 6528 6e6e 293a 0d0a 2020 2020 2020 2020  e(nn):..        
+00016a30: 2020 2020 6c69 6e65 203d 2027 2020 2025      line = '   %
+00016a40: 3230 2e39 6620 2025 3230 2e39 6627 2528  20.9f  %20.9f'%(
+00016a50: 785b 695d 2c20 796c 5b69 5d29 0d0a 2020  x[i], yl[i])..  
+00016a60: 2020 2020 2020 2020 2020 6966 2069 6e66            if inf
+00016a70: 6f3a 0d0a 2020 2020 2020 2020 2020 2020  o:..            
+00016a80: 2020 2020 6c69 6e65 203d 206c 696e 6520      line = line 
+00016a90: 2b20 2720 2025 3230 2e39 6620 2025 3230  + '  %20.9f  %20
+00016aa0: 2e39 6620 2025 3230 2e39 6627 2528 6375  .9f  %20.9f'%(cu
+00016ab0: 7276 5f6c 5b69 5d2c 2074 6869 636b 6e65  rv_l[i], thickne
+00016ac0: 7373 5b69 5d2c 2063 616d 6265 725b 695d  ss[i], camber[i]
+00016ad0: 290d 0a20 2020 2020 2020 2020 2020 2066  )..            f
+00016ae0: 2e77 7269 7465 286c 696e 652b 275c 6e27  .write(line+'\n'
+00016af0: 290d 0a0d 0a64 6566 2072 6561 645f 6375  )....def read_cu
+00016b00: 7276 6573 2866 6e61 6d65 3d27 6375 7276  rves(fname='curv
+00016b10: 652e 6461 7427 293a 0d0a 2020 2020 2727  e.dat'):..    ''
+00016b20: 270d 0a20 2020 2052 6561 6420 6375 7276  '..    Read curv
+00016b30: 6573 2066 726f 6d20 6120 7465 6370 6c6f  es from a tecplo
+00016b40: 7420 666f 726d 6174 2066 696c 652e 0d0a  t format file...
+00016b50: 2020 2020 0d0a 2020 2020 5061 7261 6d65      ..    Parame
+00016b60: 7465 7273 0d0a 2020 2020 2d2d 2d2d 2d2d  ters..    ------
+00016b70: 2d2d 2d2d 2d2d 0d0a 2020 2020 666e 616d  ------..    fnam
+00016b80: 6520 3a20 7374 720d 0a20 2020 2020 2020  e : str..       
+00016b90: 2066 696c 6520 6e61 6d65 2e0d 0a20 2020   file name...   
+00016ba0: 200d 0a20 2020 2052 6574 7572 6e73 0d0a   ..    Returns..
+00016bb0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d      -----------.
+00016bc0: 0a20 2020 2078 732c 2079 7320 3a20 6c69  .    xs, ys : li
+00016bd0: 7374 206f 6620 6c69 7374 206f 6620 666c  st of list of fl
+00016be0: 6f61 740d 0a20 2020 2020 2020 2063 6f6f  oat..        coo
+00016bf0: 7264 696e 6174 6573 206f 6620 6d75 6c74  rdinates of mult
+00016c00: 6970 6c65 2063 7572 7665 730d 0a0d 0a20  iple curves.... 
+00016c10: 2020 2045 7861 6d70 6c65 730d 0a20 2020     Examples..   
+00016c20: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020   -----------..  
+00016c30: 2020 3e3e 3e20 7873 2c20 7973 203d 2072    >>> xs, ys = r
+00016c40: 6561 645f 6375 7276 6573 2866 6e61 6d65  ead_curves(fname
+00016c50: 3d27 6375 7276 652e 6461 7427 290d 0a0d  ='curve.dat')...
+00016c60: 0a20 2020 2027 2727 0d0a 0d0a 2020 2020  .    '''....    
+00016c70: 7873 203d 205b 5d0d 0a20 2020 2079 7320  xs = []..    ys 
+00016c80: 3d20 5b5d 0d0a 2020 2020 7769 7468 206f  = []..    with o
+00016c90: 7065 6e28 666e 616d 652c 2027 7227 2920  pen(fname, 'r') 
+00016ca0: 6173 2066 3a0d 0a20 2020 2020 2020 206c  as f:..        l
+00016cb0: 696e 6573 203d 2066 2e72 6561 646c 696e  ines = f.readlin
+00016cc0: 6573 2829 0d0a 0d0a 2020 2020 2020 2020  es()....        
+00016cd0: 666f 7220 6c69 6e65 2069 6e20 6c69 6e65  for line in line
+00016ce0: 733a 0d0a 0d0a 2020 2020 2020 2020 2020  s:....          
+00016cf0: 2020 6c69 6e65 203d 206c 696e 652e 7370    line = line.sp
+00016d00: 6c69 7428 290d 0a20 2020 2020 2020 2020  lit()..         
+00016d10: 2020 2069 6620 6c65 6e28 6c69 6e65 293c     if len(line)<
+00016d20: 3d31 3a0d 0a20 2020 2020 2020 2020 2020  =1:..           
+00016d30: 2020 2020 2063 6f6e 7469 6e75 650d 0a0d       continue...
+00016d40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00016d50: 6c69 6e65 5b30 5d20 696e 2027 7a6f 6e65  line[0] in 'zone
+00016d60: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+00016d70: 2020 2020 7873 2e61 7070 656e 6428 5b5d      xs.append([]
+00016d80: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00016d90: 2020 2079 732e 6170 7065 6e64 285b 5d29     ys.append([])
+00016da0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00016db0: 2020 636f 6e74 696e 7565 0d0a 0d0a 2020    continue....  
+00016dc0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+00016dd0: 286c 696e 6529 213d 323a 0d0a 2020 2020  (line)!=2:..    
+00016de0: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+00016df0: 696e 7565 2020 2020 2020 2020 2020 2020  inue            
+00016e00: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+00016e10: 2020 2020 2020 2020 2020 2020 7873 5b2d              xs[-
+00016e20: 315d 2e61 7070 656e 6428 666c 6f61 7428  1].append(float(
+00016e30: 6c69 6e65 5b30 5d29 290d 0a20 2020 2020  line[0]))..     
+00016e40: 2020 2020 2020 2079 735b 2d31 5d2e 6170         ys[-1].ap
+00016e50: 7065 6e64 2866 6c6f 6174 286c 696e 655b  pend(float(line[
+00016e60: 315d 2929 0d0a 0d0a 2020 2020 7265 7475  1]))....    retu
+00016e70: 726e 2078 732c 2079 730d 0a0d 0a64 6566  rn xs, ys....def
+00016e80: 2072 6561 645f 7465 6370 6c6f 7428 666e   read_tecplot(fn
+00016e90: 616d 653d 2774 6563 706c 6f74 2e64 6174  ame='tecplot.dat
+00016ea0: 2729 3a0d 0a20 2020 2027 2727 0d0a 2020  '):..    '''..  
+00016eb0: 2020 5265 6164 2061 2074 6563 706c 6f74    Read a tecplot
+00016ec0: 2066 6f72 6d61 7420 6461 7461 2066 696c   format data fil
+00016ed0: 652e 0d0a 2020 2020 0d0a 2020 2020 5061  e...    ..    Pa
+00016ee0: 7261 6d65 7465 7273 0d0a 2020 2020 2d2d  rameters..    --
+00016ef0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00016f00: 666e 616d 6520 3a20 7374 720d 0a20 2020  fname : str..   
+00016f10: 2020 2020 2066 696c 6520 6e61 6d65 2e0d       file name..
+00016f20: 0a20 2020 200d 0a20 2020 2052 6574 7572  .    ..    Retur
+00016f30: 6e73 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  ns..    --------
+00016f40: 2d2d 2d0d 0a20 2020 2064 6174 6120 3a20  ---..    data : 
+00016f50: 6c69 7374 206f 6620 6e64 6172 7261 790d  list of ndarray.
+00016f60: 0a20 2020 2020 2020 2064 6174 6120 6f66  .        data of
+00016f70: 2061 6c6c 207a 6f6e 6573 2c20 7368 6170   all zones, shap
+00016f80: 6520 5b6e 692c 6e6a 2c6e 6b2c 6e76 5d2e  e [ni,nj,nk,nv].
+00016f90: 200d 0a20 2020 206e 616d 655f 7661 7220   ..    name_var 
+00016fa0: 3a20 6c69 7374 206f 6620 7374 720d 0a20  : list of str.. 
+00016fb0: 2020 2020 2020 206e 616d 6520 6f66 2076         name of v
+00016fc0: 6172 6961 626c 6573 2e0d 0a20 2020 2074  ariables...    t
+00016fd0: 6974 6c65 7320 3a20 6c69 7374 206f 6620  itles : list of 
+00016fe0: 7374 720d 0a20 2020 2020 2020 2074 6974  str..        tit
+00016ff0: 6c65 206f 6620 7a6f 6e65 730d 0a20 2020  le of zones..   
+00017000: 200d 0a20 2020 2045 7861 6d70 6c65 730d   ..    Examples.
+00017010: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
+00017020: 2d2d 0d0a 2020 2020 3e3e 3e20 6461 7461  --..    >>> data
+00017030: 2c20 6e61 6d65 5f76 6172 2c20 7469 746c  , name_var, titl
+00017040: 6573 203d 2072 6561 645f 7465 6370 6c6f  es = read_tecplo
+00017050: 7428 666e 616d 653d 2774 6563 706c 6f74  t(fname='tecplot
+00017060: 2e64 6174 2729 0d0a 2020 2020 0d0a 0d0a  .dat')..    ....
+00017070: 2020 2020 2727 270d 0a20 2020 206e 616d      '''..    nam
+00017080: 655f 7661 7220 3d20 5b5d 0d0a 2020 2020  e_var = []..    
+00017090: 6461 7461 203d 205b 5d0d 0a20 2020 2074  data = []..    t
+000170a0: 6974 6c65 7320 3d20 5b5d 0d0a 2020 2020  itles = []..    
+000170b0: 6e5f 7661 7220 3d20 300d 0a20 2020 200d  n_var = 0..    .
+000170c0: 0a20 2020 2077 6974 6820 6f70 656e 2866  .    with open(f
+000170d0: 6e61 6d65 2c20 2772 2729 2061 7320 663a  name, 'r') as f:
+000170e0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000170f0: 2020 2020 6c69 6e65 7320 3d20 662e 7265      lines = f.re
+00017100: 6164 6c69 6e65 7328 290d 0a20 2020 2020  adlines()..     
+00017110: 2020 206e 4c69 6e65 203d 206c 656e 286c     nLine = len(l
+00017120: 696e 6573 290d 0a20 2020 2020 2020 2069  ines)..        i
+00017130: 4c69 6e65 203d 2030 0d0a 2020 2020 0d0a  Line = 0..    ..
+00017140: 2020 2020 2020 2020 7768 696c 6520 694c          while iL
+00017150: 696e 6520 3c20 6e4c 696e 653a 0d0a 2020  ine < nLine:..  
+00017160: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00017170: 2020 2020 2020 2020 6c69 6e65 203d 206c          line = l
+00017180: 696e 6573 5b69 4c69 6e65 5d2e 7370 6c69  ines[iLine].spli
+00017190: 7428 290d 0a20 2020 2020 2020 2020 2020  t()..           
+000171a0: 2069 6620 6c65 6e28 6c69 6e65 2920 3d3d   if len(line) ==
+000171b0: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
+000171c0: 2020 2020 2069 4c69 6e65 202b 3d20 310d       iLine += 1.
+000171d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000171e0: 2063 6f6e 7469 6e75 650d 0a20 2020 2020   continue..     
+000171f0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00017200: 2020 2020 2069 6620 6c69 6e65 5b30 5d20       if line[0] 
+00017210: 696e 2027 5661 7269 6162 6c65 733d 2720  in 'Variables=' 
+00017220: 6f72 206c 696e 655b 305d 2069 6e20 2756  or line[0] in 'V
+00017230: 4152 4941 424c 4553 3d27 203a 0d0a 2020  ARIABLES=' :..  
+00017240: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+00017250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017260: 6c69 6e65 203d 2072 652e 7370 6c69 7428  line = re.split(
+00017270: 7227 5b3d 222c 5c73 5d27 2c20 6c69 6e65  r'[=",\s]', line
+00017280: 735b 694c 696e 655d 290d 0a20 2020 2020  s[iLine])..     
+00017290: 2020 2020 2020 2020 2020 2077 6869 6c65             while
+000172a0: 2027 2720 696e 206c 696e 653a 0d0a 2020   '' in line:..  
 000172b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000172c0: 2020 2020 6c69 6e65 2e72 656d 6f76 6528      line.remove(
-000172d0: 2727 290d 0a0d 0a20 2020 2020 2020 2020  '')....         
-000172e0: 2020 2020 2020 206e 616d 655f 7661 7220         name_var 
-000172f0: 3d20 6c69 6e65 5b31 3a5d 0d0a 2020 2020  = line[1:]..    
-00017300: 2020 2020 2020 2020 2020 2020 6e5f 7661              n_va
-00017310: 7220 3d20 6c65 6e28 6e61 6d65 5f76 6172  r = len(name_var
-00017320: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00017330: 2020 2069 4c69 6e65 202b 3d20 310d 0a20     iLine += 1.. 
-00017340: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00017350: 6f6e 7469 6e75 650d 0a20 2020 2020 2020  ontinue..       
-00017360: 200d 0a20 2020 2020 2020 2020 2020 2069   ..            i
-00017370: 6620 6c69 6e65 5b30 5d20 696e 2027 7a6f  f line[0] in 'zo
-00017380: 6e65 2720 6f72 206c 696e 655b 305d 2069  ne' or line[0] i
-00017390: 6e20 275a 4f4e 4527 206f 7220 6c69 6e65  n 'ZONE' or line
-000173a0: 5b30 5d20 696e 2027 5a6f 6e65 273a 0d0a  [0] in 'Zone':..
-000173b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000173c0: 6c69 6e65 203d 2072 652e 7370 6c69 7428  line = re.split(
-000173d0: 7227 5b3d 5c73 5d27 2c20 6c69 6e65 735b  r'[=\s]', lines[
-000173e0: 694c 696e 655d 290d 0a20 2020 2020 2020  iLine])..       
-000173f0: 2020 2020 2020 2020 2077 6869 6c65 2027           while '
-00017400: 2720 696e 206c 696e 653a 0d0a 2020 2020  ' in line:..    
-00017410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017420: 6c69 6e65 2e72 656d 6f76 6528 2727 290d  line.remove('').
-00017430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017440: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00017450: 2020 2069 6620 2769 2720 696e 206c 696e     if 'i' in lin
-00017460: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00017470: 2020 2020 2020 2020 6e69 203d 2069 6e74          ni = int
-00017480: 286c 696e 655b 6c69 6e65 2e69 6e64 6578  (line[line.index
-00017490: 2827 6927 292b 315d 290d 0a20 2020 2020  ('i')+1])..     
-000174a0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-000174b0: 2749 2720 696e 206c 696e 653a 0d0a 2020  'I' in line:..  
+000172c0: 2020 6c69 6e65 2e72 656d 6f76 6528 2727    line.remove(''
+000172d0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+000172e0: 2020 2020 206e 616d 655f 7661 7220 3d20       name_var = 
+000172f0: 6c69 6e65 5b31 3a5d 0d0a 2020 2020 2020  line[1:]..      
+00017300: 2020 2020 2020 2020 2020 6e5f 7661 7220            n_var 
+00017310: 3d20 6c65 6e28 6e61 6d65 5f76 6172 290d  = len(name_var).
+00017320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017330: 2069 4c69 6e65 202b 3d20 310d 0a20 2020   iLine += 1..   
+00017340: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+00017350: 7469 6e75 650d 0a20 2020 2020 2020 200d  tinue..        .
+00017360: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00017370: 6c69 6e65 5b30 5d20 696e 2027 7a6f 6e65  line[0] in 'zone
+00017380: 2720 6f72 206c 696e 655b 305d 2069 6e20  ' or line[0] in 
+00017390: 275a 4f4e 4527 206f 7220 6c69 6e65 5b30  'ZONE' or line[0
+000173a0: 5d20 696e 2027 5a6f 6e65 273a 0d0a 2020  ] in 'Zone':..  
+000173b0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+000173c0: 6e65 203d 2072 652e 7370 6c69 7428 7227  ne = re.split(r'
+000173d0: 5b3d 5c73 5d27 2c20 6c69 6e65 735b 694c  [=\s]', lines[iL
+000173e0: 696e 655d 290d 0a20 2020 2020 2020 2020  ine])..         
+000173f0: 2020 2020 2020 2077 6869 6c65 2027 2720         while '' 
+00017400: 696e 206c 696e 653a 0d0a 2020 2020 2020  in line:..      
+00017410: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00017420: 6e65 2e72 656d 6f76 6528 2727 290d 0a20  ne.remove('').. 
+00017430: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+00017440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017450: 2069 6620 2769 2720 696e 206c 696e 653a   if 'i' in line:
+00017460: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017470: 2020 2020 2020 6e69 203d 2069 6e74 286c        ni = int(l
+00017480: 696e 655b 6c69 6e65 2e69 6e64 6578 2827  ine[line.index('
+00017490: 6927 292b 315d 290d 0a20 2020 2020 2020  i')+1])..       
+000174a0: 2020 2020 2020 2020 2065 6c69 6620 2749           elif 'I
+000174b0: 2720 696e 206c 696e 653a 0d0a 2020 2020  ' in line:..    
 000174c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174d0: 2020 6e69 203d 2069 6e74 286c 696e 655b    ni = int(line[
-000174e0: 6c69 6e65 2e69 6e64 6578 2827 4927 292b  line.index('I')+
-000174f0: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
-00017500: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00017510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017520: 6e69 203d 2031 0d0a 2020 2020 2020 2020  ni = 1..        
-00017530: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00017540: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00017550: 2027 6a27 2069 6e20 6c69 6e65 3a0d 0a20   'j' in line:.. 
+000174d0: 6e69 203d 2069 6e74 286c 696e 655b 6c69  ni = int(line[li
+000174e0: 6e65 2e69 6e64 6578 2827 4927 292b 315d  ne.index('I')+1]
+000174f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00017500: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00017510: 2020 2020 2020 2020 2020 2020 2020 6e69                ni
+00017520: 203d 2031 0d0a 2020 2020 2020 2020 2020   = 1..          
+00017530: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00017540: 2020 2020 2020 2020 2020 2020 6966 2027              if '
+00017550: 6a27 2069 6e20 6c69 6e65 3a0d 0a20 2020  j' in line:..   
 00017560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017570: 2020 206e 6a20 3d20 696e 7428 6c69 6e65     nj = int(line
-00017580: 5b6c 696e 652e 696e 6465 7828 276a 2729  [line.index('j')
-00017590: 2b31 5d29 0d0a 2020 2020 2020 2020 2020  +1])..          
-000175a0: 2020 2020 2020 656c 6966 2027 4a27 2069        elif 'J' i
-000175b0: 6e20 6c69 6e65 3a0d 0a20 2020 2020 2020  n line:..       
-000175c0: 2020 2020 2020 2020 2020 2020 206e 6a20               nj 
-000175d0: 3d20 696e 7428 6c69 6e65 5b6c 696e 652e  = int(line[line.
-000175e0: 696e 6465 7828 274a 2729 2b31 5d29 0d0a  index('J')+1])..
-000175f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017600: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00017610: 2020 2020 2020 2020 2020 206e 6a20 3d20             nj = 
-00017620: 310d 0a20 2020 2020 2020 2020 2020 2020  1..             
-00017630: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00017640: 2020 2020 2020 2020 2069 6620 276b 2720           if 'k' 
-00017650: 696e 206c 696e 653a 0d0a 2020 2020 2020  in line:..      
-00017660: 2020 2020 2020 2020 2020 2020 2020 6e6b                nk
-00017670: 203d 2069 6e74 286c 696e 655b 6c69 6e65   = int(line[line
-00017680: 2e69 6e64 6578 2827 6b27 292b 315d 290d  .index('k')+1]).
-00017690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000176a0: 2065 6c69 6620 274b 2720 696e 206c 696e   elif 'K' in lin
-000176b0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-000176c0: 2020 2020 2020 2020 6e6b 203d 2069 6e74          nk = int
-000176d0: 286c 696e 655b 6c69 6e65 2e69 6e64 6578  (line[line.index
-000176e0: 2827 4b27 292b 315d 290d 0a20 2020 2020  ('K')+1])..     
-000176f0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00017700: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00017710: 2020 2020 2020 6e6b 203d 2031 0d0a 2020        nk = 1..  
+00017570: 206e 6a20 3d20 696e 7428 6c69 6e65 5b6c   nj = int(line[l
+00017580: 696e 652e 696e 6465 7828 276a 2729 2b31  ine.index('j')+1
+00017590: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+000175a0: 2020 2020 656c 6966 2027 4a27 2069 6e20      elif 'J' in 
+000175b0: 6c69 6e65 3a0d 0a20 2020 2020 2020 2020  line:..         
+000175c0: 2020 2020 2020 2020 2020 206e 6a20 3d20             nj = 
+000175d0: 696e 7428 6c69 6e65 5b6c 696e 652e 696e  int(line[line.in
+000175e0: 6465 7828 274a 2729 2b31 5d29 0d0a 2020  dex('J')+1])..  
+000175f0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00017600: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00017610: 2020 2020 2020 2020 206e 6a20 3d20 310d           nj = 1.
+00017620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017630: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00017640: 2020 2020 2020 2069 6620 276b 2720 696e         if 'k' in
+00017650: 206c 696e 653a 0d0a 2020 2020 2020 2020   line:..        
+00017660: 2020 2020 2020 2020 2020 2020 6e6b 203d              nk =
+00017670: 2069 6e74 286c 696e 655b 6c69 6e65 2e69   int(line[line.i
+00017680: 6e64 6578 2827 6b27 292b 315d 290d 0a20  ndex('k')+1]).. 
+00017690: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000176a0: 6c69 6620 274b 2720 696e 206c 696e 653a  lif 'K' in line:
+000176b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000176c0: 2020 2020 2020 6e6b 203d 2069 6e74 286c        nk = int(l
+000176d0: 696e 655b 6c69 6e65 2e69 6e64 6578 2827  ine[line.index('
+000176e0: 4b27 292b 315d 290d 0a20 2020 2020 2020  K')+1])..       
+000176f0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00017700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017710: 2020 2020 6e6b 203d 2031 0d0a 2020 2020      nk = 1..    
 00017720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017730: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00017740: 2020 2020 6966 2027 5427 2069 6e20 6c69      if 'T' in li
-00017750: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-00017760: 2020 2020 2020 2020 2023 20e9 9d9e e8b4           # .....
-00017770: aae5 a9aa e6a8 a1e5 bc8f efbc 9ae5 afbb  ................
-00017780: e689 bee6 9c80 e79f ade7 9a84 e58f afe8  ................
-00017790: 83bd e58c b9e9 858d 2068 7474 7073 3a2f  ........ https:/
-000177a0: 2f77 7777 2e63 6e62 6c6f 6773 2e63 6f6d  /www.cnblogs.com
-000177b0: 2f62 6178 6961 6e68 7561 2f70 2f38 3537  /baxianhua/p/857
-000177c0: 3139 3637 2e68 746d 6c0d 0a20 2020 2020  1967.html..     
-000177d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000177e0: 7472 5f70 6174 203d 2072 652e 636f 6d70  tr_pat = re.comp
-000177f0: 696c 6528 7227 5c22 282e 2a3f 295c 2227  ile(r'\"(.*?)\"'
-00017800: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00017810: 2020 2020 2020 206e 616d 6520 3d20 7374         name = st
-00017820: 725f 7061 742e 6669 6e64 616c 6c28 6c69  r_pat.findall(li
-00017830: 6e65 735b 694c 696e 655d 290d 0a20 2020  nes[iLine])..   
-00017840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017850: 2074 6974 6c65 732e 6170 7065 6e64 286e   titles.append(n
-00017860: 616d 655b 305d 290d 0a20 2020 2020 2020  ame[0])..       
-00017870: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00017730: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017740: 2020 6966 2027 5427 2069 6e20 6c69 6e65    if 'T' in line
+00017750: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00017760: 2020 2020 2020 2023 20e9 9d9e e8b4 aae5         # .......
+00017770: a9aa e6a8 a1e5 bc8f efbc 9ae5 afbb e689  ................
+00017780: bee6 9c80 e79f ade7 9a84 e58f afe8 83bd  ................
+00017790: e58c b9e9 858d 2068 7474 7073 3a2f 2f77  ...... https://w
+000177a0: 7777 2e63 6e62 6c6f 6773 2e63 6f6d 2f62  ww.cnblogs.com/b
+000177b0: 6178 6961 6e68 7561 2f70 2f38 3537 3139  axianhua/p/85719
+000177c0: 3637 2e68 746d 6c0d 0a20 2020 2020 2020  67.html..       
+000177d0: 2020 2020 2020 2020 2020 2020 2073 7472               str
+000177e0: 5f70 6174 203d 2072 652e 636f 6d70 696c  _pat = re.compil
+000177f0: 6528 7227 5c22 282e 2a3f 295c 2227 290d  e(r'\"(.*?)\"').
+00017800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017810: 2020 2020 206e 616d 6520 3d20 7374 725f       name = str_
+00017820: 7061 742e 6669 6e64 616c 6c28 6c69 6e65  pat.findall(line
+00017830: 735b 694c 696e 655d 290d 0a20 2020 2020  s[iLine])..     
+00017840: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00017850: 6974 6c65 732e 6170 7065 6e64 286e 616d  itles.append(nam
+00017860: 655b 305d 290d 0a20 2020 2020 2020 2020  e[0])..         
+00017870: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
 00017880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017890: 2020 2020 7469 746c 6573 2e61 7070 656e      titles.appen
-000178a0: 6428 2727 290d 0a20 2020 2020 2020 2020  d('')..         
-000178b0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-000178c0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-000178d0: 615f 203d 206e 702e 7a65 726f 7328 286e  a_ = np.zeros((n
-000178e0: 692c 6e6a 2c6e 6b2c 6e5f 7661 7229 290d  i,nj,nk,n_var)).
-000178f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017900: 2069 4c69 6e65 202b 3d20 310d 0a20 2020   iLine += 1..   
-00017910: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-00017920: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00017930: 6f72 206b 2069 6e20 7261 6e67 6528 6e6b  or k in range(nk
-00017940: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00017950: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
-00017960: 2072 616e 6765 286e 6a29 3a0d 0a20 2020   range(nj):..   
+00017890: 2020 7469 746c 6573 2e61 7070 656e 6428    titles.append(
+000178a0: 2727 290d 0a20 2020 2020 2020 2020 2020  '')..           
+000178b0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+000178c0: 2020 2020 2020 2020 2020 2064 6174 615f             data_
+000178d0: 203d 206e 702e 7a65 726f 7328 286e 692c   = np.zeros((ni,
+000178e0: 6e6a 2c6e 6b2c 6e5f 7661 7229 290d 0a20  nj,nk,n_var)).. 
+000178f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00017900: 4c69 6e65 202b 3d20 310d 0a20 2020 2020  Line += 1..     
+00017910: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00017920: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00017930: 206b 2069 6e20 7261 6e67 6528 6e6b 293a   k in range(nk):
+00017940: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017950: 2020 2020 2020 666f 7220 6a20 696e 2072        for j in r
+00017960: 616e 6765 286e 6a29 3a0d 0a20 2020 2020  ange(nj):..     
 00017970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017980: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00017990: 6e67 6528 6e69 293a 0d0a 2020 2020 2020  nge(ni):..      
+00017980: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00017990: 6528 6e69 293a 0d0a 2020 2020 2020 2020  e(ni):..        
 000179a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000179b0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000179b0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
 000179c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000179d0: 2020 2020 6c69 6e65 203d 205b 2723 275d      line = ['#']
-000179e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000179f0: 2020 2020 2020 2020 2020 2020 2020 7768                wh
-00017a00: 696c 6520 6c69 6e65 5b30 5d20 3d3d 2027  ile line[0] == '
-00017a10: 2327 3a0d 0a20 2020 2020 2020 2020 2020  #':..           
+000179d0: 2020 6c69 6e65 203d 205b 2723 275d 0d0a    line = ['#']..
+000179e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000179f0: 2020 2020 2020 2020 2020 2020 7768 696c              whil
+00017a00: 6520 6c69 6e65 5b30 5d20 3d3d 2027 2327  e line[0] == '#'
+00017a10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
 00017a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a30: 2020 2020 206c 696e 6520 3d20 6c69 6e65       line = line
-00017a40: 735b 694c 696e 655d 2e73 706c 6974 2829  s[iLine].split()
-00017a50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017a30: 2020 206c 696e 6520 3d20 6c69 6e65 735b     line = lines[
+00017a40: 694c 696e 655d 2e73 706c 6974 2829 0d0a  iLine].split()..
+00017a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00017a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a70: 2020 694c 696e 6520 2b3d 2031 0d0a 2020    iLine += 1..  
+00017a70: 694c 696e 6520 2b3d 2031 0d0a 2020 2020  iLine += 1..    
 00017a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a90: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+00017a90: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
 00017aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ab0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00017ac0: 7620 696e 2072 616e 6765 286e 5f76 6172  v in range(n_var
-00017ad0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00017ab0: 2020 2020 2020 2020 2020 666f 7220 7620            for v 
+00017ac0: 696e 2072 616e 6765 286e 5f76 6172 293a  in range(n_var):
+00017ad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00017ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017af0: 2020 2020 6461 7461 5f5b 692c 6a2c 6b2c      data_[i,j,k,
-00017b00: 765d 203d 2066 6c6f 6174 286c 696e 655b  v] = float(line[
-00017b10: 765d 290d 0a20 2020 2020 2020 2020 2020  v])..           
+00017af0: 2020 6461 7461 5f5b 692c 6a2c 6b2c 765d    data_[i,j,k,v]
+00017b00: 203d 2066 6c6f 6174 286c 696e 655b 765d   = float(line[v]
+00017b10: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
 00017b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b30: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00017b40: 2020 2020 2020 2064 6174 612e 6170 7065         data.appe
-00017b50: 6e64 2864 6174 615f 2e63 6f70 7928 2929  nd(data_.copy())
-00017b60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00017b70: 2020 636f 6e74 696e 7565 0d0a 0d0a 2020    continue....  
-00017b80: 2020 7265 7475 726e 2064 6174 612c 206e    return data, n
-00017b90: 616d 655f 7661 722c 2074 6974 6c65 730d  ame_var, titles.
-00017ba0: 0a0d 0a64 6566 2072 6561 645f 626c 6f63  ...def read_bloc
-00017bb0: 6b5f 706c 6f74 3364 286c 696e 6573 3a20  k_plot3d(lines: 
-00017bc0: 6c69 7374 2c20 694c 696e 6530 3a20 696e  list, iLine0: in
-00017bd0: 742c 206e 693a 2069 6e74 2c20 6e6a 3a20  t, ni: int, nj: 
-00017be0: 696e 742c 206e 6b3a 2069 6e74 2920 2d3e  int, nk: int) ->
-00017bf0: 2054 7570 6c65 5b6e 702e 6e64 6172 7261   Tuple[np.ndarra
-00017c00: 792c 2069 6e74 5d3a 0d0a 2020 2020 2727  y, int]:..    ''
-00017c10: 270d 0a20 2020 2052 6561 6420 626c 6f63  '..    Read bloc
-00017c20: 6b20 6461 7461 2066 726f 6d20 6c69 6e65  k data from line
-00017c30: 732e 0d0a 2020 2020 0d0a 2020 2020 5061  s...    ..    Pa
-00017c40: 7261 6d65 7465 7273 0d0a 2020 2020 2d2d  rameters..    --
-00017c50: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 206c  ---------..    l
-00017c60: 696e 6573 203a 206c 6973 7420 6f66 2073  ines : list of s
-00017c70: 7472 0d0a 2020 2020 2020 2020 662e 7265  tr..        f.re
-00017c80: 6164 6c69 6e65 7328 2920 6f66 2074 6865  adlines() of the
-00017c90: 2065 6e74 6972 6520 706c 6f74 3364 2066   entire plot3d f
-00017ca0: 6f72 6d61 7465 2066 696c 650d 0a20 2020  ormate file..   
-00017cb0: 2069 4c69 6e65 3020 3a20 696e 740d 0a20   iLine0 : int.. 
-00017cc0: 2020 2020 2020 2074 6865 2066 6972 7374         the first
-00017cd0: 206c 696e 6520 6f66 2074 6869 7320 626c   line of this bl
-00017ce0: 6f63 6b20 6973 206c 696e 6573 5b69 4c69  ock is lines[iLi
-00017cf0: 6e65 305d 0d0a 2020 2020 6e69 2c20 6e6a  ne0]..    ni, nj
-00017d00: 2c20 6e6b 3a20 696e 740d 0a20 2020 2020  , nk: int..     
-00017d10: 2020 2073 697a 6520 6f66 2074 6869 7320     size of this 
-00017d20: 626c 6f63 6b0d 0a20 2020 2020 2020 200d  block..        .
-00017d30: 0a20 2020 2052 6574 7572 6e73 0d0a 2020  .    Returns..  
-00017d40: 2020 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020    ---------..   
-00017d50: 2078 797a 203a 206e 6461 7272 6179 0d0a   xyz : ndarray..
-00017d60: 2020 2020 2020 2020 636f 6f72 6469 6e61          coordina
-00017d70: 7465 732c 2073 6861 7065 2060 5b6e 692c  tes, shape `[ni,
-00017d80: 6e6a 2c6e 6b2c 335d 602e 0d0a 2020 2020  nj,nk,3]`...    
-00017d90: 694c 696e 6530 5f6e 6577 203a 2069 6e74  iLine0_new : int
-00017da0: 0d0a 2020 2020 2020 2020 696e 6465 7820  ..        index 
-00017db0: 6f66 206c 696e 6520 6166 7465 7220 7265  of line after re
-00017dc0: 6164 2e0d 0a0d 0a20 2020 2045 7861 6d70  ad.....    Examp
-00017dd0: 6c65 730d 0a20 2020 202d 2d2d 2d2d 2d2d  les..    -------
-00017de0: 2d2d 2d0d 0a20 2020 203e 3e3e 2078 797a  ---..    >>> xyz
-00017df0: 2c20 694c 696e 6530 5f6e 6577 203d 2072  , iLine0_new = r
-00017e00: 6561 645f 626c 6f63 6b5f 706c 6f74 3364  ead_block_plot3d
-00017e10: 286c 696e 6573 2c20 694c 696e 6530 2c20  (lines, iLine0, 
-00017e20: 6e69 2c20 6e6a 2c20 6e6b 290d 0a0d 0a20  ni, nj, nk).... 
-00017e30: 2020 2027 2727 0d0a 2020 2020 7879 7a20     '''..    xyz 
-00017e40: 3d20 6e70 2e7a 6572 6f73 285b 6e69 2c6e  = np.zeros([ni,n
-00017e50: 6a2c 6e6b 2c33 5d29 0d0a 2020 2020 6c6c  j,nk,3])..    ll
-00017e60: 2020 3d20 694c 696e 6530 0d0a 2020 2020    = iLine0..    
-00017e70: 6969 2020 3d20 300d 0a20 2020 206c 696e  ii  = 0..    lin
-00017e80: 6520 3d20 5b5d 0d0a 0d0a 2020 2020 666f  e = []....    fo
-00017e90: 7220 6d20 696e 2072 616e 6765 2833 293a  r m in range(3):
-00017ea0: 0d0a 2020 2020 2020 2020 666f 7220 6b20  ..        for k 
-00017eb0: 696e 2072 616e 6765 286e 6b29 3a0d 0a20  in range(nk):.. 
-00017ec0: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
-00017ed0: 2069 6e20 7261 6e67 6528 6e6a 293a 0d0a   in range(nj):..
-00017ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ef0: 666f 7220 6920 696e 2072 616e 6765 286e  for i in range(n
-00017f00: 6929 3a0d 0a0d 0a20 2020 2020 2020 2020  i):....         
-00017f10: 2020 2020 2020 2020 2020 2069 6620 6969             if ii
-00017f20: 203e 3d20 6c65 6e28 6c69 6e65 292d 313a   >= len(line)-1:
-00017f30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00017f40: 2020 2020 2020 2020 2020 2320 4e65 6564            # Need
-00017f50: 2074 6f20 7265 6164 2074 6865 206e 6578   to read the nex
-00017f60: 7420 6c69 6e65 0d0a 2020 2020 2020 2020  t line..        
-00017f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017f80: 6c69 6e65 203d 206c 696e 6573 5b6c 6c5d  line = lines[ll]
-00017f90: 2e73 706c 6974 2829 0d0a 2020 2020 2020  .split()..      
+00017b30: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00017b40: 2020 2020 2064 6174 612e 6170 7065 6e64       data.append
+00017b50: 2864 6174 615f 2e63 6f70 7928 2929 0d0a  (data_.copy())..
+00017b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017b70: 636f 6e74 696e 7565 0d0a 0d0a 2020 2020  continue....    
+00017b80: 7265 7475 726e 2064 6174 612c 206e 616d  return data, nam
+00017b90: 655f 7661 722c 2074 6974 6c65 730d 0a0d  e_var, titles...
+00017ba0: 0a64 6566 2072 6561 645f 626c 6f63 6b5f  .def read_block_
+00017bb0: 706c 6f74 3364 286c 696e 6573 3a20 6c69  plot3d(lines: li
+00017bc0: 7374 2c20 694c 696e 6530 3a20 696e 742c  st, iLine0: int,
+00017bd0: 206e 693a 2069 6e74 2c20 6e6a 3a20 696e   ni: int, nj: in
+00017be0: 742c 206e 6b3a 2069 6e74 2920 2d3e 2054  t, nk: int) -> T
+00017bf0: 7570 6c65 5b6e 702e 6e64 6172 7261 792c  uple[np.ndarray,
+00017c00: 2069 6e74 5d3a 0d0a 2020 2020 2727 270d   int]:..    '''.
+00017c10: 0a20 2020 2052 6561 6420 626c 6f63 6b20  .    Read block 
+00017c20: 6461 7461 2066 726f 6d20 6c69 6e65 732e  data from lines.
+00017c30: 0d0a 2020 2020 0d0a 2020 2020 5061 7261  ..    ..    Para
+00017c40: 6d65 7465 7273 0d0a 2020 2020 2d2d 2d2d  meters..    ----
+00017c50: 2d2d 2d2d 2d2d 2d0d 0a20 2020 206c 696e  -------..    lin
+00017c60: 6573 203a 206c 6973 7420 6f66 2073 7472  es : list of str
+00017c70: 0d0a 2020 2020 2020 2020 662e 7265 6164  ..        f.read
+00017c80: 6c69 6e65 7328 2920 6f66 2074 6865 2065  lines() of the e
+00017c90: 6e74 6972 6520 706c 6f74 3364 2066 6f72  ntire plot3d for
+00017ca0: 6d61 7465 2066 696c 650d 0a20 2020 2069  mate file..    i
+00017cb0: 4c69 6e65 3020 3a20 696e 740d 0a20 2020  Line0 : int..   
+00017cc0: 2020 2020 2074 6865 2066 6972 7374 206c       the first l
+00017cd0: 696e 6520 6f66 2074 6869 7320 626c 6f63  ine of this bloc
+00017ce0: 6b20 6973 206c 696e 6573 5b69 4c69 6e65  k is lines[iLine
+00017cf0: 305d 0d0a 2020 2020 6e69 2c20 6e6a 2c20  0]..    ni, nj, 
+00017d00: 6e6b 3a20 696e 740d 0a20 2020 2020 2020  nk: int..       
+00017d10: 2073 697a 6520 6f66 2074 6869 7320 626c   size of this bl
+00017d20: 6f63 6b0d 0a20 2020 2020 2020 200d 0a20  ock..        .. 
+00017d30: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+00017d40: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2078  ---------..    x
+00017d50: 797a 203a 206e 6461 7272 6179 0d0a 2020  yz : ndarray..  
+00017d60: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
+00017d70: 732c 2073 6861 7065 2060 5b6e 692c 6e6a  s, shape `[ni,nj
+00017d80: 2c6e 6b2c 335d 602e 0d0a 2020 2020 694c  ,nk,3]`...    iL
+00017d90: 696e 6530 5f6e 6577 203a 2069 6e74 0d0a  ine0_new : int..
+00017da0: 2020 2020 2020 2020 696e 6465 7820 6f66          index of
+00017db0: 206c 696e 6520 6166 7465 7220 7265 6164   line after read
+00017dc0: 2e0d 0a0d 0a20 2020 2045 7861 6d70 6c65  .....    Example
+00017dd0: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
+00017de0: 2d0d 0a20 2020 203e 3e3e 2078 797a 2c20  -..    >>> xyz, 
+00017df0: 694c 696e 6530 5f6e 6577 203d 2072 6561  iLine0_new = rea
+00017e00: 645f 626c 6f63 6b5f 706c 6f74 3364 286c  d_block_plot3d(l
+00017e10: 696e 6573 2c20 694c 696e 6530 2c20 6e69  ines, iLine0, ni
+00017e20: 2c20 6e6a 2c20 6e6b 290d 0a0d 0a20 2020  , nj, nk)....   
+00017e30: 2027 2727 0d0a 2020 2020 7879 7a20 3d20   '''..    xyz = 
+00017e40: 6e70 2e7a 6572 6f73 285b 6e69 2c6e 6a2c  np.zeros([ni,nj,
+00017e50: 6e6b 2c33 5d29 0d0a 2020 2020 6c6c 2020  nk,3])..    ll  
+00017e60: 3d20 694c 696e 6530 0d0a 2020 2020 6969  = iLine0..    ii
+00017e70: 2020 3d20 300d 0a20 2020 206c 696e 6520    = 0..    line 
+00017e80: 3d20 5b5d 0d0a 0d0a 2020 2020 666f 7220  = []....    for 
+00017e90: 6d20 696e 2072 616e 6765 2833 293a 0d0a  m in range(3):..
+00017ea0: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
+00017eb0: 2072 616e 6765 286e 6b29 3a0d 0a20 2020   range(nk):..   
+00017ec0: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
+00017ed0: 6e20 7261 6e67 6528 6e6a 293a 0d0a 2020  n range(nj):..  
+00017ee0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00017ef0: 7220 6920 696e 2072 616e 6765 286e 6929  r i in range(ni)
+00017f00: 3a0d 0a0d 0a20 2020 2020 2020 2020 2020  :....           
+00017f10: 2020 2020 2020 2020 2069 6620 6969 203e           if ii >
+00017f20: 3d20 6c65 6e28 6c69 6e65 292d 313a 0d0a  = len(line)-1:..
+00017f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017f40: 2020 2020 2020 2020 2320 4e65 6564 2074          # Need t
+00017f50: 6f20 7265 6164 2074 6865 206e 6578 7420  o read the next 
+00017f60: 6c69 6e65 0d0a 2020 2020 2020 2020 2020  line..          
+00017f70: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00017f80: 6e65 203d 206c 696e 6573 5b6c 6c5d 2e73  ne = lines[ll].s
+00017f90: 706c 6974 2829 0d0a 2020 2020 2020 2020  plit()..        
 00017fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017fb0: 2020 6969 203d 2030 0d0a 2020 2020 2020    ii = 0..      
+00017fb0: 6969 203d 2030 0d0a 2020 2020 2020 2020  ii = 0..        
 00017fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017fd0: 2020 6c6c 202b 3d20 310d 0a20 2020 2020    ll += 1..     
-00017fe0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00017ff0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00018000: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00018010: 5265 6164 206e 6578 7420 7661 6c75 650d  Read next value.
-00018020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018030: 2020 2020 2020 2020 2069 6920 2b3d 2031           ii += 1
-00018040: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00018050: 2020 2020 2020 2020 7879 7a5b 692c 6a2c          xyz[i,j,
-00018060: 6b2c 6d5d 203d 2066 6c6f 6174 286c 696e  k,m] = float(lin
-00018070: 655b 6969 5d29 0d0a 0d0a 2020 2020 694c  e[ii])....    iL
-00018080: 696e 6530 5f6e 6577 203d 206c 6c0d 0a0d  ine0_new = ll...
-00018090: 0a20 2020 2072 6574 7572 6e20 7879 7a2c  .    return xyz,
-000180a0: 2069 4c69 6e65 305f 6e65 770d 0a0d 0a64   iLine0_new....d
-000180b0: 6566 206f 7574 7075 745f 706c 6f74 3364  ef output_plot3d
-000180c0: 2858 3a20 6c69 7374 2c20 593a 206c 6973  (X: list, Y: lis
-000180d0: 742c 205a 3a20 6c69 7374 2c20 666e 616d  t, Z: list, fnam
-000180e0: 653a 2073 7472 2c20 7363 616c 653d 312e  e: str, scale=1.
-000180f0: 3029 202d 3e20 4e6f 6e65 3a0d 0a20 2020  0) -> None:..   
-00018100: 2027 2727 0d0a 2020 2020 4f75 7470 7574   '''..    Output
-00018110: 2073 7572 6661 6365 2074 6f20 666e 616d   surface to fnam
-00018120: 6520 696e 2070 6c6f 7433 6420 666f 726d  e in plot3d form
-00018130: 6174 2e0d 0a20 2020 200d 0a20 2020 2050  at...    ..    P
-00018140: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
-00018150: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-00018160: 2020 582c 2059 2c20 5a3a 206c 6973 7420    X, Y, Z: list 
-00018170: 6f66 206e 6461 7272 6179 205b 6e73 2c6e  of ndarray [ns,n
-00018180: 6e5d 0d0a 2020 2020 2020 2020 636f 6f72  n]..        coor
-00018190: 6469 6e61 7465 730d 0a20 2020 2066 6e61  dinates..    fna
-000181a0: 6d65 3a20 7374 720d 0a20 2020 2020 2020  me: str..       
-000181b0: 2074 6865 206e 616d 6520 6f66 2074 6865   the name of the
-000181c0: 2066 696c 6520 2860 2a2e 6772 6460 290d   file (`*.grd`).
-000181d0: 0a0d 0a20 2020 2027 2727 0d0a 2020 2020  ...    '''..    
-000181e0: 2320 6e73 3a20 6e75 6d62 6572 206f 6620  # ns: number of 
-000181f0: 7370 616e 7769 7365 2070 6f69 6e74 730d  spanwise points.
-00018200: 0a20 2020 2023 206e 6e3a 206e 756d 6265  .    # nn: numbe
-00018210: 7220 6f66 2063 7572 7665 2070 6f69 6e74  r of curve point
-00018220: 730d 0a20 2020 200d 0a20 2020 206e 3020  s..    ..    n0 
-00018230: 3d20 6c65 6e28 5829 0d0a 0d0a 2020 2020  = len(X)....    
-00018240: 7769 7468 206f 7065 6e28 666e 616d 652c  with open(fname,
-00018250: 2027 7727 2920 6173 2066 3a0d 0a20 2020   'w') as f:..   
-00018260: 2020 2020 2066 2e77 7269 7465 2827 2564       f.write('%d
-00018270: 205c 6e20 2725 286e 3029 2920 2020 2020   \n '%(n0))     
-00018280: 2320 4e75 6d62 6572 206f 6620 7375 7266  # Number of surf
-00018290: 6163 6573 0d0a 2020 2020 2020 2020 666f  aces..        fo
-000182a0: 7220 695f 7365 6320 696e 2072 616e 6765  r i_sec in range
-000182b0: 286e 3029 3a0d 0a20 2020 2020 2020 2020  (n0):..         
-000182c0: 2020 206e 7320 3d20 585b 695f 7365 635d     ns = X[i_sec]
-000182d0: 2e73 6861 7065 5b30 5d0d 0a20 2020 2020  .shape[0]..     
-000182e0: 2020 2020 2020 206e 6e20 3d20 585b 695f         nn = X[i_
-000182f0: 7365 635d 2e73 6861 7065 5b31 5d0d 0a20  sec].shape[1].. 
-00018300: 2020 2020 2020 2020 2020 2066 2e77 7269             f.wri
-00018310: 7465 2827 2564 2025 6420 315c 6e20 2725  te('%d %d 1\n '%
-00018320: 286e 6e2c 206e 7329 290d 0a0d 0a20 2020  (nn, ns))....   
-00018330: 2020 2020 2066 6f72 2069 5f73 6563 2069       for i_sec i
-00018340: 6e20 7261 6e67 6528 6e30 293a 0d0a 2020  n range(n0):..  
-00018350: 2020 2020 2020 2020 2020 6969 203d 2030            ii = 0
-00018360: 0d0a 2020 2020 2020 2020 2020 2020 6e73  ..            ns
-00018370: 203d 2058 5b69 5f73 6563 5d2e 7368 6170   = X[i_sec].shap
-00018380: 655b 305d 0d0a 2020 2020 2020 2020 2020  e[0]..          
-00018390: 2020 6e6e 203d 2058 5b69 5f73 6563 5d2e    nn = X[i_sec].
-000183a0: 7368 6170 655b 315d 0d0a 2020 2020 2020  shape[1]..      
-000183b0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-000183c0: 616e 6765 286e 7329 3a0d 0a20 2020 2020  ange(ns):..     
-000183d0: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
-000183e0: 2069 6e20 7261 6e67 6528 6e6e 293a 0d0a   in range(nn):..
+00017fd0: 6c6c 202b 3d20 310d 0a20 2020 2020 2020  ll += 1..       
+00017fe0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00017ff0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00018000: 2020 2020 2020 2020 2020 2020 2320 5265              # Re
+00018010: 6164 206e 6578 7420 7661 6c75 650d 0a20  ad next value.. 
+00018020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018030: 2020 2020 2020 2069 6920 2b3d 2031 0d0a         ii += 1..
+00018040: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018050: 2020 2020 2020 7879 7a5b 692c 6a2c 6b2c        xyz[i,j,k,
+00018060: 6d5d 203d 2066 6c6f 6174 286c 696e 655b  m] = float(line[
+00018070: 6969 5d29 0d0a 0d0a 2020 2020 694c 696e  ii])....    iLin
+00018080: 6530 5f6e 6577 203d 206c 6c0d 0a0d 0a20  e0_new = ll.... 
+00018090: 2020 2072 6574 7572 6e20 7879 7a2c 2069     return xyz, i
+000180a0: 4c69 6e65 305f 6e65 770d 0a0d 0a64 6566  Line0_new....def
+000180b0: 206f 7574 7075 745f 706c 6f74 3364 2858   output_plot3d(X
+000180c0: 3a20 6c69 7374 2c20 593a 206c 6973 742c  : list, Y: list,
+000180d0: 205a 3a20 6c69 7374 2c20 666e 616d 653a   Z: list, fname:
+000180e0: 2073 7472 2c20 7363 616c 653d 312e 3029   str, scale=1.0)
+000180f0: 202d 3e20 4e6f 6e65 3a0d 0a20 2020 2027   -> None:..    '
+00018100: 2727 0d0a 2020 2020 4f75 7470 7574 2073  ''..    Output s
+00018110: 7572 6661 6365 2074 6f20 666e 616d 6520  urface to fname 
+00018120: 696e 2070 6c6f 7433 6420 666f 726d 6174  in plot3d format
+00018130: 2e0d 0a20 2020 200d 0a20 2020 2050 6172  ...    ..    Par
+00018140: 616d 6574 6572 730d 0a20 2020 202d 2d2d  ameters..    ---
+00018150: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00018160: 582c 2059 2c20 5a3a 206c 6973 7420 6f66  X, Y, Z: list of
+00018170: 206e 6461 7272 6179 205b 6e73 2c6e 6e5d   ndarray [ns,nn]
+00018180: 0d0a 2020 2020 2020 2020 636f 6f72 6469  ..        coordi
+00018190: 6e61 7465 730d 0a20 2020 2066 6e61 6d65  nates..    fname
+000181a0: 3a20 7374 720d 0a20 2020 2020 2020 2074  : str..        t
+000181b0: 6865 206e 616d 6520 6f66 2074 6865 2066  he name of the f
+000181c0: 696c 6520 2860 2a2e 6772 6460 290d 0a0d  ile (`*.grd`)...
+000181d0: 0a20 2020 2027 2727 0d0a 2020 2020 2320  .    '''..    # 
+000181e0: 6e73 3a20 6e75 6d62 6572 206f 6620 7370  ns: number of sp
+000181f0: 616e 7769 7365 2070 6f69 6e74 730d 0a20  anwise points.. 
+00018200: 2020 2023 206e 6e3a 206e 756d 6265 7220     # nn: number 
+00018210: 6f66 2063 7572 7665 2070 6f69 6e74 730d  of curve points.
+00018220: 0a20 2020 200d 0a20 2020 206e 3020 3d20  .    ..    n0 = 
+00018230: 6c65 6e28 5829 0d0a 0d0a 2020 2020 7769  len(X)....    wi
+00018240: 7468 206f 7065 6e28 666e 616d 652c 2027  th open(fname, '
+00018250: 7727 2920 6173 2066 3a0d 0a20 2020 2020  w') as f:..     
+00018260: 2020 2066 2e77 7269 7465 2827 2564 205c     f.write('%d \
+00018270: 6e20 2725 286e 3029 2920 2020 2020 2320  n '%(n0))     # 
+00018280: 4e75 6d62 6572 206f 6620 7375 7266 6163  Number of surfac
+00018290: 6573 0d0a 2020 2020 2020 2020 666f 7220  es..        for 
+000182a0: 695f 7365 6320 696e 2072 616e 6765 286e  i_sec in range(n
+000182b0: 3029 3a0d 0a20 2020 2020 2020 2020 2020  0):..           
+000182c0: 206e 7320 3d20 585b 695f 7365 635d 2e73   ns = X[i_sec].s
+000182d0: 6861 7065 5b30 5d0d 0a20 2020 2020 2020  hape[0]..       
+000182e0: 2020 2020 206e 6e20 3d20 585b 695f 7365       nn = X[i_se
+000182f0: 635d 2e73 6861 7065 5b31 5d0d 0a20 2020  c].shape[1]..   
+00018300: 2020 2020 2020 2020 2066 2e77 7269 7465           f.write
+00018310: 2827 2564 2025 6420 315c 6e20 2725 286e  ('%d %d 1\n '%(n
+00018320: 6e2c 206e 7329 290d 0a0d 0a20 2020 2020  n, ns))....     
+00018330: 2020 2066 6f72 2069 5f73 6563 2069 6e20     for i_sec in 
+00018340: 7261 6e67 6528 6e30 293a 0d0a 2020 2020  range(n0):..    
+00018350: 2020 2020 2020 2020 6969 203d 2030 0d0a          ii = 0..
+00018360: 2020 2020 2020 2020 2020 2020 6e73 203d              ns =
+00018370: 2058 5b69 5f73 6563 5d2e 7368 6170 655b   X[i_sec].shape[
+00018380: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
+00018390: 6e6e 203d 2058 5b69 5f73 6563 5d2e 7368  nn = X[i_sec].sh
+000183a0: 6170 655b 315d 0d0a 2020 2020 2020 2020  ape[1]..        
+000183b0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+000183c0: 6765 286e 7329 3a0d 0a20 2020 2020 2020  ge(ns):..       
+000183d0: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
+000183e0: 6e20 7261 6e67 6528 6e6e 293a 0d0a 2020  n range(nn):..  
 000183f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018400: 2020 2020 662e 7772 6974 6528 2720 252e      f.write(' %.
-00018410: 3966 2027 2528 585b 695f 7365 635d 5b69  9f '%(X[i_sec][i
-00018420: 2c6a 5d2a 7363 616c 6529 290d 0a20 2020  ,j]*scale))..   
-00018430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018440: 2069 6920 2b3d 2031 0d0a 2020 2020 2020   ii += 1..      
-00018450: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00018460: 2069 6925 333d 3d30 206f 7220 2869 3d3d   ii%3==0 or (i==
-00018470: 6e73 2d31 2061 6e64 206a 3d3d 6e6e 2d31  ns-1 and j==nn-1
-00018480: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00018490: 2020 2020 2020 2020 2020 2020 662e 7772              f.wr
-000184a0: 6974 6528 2720 5c6e 2027 290d 0a0d 0a20  ite(' \n ').... 
-000184b0: 2020 2020 2020 2020 2020 2069 6920 3d20             ii = 
-000184c0: 300d 0a20 2020 2020 2020 2020 2020 206e  0..            n
-000184d0: 7320 3d20 595b 695f 7365 635d 2e73 6861  s = Y[i_sec].sha
-000184e0: 7065 5b30 5d0d 0a20 2020 2020 2020 2020  pe[0]..         
-000184f0: 2020 206e 6e20 3d20 595b 695f 7365 635d     nn = Y[i_sec]
-00018500: 2e73 6861 7065 5b31 5d0d 0a20 2020 2020  .shape[1]..     
-00018510: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00018520: 7261 6e67 6528 6e73 293a 0d0a 2020 2020  range(ns):..    
-00018530: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00018540: 6a20 696e 2072 616e 6765 286e 6e29 3a0d  j in range(nn):.
-00018550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018560: 2020 2020 2066 2e77 7269 7465 2827 2025       f.write(' %
-00018570: 2e39 6620 2725 2859 5b69 5f73 6563 5d5b  .9f '%(Y[i_sec][
-00018580: 692c 6a5d 2a73 6361 6c65 2929 0d0a 2020  i,j]*scale))..  
+00018400: 2020 662e 7772 6974 6528 2720 252e 3966    f.write(' %.9f
+00018410: 2027 2528 585b 695f 7365 635d 5b69 2c6a   '%(X[i_sec][i,j
+00018420: 5d2a 7363 616c 6529 290d 0a20 2020 2020  ]*scale))..     
+00018430: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00018440: 6920 2b3d 2031 0d0a 2020 2020 2020 2020  i += 1..        
+00018450: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00018460: 6925 333d 3d30 206f 7220 2869 3d3d 6e73  i%3==0 or (i==ns
+00018470: 2d31 2061 6e64 206a 3d3d 6e6e 2d31 293a  -1 and j==nn-1):
+00018480: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018490: 2020 2020 2020 2020 2020 662e 7772 6974            f.writ
+000184a0: 6528 2720 5c6e 2027 290d 0a0d 0a20 2020  e(' \n ')....   
+000184b0: 2020 2020 2020 2020 2069 6920 3d20 300d           ii = 0.
+000184c0: 0a20 2020 2020 2020 2020 2020 206e 7320  .            ns 
+000184d0: 3d20 595b 695f 7365 635d 2e73 6861 7065  = Y[i_sec].shape
+000184e0: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
+000184f0: 206e 6e20 3d20 595b 695f 7365 635d 2e73   nn = Y[i_sec].s
+00018500: 6861 7065 5b31 5d0d 0a20 2020 2020 2020  hape[1]..       
+00018510: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+00018520: 6e67 6528 6e73 293a 0d0a 2020 2020 2020  nge(ns):..      
+00018530: 2020 2020 2020 2020 2020 666f 7220 6a20            for j 
+00018540: 696e 2072 616e 6765 286e 6e29 3a0d 0a20  in range(nn):.. 
+00018550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018560: 2020 2066 2e77 7269 7465 2827 2025 2e39     f.write(' %.9
+00018570: 6620 2725 2859 5b69 5f73 6563 5d5b 692c  f '%(Y[i_sec][i,
+00018580: 6a5d 2a73 6361 6c65 2929 0d0a 2020 2020  j]*scale))..    
 00018590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000185a0: 2020 6969 202b 3d20 310d 0a20 2020 2020    ii += 1..     
-000185b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000185c0: 6620 6969 2533 3d3d 3020 6f72 2028 693d  f ii%3==0 or (i=
-000185d0: 3d6e 732d 3120 616e 6420 6a3d 3d6e 6e2d  =ns-1 and j==nn-
-000185e0: 3129 3a0d 0a20 2020 2020 2020 2020 2020  1):..           
-000185f0: 2020 2020 2020 2020 2020 2020 2066 2e77               f.w
-00018600: 7269 7465 2827 205c 6e20 2729 0d0a 0d0a  rite(' \n ')....
-00018610: 2020 2020 2020 2020 2020 2020 6969 203d              ii =
-00018620: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
-00018630: 6e73 203d 205a 5b69 5f73 6563 5d2e 7368  ns = Z[i_sec].sh
-00018640: 6170 655b 305d 0d0a 2020 2020 2020 2020  ape[0]..        
-00018650: 2020 2020 6e6e 203d 205a 5b69 5f73 6563      nn = Z[i_sec
-00018660: 5d2e 7368 6170 655b 315d 0d0a 2020 2020  ].shape[1]..    
-00018670: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00018680: 2072 616e 6765 286e 7329 3a0d 0a20 2020   range(ns):..   
-00018690: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-000186a0: 206a 2069 6e20 7261 6e67 6528 6e6e 293a   j in range(nn):
-000186b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000186c0: 2020 2020 2020 662e 7772 6974 6528 2720        f.write(' 
-000186d0: 252e 3966 2027 2528 5a5b 695f 7365 635d  %.9f '%(Z[i_sec]
-000186e0: 5b69 2c6a 5d2a 7363 616c 6529 290d 0a20  [i,j]*scale)).. 
+000185a0: 6969 202b 3d20 310d 0a20 2020 2020 2020  ii += 1..       
+000185b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000185c0: 6969 2533 3d3d 3020 6f72 2028 693d 3d6e  ii%3==0 or (i==n
+000185d0: 732d 3120 616e 6420 6a3d 3d6e 6e2d 3129  s-1 and j==nn-1)
+000185e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000185f0: 2020 2020 2020 2020 2020 2066 2e77 7269             f.wri
+00018600: 7465 2827 205c 6e20 2729 0d0a 0d0a 2020  te(' \n ')....  
+00018610: 2020 2020 2020 2020 2020 6969 203d 2030            ii = 0
+00018620: 0d0a 2020 2020 2020 2020 2020 2020 6e73  ..            ns
+00018630: 203d 205a 5b69 5f73 6563 5d2e 7368 6170   = Z[i_sec].shap
+00018640: 655b 305d 0d0a 2020 2020 2020 2020 2020  e[0]..          
+00018650: 2020 6e6e 203d 205a 5b69 5f73 6563 5d2e    nn = Z[i_sec].
+00018660: 7368 6170 655b 315d 0d0a 2020 2020 2020  shape[1]..      
+00018670: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00018680: 616e 6765 286e 7329 3a0d 0a20 2020 2020  ange(ns):..     
+00018690: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
+000186a0: 2069 6e20 7261 6e67 6528 6e6e 293a 0d0a   in range(nn):..
+000186b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000186c0: 2020 2020 662e 7772 6974 6528 2720 252e      f.write(' %.
+000186d0: 3966 2027 2528 5a5b 695f 7365 635d 5b69  9f '%(Z[i_sec][i
+000186e0: 2c6a 5d2a 7363 616c 6529 290d 0a20 2020  ,j]*scale))..   
 000186f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018700: 2020 2069 6920 2b3d 2031 0d0a 2020 2020     ii += 1..    
-00018710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018720: 6966 2069 6925 333d 3d30 206f 7220 2869  if ii%3==0 or (i
-00018730: 3d3d 6e73 2d31 2061 6e64 206a 3d3d 6e6e  ==ns-1 and j==nn
-00018740: 2d31 293a 0d0a 2020 2020 2020 2020 2020  -1):..          
-00018750: 2020 2020 2020 2020 2020 2020 2020 662e                f.
-00018760: 7772 6974 6528 2720 5c6e 2027 290d 0a0d  write(' \n ')...
-00018770: 0a64 6566 2070 6c6f 7433 645f 746f 5f69  .def plot3d_to_i
-00018780: 6773 2866 6e61 6d65 3d27 6967 7327 293a  gs(fname='igs'):
-00018790: 0d0a 2020 2020 2727 270d 0a20 2020 2043  ..    '''..    C
-000187a0: 6f6e 7665 7274 7320 506c 6f74 3364 2073  onverts Plot3d s
-000187b0: 7572 6661 6365 2067 7269 6420 6669 6c65  urface grid file
-000187c0: 205b 666e 616d 652e 6772 645d 2074 6f20   [fname.grd] to 
-000187d0: 4947 4553 2066 696c 6520 5b66 6e61 6d65  IGES file [fname
-000187e0: 2e69 6773 5d2e 0d0a 2020 2020 0d0a 2020  .igs]...    ..  
-000187f0: 2020 4f72 6967 696e 616c 2046 6f72 7472    Original Fortr
-00018800: 616e 2076 6572 7369 6f6e 2062 7920 5072  an version by Pr
-00018810: 6f66 2e20 5a68 616e 6720 5975 6665 693a  of. Zhang Yufei:
-00018820: 207a 6861 6e67 7975 6665 6940 7473 696e   zhangyufei@tsin
-00018830: 6768 7561 2e65 6475 2e63 6e2e 0d0a 2020  ghua.edu.cn...  
-00018840: 2020 2727 270d 0a0d 0a20 2020 2023 2a20    '''....    #* 
-00018850: 5265 6164 2070 6c6f 7433 6420 666f 726d  Read plot3d form
-00018860: 6174 2066 696c 650d 0a20 2020 2069 6620  at file..    if 
-00018870: 6e6f 7420 6f73 2e70 6174 682e 6578 6973  not os.path.exis
-00018880: 7473 2866 6e61 6d65 2b27 2e67 7264 2729  ts(fname+'.grd')
-00018890: 3a0d 0a20 2020 2020 2020 2072 6169 7365  :..        raise
-000188a0: 2045 7863 6570 7469 6f6e 2866 6e61 6d65   Exception(fname
-000188b0: 2b27 2064 6f65 7320 6e6f 7420 6578 6973  +' does not exis
-000188c0: 7420 666f 7220 666f 726d 6174 2074 7261  t for format tra
-000188d0: 6e73 6665 726d 6174 696f 6e27 290d 0a20  nsfermation').. 
-000188e0: 2020 200d 0a20 2020 2077 6974 6820 6f70     ..    with op
-000188f0: 656e 2866 6e61 6d65 2b27 2e67 7264 272c  en(fname+'.grd',
-00018900: 2027 7227 2920 6173 2066 3a0d 0a20 2020   'r') as f:..   
-00018910: 2020 2020 206c 696e 6573 203d 2066 2e72       lines = f.r
-00018920: 6561 646c 696e 6573 2829 0d0a 2020 2020  eadlines()..    
-00018930: 2020 2020 6c69 6e65 2020 3d20 6c69 6e65      line  = line
-00018940: 735b 305d 2e73 706c 6974 2829 0d0a 2020  s[0].split()..  
-00018950: 2020 2020 2020 6e75 6d5f 626c 6f63 6b20        num_block 
-00018960: 3d20 696e 7428 6c69 6e65 5b30 5d29 0d0a  = int(line[0])..
-00018970: 2020 2020 2020 2020 6e49 4a4b 2020 3d20          nIJK  = 
-00018980: 6e70 2e7a 6572 6f73 285b 6e75 6d5f 626c  np.zeros([num_bl
-00018990: 6f63 6b2c 2035 5d2c 2064 7479 7065 3d69  ock, 5], dtype=i
-000189a0: 6e74 290d 0a0d 0a20 2020 2020 2020 2066  nt)....        f
-000189b0: 6f72 2069 2069 6e20 7261 6e67 6528 6e75  or i in range(nu
-000189c0: 6d5f 626c 6f63 6b29 3a0d 0a20 2020 2020  m_block):..     
-000189d0: 2020 2020 2020 206c 696e 6520 203d 206c         line  = l
-000189e0: 696e 6573 5b69 2b31 5d2e 7370 6c69 7428  ines[i+1].split(
-000189f0: 290d 0a20 2020 2020 2020 2020 2020 206e  )..            n
-00018a00: 494a 4b5b 692c 305d 203d 2069 6e74 286c  IJK[i,0] = int(l
-00018a10: 696e 655b 305d 290d 0a20 2020 2020 2020  ine[0])..       
-00018a20: 2020 2020 206e 494a 4b5b 692c 315d 203d       nIJK[i,1] =
-00018a30: 2069 6e74 286c 696e 655b 315d 290d 0a20   int(line[1]).. 
-00018a40: 2020 2020 2020 2020 2020 206e 494a 4b5b             nIJK[
-00018a50: 692c 325d 203d 2069 6e74 286c 696e 655b  i,2] = int(line[
-00018a60: 325d 290d 0a20 2020 2020 2020 2020 2020  2])..           
-00018a70: 206e 494a 4b5b 692c 335d 203d 2069 6461   nIJK[i,3] = ida
-00018a80: 7461 6c69 6e65 286e 494a 4b5b 692c 305d  taline(nIJK[i,0]
-00018a90: 2c20 6e49 4a4b 5b69 2c31 5d29 0d0a 0d0a  , nIJK[i,1])....
-00018aa0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00018ab0: 494a 4b5b 692c 325d 213d 313a 0d0a 2020  IJK[i,2]!=1:..  
-00018ac0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00018ad0: 6973 6520 4578 6365 7074 696f 6e28 2757  ise Exception('W
-00018ae0: 726f 6e67 2069 6e70 7574 2066 696c 653a  rong input file:
-00018af0: 2064 696d 656e 7369 6f6e 204b 2069 7320   dimension K is 
-00018b00: 6e6f 7420 3127 290d 0a0d 0a20 2020 2020  not 1')....     
-00018b10: 2020 2020 2020 2069 6620 6e49 4a4b 5b69         if nIJK[i
-00018b20: 2c30 5d3c 3420 6f72 206e 494a 4b5b 692c  ,0]<4 or nIJK[i,
-00018b30: 315d 3c34 3a0d 0a20 2020 2020 2020 2020  1]<4:..         
-00018b40: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
-00018b50: 6570 7469 6f6e 2827 5772 6f6e 6720 696e  eption('Wrong in
-00018b60: 7075 7420 6669 6c65 3a20 6469 6d65 6e73  put file: dimens
-00018b70: 696f 6e20 4920 6f72 204a 206c 6573 7320  ion I or J less 
-00018b80: 7468 616e 2034 2729 0d0a 0d0a 2020 2020  than 4')....    
-00018b90: 2020 2020 6e49 4a4b 5b30 2c34 5d20 3d20      nIJK[0,4] = 
-00018ba0: 310d 0a20 2020 2020 2020 2066 6f72 2069  1..        for i
-00018bb0: 2069 6e20 7261 6e67 6528 312c 206e 756d   in range(1, num
-00018bc0: 5f62 6c6f 636b 293a 0d0a 2020 2020 2020  _block):..      
-00018bd0: 2020 2020 2020 6e49 4a4b 5b69 2c34 5d20        nIJK[i,4] 
-00018be0: 3d20 6e49 4a4b 5b69 2d31 2c33 5d20 2b20  = nIJK[i-1,3] + 
-00018bf0: 6e49 4a4b 5b69 2d31 2c34 5d0d 0a0d 0a20  nIJK[i-1,4].... 
-00018c00: 2020 2020 2020 206b 4c69 6e65 203d 206e         kLine = n
-00018c10: 756d 5f62 6c6f 636b 2b31 0d0a 0d0a 2020  um_block+1....  
-00018c20: 2020 232a 204f 7574 7075 7420 4947 4553    #* Output IGES
-00018c30: 2066 6f72 6d61 7420 6669 6c65 0d0a 2020   format file..  
-00018c40: 2020 6620 3d20 6f70 656e 2866 6e61 6d65    f = open(fname
-00018c50: 2b27 2e69 6773 272c 2027 7727 290d 0a0d  +'.igs', 'w')...
-00018c60: 0a20 2020 2023 2a20 5374 6172 7420 7365  .    #* Start se
-00018c70: 6374 696f 6e20 616e 6420 676c 6f62 616c  ction and global
-00018c80: 2073 6563 7469 6f6e 0d0a 2020 2020 662e   section..    f.
-00018c90: 7772 6974 6528 2754 6869 7320 6973 2069  write('This is i
-00018ca0: 6773 2066 696c 6520 6765 6e65 7261 7465  gs file generate
-00018cb0: 6420 6279 205a 4841 4e47 2059 7566 6569  d by ZHANG Yufei
-00018cc0: 2e20 416c 6c20 7269 6768 7473 2072 6573  . All rights res
-00018cd0: 6572 7665 642e 2020 2020 2020 2020 2053  erved.         S
-00018ce0: 2020 2020 2020 315c 6e27 290d 0a20 2020        1\n')..   
-00018cf0: 2066 2e77 7269 7465 2827 3148 2c2c 3148   f.write('1H,,1H
-00018d00: 3b2c 3348 6967 732c 3748 6967 732e 6967  ;,3Higs,7Higs.ig
-00018d10: 732c 3434 4844 4153 5341 554c 5420 5359  s,44HDASSAULT SY
-00018d20: 5354 454d 4553 2043 4154 4941 2056 3520  STEMES CATIA V5 
-00018d30: 5232 3020 2d20 7777 772e 3364 732e 636f  R20 - www.3ds.co
-00018d40: 6d2c 4720 2020 2020 2031 5c6e 2729 0d0a  m,G      1\n')..
-00018d50: 2020 2020 662e 7772 6974 6528 2732 3748      f.write('27H
-00018d60: 4341 5449 4120 5665 7273 696f 6e20 3520  CATIA Version 5 
-00018d70: 5265 6c65 6173 6520 3230 202c 3332 2c37  Release 20 ,32,7
-00018d80: 352c 362c 3735 2c31 352c 3348 6967 732c  5,6,75,15,3Higs,
-00018d90: 312e 302c 322c 3248 4d4d 2c31 3030 302c  1.0,2,2HMM,1000,
-00018da0: 312e 302c 2047 2020 2020 2020 325c 6e27  1.0, G      2\n'
-00018db0: 290d 0a20 2020 2066 2e77 7269 7465 2827  )..    f.write('
-00018dc0: 3135 4832 3031 3830 3331 312e 3232 3338  15H20180311.2238
-00018dd0: 3130 2c30 2e30 3031 2c31 3030 3030 2e30  10,0.001,10000.0
-00018de0: 2c35 4879 616e 6379 2c31 3548 4445 534b  ,5Hyancy,15HDESK
-00018df0: 544f 502d 4245 504e 524f 482c 3131 2c30  TOP-BEPNROH,11,0
-00018e00: 2c31 3548 3230 3138 4720 2020 2020 2033  ,15H2018G      3
-00018e10: 5c6e 2729 0d0a 2020 2020 662e 7772 6974  \n')..    f.writ
-00018e20: 6528 2730 3331 312e 3232 3338 3130 2c3b  e('0311.223810,;
+00018700: 2069 6920 2b3d 2031 0d0a 2020 2020 2020   ii += 1..      
+00018710: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00018720: 2069 6925 333d 3d30 206f 7220 2869 3d3d   ii%3==0 or (i==
+00018730: 6e73 2d31 2061 6e64 206a 3d3d 6e6e 2d31  ns-1 and j==nn-1
+00018740: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00018750: 2020 2020 2020 2020 2020 2020 662e 7772              f.wr
+00018760: 6974 6528 2720 5c6e 2027 290d 0a0d 0a64  ite(' \n ')....d
+00018770: 6566 2070 6c6f 7433 645f 746f 5f69 6773  ef plot3d_to_igs
+00018780: 2866 6e61 6d65 3d27 6967 7327 293a 0d0a  (fname='igs'):..
+00018790: 2020 2020 2727 270d 0a20 2020 2043 6f6e      '''..    Con
+000187a0: 7665 7274 7320 506c 6f74 3364 2073 7572  verts Plot3d sur
+000187b0: 6661 6365 2067 7269 6420 6669 6c65 205b  face grid file [
+000187c0: 666e 616d 652e 6772 645d 2074 6f20 4947  fname.grd] to IG
+000187d0: 4553 2066 696c 6520 5b66 6e61 6d65 2e69  ES file [fname.i
+000187e0: 6773 5d2e 0d0a 2020 2020 0d0a 2020 2020  gs]...    ..    
+000187f0: 4f72 6967 696e 616c 2046 6f72 7472 616e  Original Fortran
+00018800: 2076 6572 7369 6f6e 2062 7920 5072 6f66   version by Prof
+00018810: 2e20 5a68 616e 6720 5975 6665 693a 207a  . Zhang Yufei: z
+00018820: 6861 6e67 7975 6665 6940 7473 696e 6768  hangyufei@tsingh
+00018830: 7561 2e65 6475 2e63 6e2e 0d0a 2020 2020  ua.edu.cn...    
+00018840: 2727 270d 0a0d 0a20 2020 2023 2a20 5265  '''....    #* Re
+00018850: 6164 2070 6c6f 7433 6420 666f 726d 6174  ad plot3d format
+00018860: 2066 696c 650d 0a20 2020 2069 6620 6e6f   file..    if no
+00018870: 7420 6f73 2e70 6174 682e 6578 6973 7473  t os.path.exists
+00018880: 2866 6e61 6d65 2b27 2e67 7264 2729 3a0d  (fname+'.grd'):.
+00018890: 0a20 2020 2020 2020 2072 6169 7365 2045  .        raise E
+000188a0: 7863 6570 7469 6f6e 2866 6e61 6d65 2b27  xception(fname+'
+000188b0: 2064 6f65 7320 6e6f 7420 6578 6973 7420   does not exist 
+000188c0: 666f 7220 666f 726d 6174 2074 7261 6e73  for format trans
+000188d0: 6665 726d 6174 696f 6e27 290d 0a20 2020  fermation')..   
+000188e0: 200d 0a20 2020 2077 6974 6820 6f70 656e   ..    with open
+000188f0: 2866 6e61 6d65 2b27 2e67 7264 272c 2027  (fname+'.grd', '
+00018900: 7227 2920 6173 2066 3a0d 0a20 2020 2020  r') as f:..     
+00018910: 2020 206c 696e 6573 203d 2066 2e72 6561     lines = f.rea
+00018920: 646c 696e 6573 2829 0d0a 2020 2020 2020  dlines()..      
+00018930: 2020 6c69 6e65 2020 3d20 6c69 6e65 735b    line  = lines[
+00018940: 305d 2e73 706c 6974 2829 0d0a 2020 2020  0].split()..    
+00018950: 2020 2020 6e75 6d5f 626c 6f63 6b20 3d20      num_block = 
+00018960: 696e 7428 6c69 6e65 5b30 5d29 0d0a 2020  int(line[0])..  
+00018970: 2020 2020 2020 6e49 4a4b 2020 3d20 6e70        nIJK  = np
+00018980: 2e7a 6572 6f73 285b 6e75 6d5f 626c 6f63  .zeros([num_bloc
+00018990: 6b2c 2035 5d2c 2064 7479 7065 3d69 6e74  k, 5], dtype=int
+000189a0: 290d 0a0d 0a20 2020 2020 2020 2066 6f72  )....        for
+000189b0: 2069 2069 6e20 7261 6e67 6528 6e75 6d5f   i in range(num_
+000189c0: 626c 6f63 6b29 3a0d 0a20 2020 2020 2020  block):..       
+000189d0: 2020 2020 206c 696e 6520 203d 206c 696e       line  = lin
+000189e0: 6573 5b69 2b31 5d2e 7370 6c69 7428 290d  es[i+1].split().
+000189f0: 0a20 2020 2020 2020 2020 2020 206e 494a  .            nIJ
+00018a00: 4b5b 692c 305d 203d 2069 6e74 286c 696e  K[i,0] = int(lin
+00018a10: 655b 305d 290d 0a20 2020 2020 2020 2020  e[0])..         
+00018a20: 2020 206e 494a 4b5b 692c 315d 203d 2069     nIJK[i,1] = i
+00018a30: 6e74 286c 696e 655b 315d 290d 0a20 2020  nt(line[1])..   
+00018a40: 2020 2020 2020 2020 206e 494a 4b5b 692c           nIJK[i,
+00018a50: 325d 203d 2069 6e74 286c 696e 655b 325d  2] = int(line[2]
+00018a60: 290d 0a20 2020 2020 2020 2020 2020 206e  )..            n
+00018a70: 494a 4b5b 692c 335d 203d 2069 6461 7461  IJK[i,3] = idata
+00018a80: 6c69 6e65 286e 494a 4b5b 692c 305d 2c20  line(nIJK[i,0], 
+00018a90: 6e49 4a4b 5b69 2c31 5d29 0d0a 0d0a 2020  nIJK[i,1])....  
+00018aa0: 2020 2020 2020 2020 2020 6966 206e 494a            if nIJ
+00018ab0: 4b5b 692c 325d 213d 313a 0d0a 2020 2020  K[i,2]!=1:..    
+00018ac0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00018ad0: 6520 4578 6365 7074 696f 6e28 2757 726f  e Exception('Wro
+00018ae0: 6e67 2069 6e70 7574 2066 696c 653a 2064  ng input file: d
+00018af0: 696d 656e 7369 6f6e 204b 2069 7320 6e6f  imension K is no
+00018b00: 7420 3127 290d 0a0d 0a20 2020 2020 2020  t 1')....       
+00018b10: 2020 2020 2069 6620 6e49 4a4b 5b69 2c30       if nIJK[i,0
+00018b20: 5d3c 3420 6f72 206e 494a 4b5b 692c 315d  ]<4 or nIJK[i,1]
+00018b30: 3c34 3a0d 0a20 2020 2020 2020 2020 2020  <4:..           
+00018b40: 2020 2020 2072 6169 7365 2045 7863 6570       raise Excep
+00018b50: 7469 6f6e 2827 5772 6f6e 6720 696e 7075  tion('Wrong inpu
+00018b60: 7420 6669 6c65 3a20 6469 6d65 6e73 696f  t file: dimensio
+00018b70: 6e20 4920 6f72 204a 206c 6573 7320 7468  n I or J less th
+00018b80: 616e 2034 2729 0d0a 0d0a 2020 2020 2020  an 4')....      
+00018b90: 2020 6e49 4a4b 5b30 2c34 5d20 3d20 310d    nIJK[0,4] = 1.
+00018ba0: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+00018bb0: 6e20 7261 6e67 6528 312c 206e 756d 5f62  n range(1, num_b
+00018bc0: 6c6f 636b 293a 0d0a 2020 2020 2020 2020  lock):..        
+00018bd0: 2020 2020 6e49 4a4b 5b69 2c34 5d20 3d20      nIJK[i,4] = 
+00018be0: 6e49 4a4b 5b69 2d31 2c33 5d20 2b20 6e49  nIJK[i-1,3] + nI
+00018bf0: 4a4b 5b69 2d31 2c34 5d0d 0a0d 0a20 2020  JK[i-1,4]....   
+00018c00: 2020 2020 206b 4c69 6e65 203d 206e 756d       kLine = num
+00018c10: 5f62 6c6f 636b 2b31 0d0a 0d0a 2020 2020  _block+1....    
+00018c20: 232a 204f 7574 7075 7420 4947 4553 2066  #* Output IGES f
+00018c30: 6f72 6d61 7420 6669 6c65 0d0a 2020 2020  ormat file..    
+00018c40: 6620 3d20 6f70 656e 2866 6e61 6d65 2b27  f = open(fname+'
+00018c50: 2e69 6773 272c 2027 7727 290d 0a0d 0a20  .igs', 'w').... 
+00018c60: 2020 2023 2a20 5374 6172 7420 7365 6374     #* Start sect
+00018c70: 696f 6e20 616e 6420 676c 6f62 616c 2073  ion and global s
+00018c80: 6563 7469 6f6e 0d0a 2020 2020 662e 7772  ection..    f.wr
+00018c90: 6974 6528 2754 6869 7320 6973 2069 6773  ite('This is igs
+00018ca0: 2066 696c 6520 6765 6e65 7261 7465 6420   file generated 
+00018cb0: 6279 205a 4841 4e47 2059 7566 6569 2e20  by ZHANG Yufei. 
+00018cc0: 416c 6c20 7269 6768 7473 2072 6573 6572  All rights reser
+00018cd0: 7665 642e 2020 2020 2020 2020 2053 2020  ved.         S  
+00018ce0: 2020 2020 315c 6e27 290d 0a20 2020 2066      1\n')..    f
+00018cf0: 2e77 7269 7465 2827 3148 2c2c 3148 3b2c  .write('1H,,1H;,
+00018d00: 3348 6967 732c 3748 6967 732e 6967 732c  3Higs,7Higs.igs,
+00018d10: 3434 4844 4153 5341 554c 5420 5359 5354  44HDASSAULT SYST
+00018d20: 454d 4553 2043 4154 4941 2056 3520 5232  EMES CATIA V5 R2
+00018d30: 3020 2d20 7777 772e 3364 732e 636f 6d2c  0 - www.3ds.com,
+00018d40: 4720 2020 2020 2031 5c6e 2729 0d0a 2020  G      1\n')..  
+00018d50: 2020 662e 7772 6974 6528 2732 3748 4341    f.write('27HCA
+00018d60: 5449 4120 5665 7273 696f 6e20 3520 5265  TIA Version 5 Re
+00018d70: 6c65 6173 6520 3230 202c 3332 2c37 352c  lease 20 ,32,75,
+00018d80: 362c 3735 2c31 352c 3348 6967 732c 312e  6,75,15,3Higs,1.
+00018d90: 302c 322c 3248 4d4d 2c31 3030 302c 312e  0,2,2HMM,1000,1.
+00018da0: 302c 2047 2020 2020 2020 325c 6e27 290d  0, G      2\n').
+00018db0: 0a20 2020 2066 2e77 7269 7465 2827 3135  .    f.write('15
+00018dc0: 4832 3031 3830 3331 312e 3232 3338 3130  H20180311.223810
+00018dd0: 2c30 2e30 3031 2c31 3030 3030 2e30 2c35  ,0.001,10000.0,5
+00018de0: 4879 616e 6379 2c31 3548 4445 534b 544f  Hyancy,15HDESKTO
+00018df0: 502d 4245 504e 524f 482c 3131 2c30 2c31  P-BEPNROH,11,0,1
+00018e00: 3548 3230 3138 4720 2020 2020 2033 5c6e  5H2018G      3\n
+00018e10: 2729 0d0a 2020 2020 662e 7772 6974 6528  ')..    f.write(
+00018e20: 2730 3331 312e 3232 3338 3130 2c3b 2020  '0311.223810,;  
 00018e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00018e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00018e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e60: 2020 2020 2020 2020 2020 2047 2020 2020             G    
-00018e70: 2020 345c 6e27 290d 0a0d 0a20 2020 2023    4\n')....    #
-00018e80: 2a20 496e 6465 7820 7365 6374 696f 6e0d  * Index section.
-00018e90: 0a20 2020 2069 5479 7065 203d 2031 3238  .    iType = 128
-00018ea0: 0d0a 2020 2020 666f 7220 6962 2069 6e20  ..    for ib in 
-00018eb0: 7261 6e67 6528 6e75 6d5f 626c 6f63 6b29  range(num_block)
-00018ec0: 3a0d 0a20 2020 2020 2020 2069 4c69 6e65  :..        iLine
-00018ed0: 5374 6172 7420 3d20 6e49 4a4b 5b69 622c  Start = nIJK[ib,
-00018ee0: 2034 5d0d 0a20 2020 2020 2020 2069 4c69   4]..        iLi
-00018ef0: 6e65 456e 6420 2020 3d20 6e49 4a4b 5b69  neEnd   = nIJK[i
-00018f00: 622c 2033 5d0d 0a0d 0a20 2020 2020 2020  b, 3]....       
-00018f10: 2066 2e77 7269 7465 2827 2025 3764 2025   f.write(' %7d %
-00018f20: 3764 2025 3764 2025 3764 2025 3764 2025  7d %7d %7d %7d %
-00018f30: 3764 2025 3764 2025 3764 2725 2869 5479  7d %7d %7d'%(iTy
-00018f40: 7065 2c20 694c 696e 6553 7461 7274 2c20  pe, iLineStart, 
-00018f50: 302c 2030 2c20 302c 2030 2c20 302c 2030  0, 0, 0, 0, 0, 0
-00018f60: 2929 0d0a 2020 2020 2020 2020 662e 7772  ))..        f.wr
-00018f70: 6974 6528 2720 2531 6420 2531 6420 2531  ite(' %1d %1d %1
-00018f80: 6420 2531 6444 2025 3664 5c6e 2725 2830  d %1dD %6d\n'%(0
-00018f90: 2c20 302c 2030 2c20 302c 2069 622a 322b  , 0, 0, 0, ib*2+
-00018fa0: 3129 290d 0a20 2020 2020 2020 2066 2e77  1))..        f.w
-00018fb0: 7269 7465 2827 2025 3764 2025 3764 2025  rite(' %7d %7d %
-00018fc0: 3764 2025 3764 2025 3764 2725 2869 5479  7d %7d %7d'%(iTy
-00018fd0: 7065 2c20 302c 2030 2c20 694c 696e 6545  pe, 0, 0, iLineE
-00018fe0: 6e64 2c20 3029 290d 0a20 2020 2020 2020  nd, 0))..       
-00018ff0: 2069 6620 6962 3c39 3a0d 0a20 2020 2020   if ib<9:..     
-00019000: 2020 2020 2020 2066 2e77 7269 7465 2827         f.write('
-00019010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019020: 4253 7020 5375 7266 2531 6420 2020 2020  BSp Surf%1d     
-00019030: 2030 4420 2536 645c 6e27 2528 6962 2b31   0D %6d\n'%(ib+1
-00019040: 2c20 6962 2a32 2b32 2929 0d0a 2020 2020  , ib*2+2))..    
-00019050: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00019060: 2020 2020 2020 2066 2e77 7269 7465 2827         f.write('
-00019070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019080: 4253 7020 5375 7266 2532 6420 2020 2020  BSp Surf%2d     
-00019090: 3044 2025 3664 5c6e 2725 2869 622b 312c  0D %6d\n'%(ib+1,
-000190a0: 2069 622a 322b 3229 290d 0a0d 0a20 2020   ib*2+2))....   
-000190b0: 2023 2a20 4461 7461 2073 6563 7469 6f6e   #* Data section
-000190c0: 0d0a 2020 2020 694c 696e 6520 3d20 300d  ..    iLine = 0.
-000190d0: 0a20 2020 2066 6f72 2069 6220 696e 2072  .    for ib in r
-000190e0: 616e 6765 286e 756d 5f62 6c6f 636b 293a  ange(num_block):
-000190f0: 0d0a 2020 2020 2020 2020 6e69 203d 206e  ..        ni = n
-00019100: 494a 4b5b 6962 2c20 305d 0d0a 2020 2020  IJK[ib, 0]..    
-00019110: 2020 2020 6e6a 203d 206e 494a 4b5b 6962      nj = nIJK[ib
-00019120: 2c20 315d 0d0a 2020 2020 2020 2020 6e6b  , 1]..        nk
-00019130: 203d 206e 494a 4b5b 6962 2c20 325d 0d0a   = nIJK[ib, 2]..
-00019140: 0d0a 2020 2020 2020 2020 2320 5374 6172  ..        # Star
-00019150: 7469 6e67 0d0a 2020 2020 2020 2020 694c  ting..        iL
-00019160: 696e 6520 2b3d 2031 0d0a 2020 2020 2020  ine += 1..      
-00019170: 2020 662e 7772 6974 6528 2720 2534 642c    f.write(' %4d,
-00019180: 2025 3464 2c20 2534 642c 2025 3464 2c20   %4d, %4d, %4d, 
-00019190: 2534 642c 2725 2869 5479 7065 2c20 6e69  %4d,'%(iType, ni
-000191a0: 2d31 2c20 6e6a 2d31 2c20 332c 2033 2929  -1, nj-1, 3, 3))
-000191b0: 0d0a 2020 2020 2020 2020 662e 7772 6974  ..        f.writ
-000191c0: 6528 2720 2534 642c 2025 3464 2c20 2534  e(' %4d, %4d, %4
-000191d0: 642c 2025 3464 2c20 2534 642c 2025 3131  d, %4d, %4d, %11
-000191e0: 6450 2025 3664 5c6e 2725 2830 2c20 302c  dP %6d\n'%(0, 0,
-000191f0: 2031 2c20 302c 2030 2c20 6962 2a32 2b31   1, 0, 0, ib*2+1
-00019200: 2c20 694c 696e 6529 290d 0a0d 0a20 2020  , iLine))....   
-00019210: 2020 2020 2023 204e 6f64 6520 7665 6374       # Node vect
-00019220: 6f72 0d0a 2020 2020 2020 2020 784b 6e6f  or..        xKno
-00019230: 7420 3d20 6b6e 6f74 7828 6e69 290d 0a20  t = knotx(ni).. 
-00019240: 2020 2020 2020 2066 6f72 2069 7820 696e         for ix in
-00019250: 2072 616e 6765 286e 692b 3429 3a0d 0a20   range(ni+4):.. 
-00019260: 2020 2020 2020 2020 2020 2069 4c69 6e65             iLine
-00019270: 202b 3d20 310d 0a20 2020 2020 2020 2020   += 1..         
-00019280: 2020 2066 2e77 7269 7465 2827 2531 392e     f.write('%19.
-00019290: 3130 652c 2025 3531 6450 2025 3664 5c6e  10e, %51dP %6d\n
-000192a0: 2725 2878 4b6e 6f74 5b69 785d 2c20 6962  '%(xKnot[ix], ib
-000192b0: 2a32 2b31 2c20 694c 696e 6529 290d 0a20  *2+1, iLine)).. 
-000192c0: 2020 2020 2020 2078 696d 696e 203d 2078         ximin = x
-000192d0: 4b6e 6f74 5b30 5d0d 0a20 2020 2020 2020  Knot[0]..       
-000192e0: 2078 696d 6178 203d 2078 4b6e 6f74 5b2d   ximax = xKnot[-
-000192f0: 315d 0d0a 0d0a 2020 2020 2020 2020 784b  1]....        xK
-00019300: 6e6f 7420 3d20 6b6e 6f74 7828 6e6a 290d  not = knotx(nj).
-00019310: 0a20 2020 2020 2020 2066 6f72 2069 7820  .        for ix 
-00019320: 696e 2072 616e 6765 286e 6a2b 3429 3a0d  in range(nj+4):.
-00019330: 0a20 2020 2020 2020 2020 2020 2069 4c69  .            iLi
-00019340: 6e65 202b 3d20 310d 0a20 2020 2020 2020  ne += 1..       
-00019350: 2020 2020 2066 2e77 7269 7465 2827 2531       f.write('%1
-00019360: 392e 3130 652c 2025 3531 6450 2025 3664  9.10e, %51dP %6d
-00019370: 5c6e 2725 2878 4b6e 6f74 5b69 785d 2c20  \n'%(xKnot[ix], 
-00019380: 6962 2a32 2b31 2c20 694c 696e 6529 290d  ib*2+1, iLine)).
-00019390: 0a20 2020 2020 2020 2078 6a6d 696e 203d  .        xjmin =
-000193a0: 2078 4b6e 6f74 5b30 5d0d 0a20 2020 2020   xKnot[0]..     
-000193b0: 2020 2078 6a6d 6178 203d 2078 4b6e 6f74     xjmax = xKnot
-000193c0: 5b2d 315d 0d0a 0d0a 2020 2020 2020 2020  [-1]....        
-000193d0: 2320 4e6f 6465 2077 6569 6768 740d 0a20  # Node weight.. 
-000193e0: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
-000193f0: 7261 6e67 6528 6e6a 293a 0d0a 2020 2020  range(nj):..    
-00019400: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00019410: 2072 616e 6765 286e 6929 3a0d 0a20 2020   range(ni):..   
-00019420: 2020 2020 2020 2020 2020 2020 2069 4c69               iLi
-00019430: 6e65 202b 3d20 310d 0a20 2020 2020 2020  ne += 1..       
-00019440: 2020 2020 2020 2020 2066 2e77 7269 7465           f.write
-00019450: 2827 2531 392e 3130 652c 2025 3531 6450  ('%19.10e, %51dP
-00019460: 2025 3664 5c6e 2725 2831 2e30 2c20 6962   %6d\n'%(1.0, ib
-00019470: 2a32 2b31 2c20 694c 696e 6529 290d 0a0d  *2+1, iLine))...
-00019480: 0a20 2020 2020 2020 2023 204e 6f64 6520  .        # Node 
-00019490: 636f 6f72 6469 6e61 7465 730d 0a20 2020  coordinates..   
-000194a0: 2020 2020 2078 797a 2c20 6b4c 696e 6520       xyz, kLine 
-000194b0: 3d20 7265 6164 5f62 6c6f 636b 5f70 6c6f  = read_block_plo
-000194c0: 7433 6428 6c69 6e65 732c 206b 4c69 6e65  t3d(lines, kLine
-000194d0: 2c20 6e69 2c20 6e6a 2c20 6e6b 290d 0a20  , ni, nj, nk).. 
-000194e0: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
-000194f0: 7261 6e67 6528 6e6b 293a 0d0a 2020 2020  range(nk):..    
-00019500: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
-00019510: 2072 616e 6765 286e 6a29 3a0d 0a20 2020   range(nj):..   
-00019520: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00019530: 2069 2069 6e20 7261 6e67 6528 6e69 293a   i in range(ni):
-00019540: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019550: 2020 2020 2020 694c 696e 6520 2b3d 2031        iLine += 1
-00019560: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019570: 2020 2020 2020 662e 7772 6974 6528 2725        f.write('%
-00019580: 3139 2e31 3065 2c25 3139 2e31 3065 2c25  19.10e,%19.10e,%
-00019590: 3139 2e31 3065 2c25 3132 6450 2025 3664  19.10e,%12dP %6d
-000195a0: 5c6e 2725 280d 0a20 2020 2020 2020 2020  \n'%(..         
-000195b0: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-000195c0: 797a 5b69 2c6a 2c6b 2c30 5d2c 2078 797a  yz[i,j,k,0], xyz
-000195d0: 5b69 2c6a 2c6b 2c31 5d2c 2078 797a 5b69  [i,j,k,1], xyz[i
-000195e0: 2c6a 2c6b 2c32 5d2c 0d0a 2020 2020 2020  ,j,k,2],..      
+00018e60: 2020 2020 2020 2020 2047 2020 2020 2020           G      
+00018e70: 345c 6e27 290d 0a0d 0a20 2020 2023 2a20  4\n')....    #* 
+00018e80: 496e 6465 7820 7365 6374 696f 6e0d 0a20  Index section.. 
+00018e90: 2020 2069 5479 7065 203d 2031 3238 0d0a     iType = 128..
+00018ea0: 2020 2020 666f 7220 6962 2069 6e20 7261      for ib in ra
+00018eb0: 6e67 6528 6e75 6d5f 626c 6f63 6b29 3a0d  nge(num_block):.
+00018ec0: 0a20 2020 2020 2020 2069 4c69 6e65 5374  .        iLineSt
+00018ed0: 6172 7420 3d20 6e49 4a4b 5b69 622c 2034  art = nIJK[ib, 4
+00018ee0: 5d0d 0a20 2020 2020 2020 2069 4c69 6e65  ]..        iLine
+00018ef0: 456e 6420 2020 3d20 6e49 4a4b 5b69 622c  End   = nIJK[ib,
+00018f00: 2033 5d0d 0a0d 0a20 2020 2020 2020 2066   3]....        f
+00018f10: 2e77 7269 7465 2827 2025 3764 2025 3764  .write(' %7d %7d
+00018f20: 2025 3764 2025 3764 2025 3764 2025 3764   %7d %7d %7d %7d
+00018f30: 2025 3764 2025 3764 2725 2869 5479 7065   %7d %7d'%(iType
+00018f40: 2c20 694c 696e 6553 7461 7274 2c20 302c  , iLineStart, 0,
+00018f50: 2030 2c20 302c 2030 2c20 302c 2030 2929   0, 0, 0, 0, 0))
+00018f60: 0d0a 2020 2020 2020 2020 662e 7772 6974  ..        f.writ
+00018f70: 6528 2720 2531 6420 2531 6420 2531 6420  e(' %1d %1d %1d 
+00018f80: 2531 6444 2025 3664 5c6e 2725 2830 2c20  %1dD %6d\n'%(0, 
+00018f90: 302c 2030 2c20 302c 2069 622a 322b 3129  0, 0, 0, ib*2+1)
+00018fa0: 290d 0a20 2020 2020 2020 2066 2e77 7269  )..        f.wri
+00018fb0: 7465 2827 2025 3764 2025 3764 2025 3764  te(' %7d %7d %7d
+00018fc0: 2025 3764 2025 3764 2725 2869 5479 7065   %7d %7d'%(iType
+00018fd0: 2c20 302c 2030 2c20 694c 696e 6545 6e64  , 0, 0, iLineEnd
+00018fe0: 2c20 3029 290d 0a20 2020 2020 2020 2069  , 0))..        i
+00018ff0: 6620 6962 3c39 3a0d 0a20 2020 2020 2020  f ib<9:..       
+00019000: 2020 2020 2066 2e77 7269 7465 2827 2020       f.write('  
+00019010: 2020 2020 2020 2020 2020 2020 2020 4253                BS
+00019020: 7020 5375 7266 2531 6420 2020 2020 2030  p Surf%1d      0
+00019030: 4420 2536 645c 6e27 2528 6962 2b31 2c20  D %6d\n'%(ib+1, 
+00019040: 6962 2a32 2b32 2929 0d0a 2020 2020 2020  ib*2+2))..      
+00019050: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00019060: 2020 2020 2066 2e77 7269 7465 2827 2020       f.write('  
+00019070: 2020 2020 2020 2020 2020 2020 2020 4253                BS
+00019080: 7020 5375 7266 2532 6420 2020 2020 3044  p Surf%2d     0D
+00019090: 2025 3664 5c6e 2725 2869 622b 312c 2069   %6d\n'%(ib+1, i
+000190a0: 622a 322b 3229 290d 0a0d 0a20 2020 2023  b*2+2))....    #
+000190b0: 2a20 4461 7461 2073 6563 7469 6f6e 0d0a  * Data section..
+000190c0: 2020 2020 694c 696e 6520 3d20 300d 0a20      iLine = 0.. 
+000190d0: 2020 2066 6f72 2069 6220 696e 2072 616e     for ib in ran
+000190e0: 6765 286e 756d 5f62 6c6f 636b 293a 0d0a  ge(num_block):..
+000190f0: 2020 2020 2020 2020 6e69 203d 206e 494a          ni = nIJ
+00019100: 4b5b 6962 2c20 305d 0d0a 2020 2020 2020  K[ib, 0]..      
+00019110: 2020 6e6a 203d 206e 494a 4b5b 6962 2c20    nj = nIJK[ib, 
+00019120: 315d 0d0a 2020 2020 2020 2020 6e6b 203d  1]..        nk =
+00019130: 206e 494a 4b5b 6962 2c20 325d 0d0a 0d0a   nIJK[ib, 2]....
+00019140: 2020 2020 2020 2020 2320 5374 6172 7469          # Starti
+00019150: 6e67 0d0a 2020 2020 2020 2020 694c 696e  ng..        iLin
+00019160: 6520 2b3d 2031 0d0a 2020 2020 2020 2020  e += 1..        
+00019170: 662e 7772 6974 6528 2720 2534 642c 2025  f.write(' %4d, %
+00019180: 3464 2c20 2534 642c 2025 3464 2c20 2534  4d, %4d, %4d, %4
+00019190: 642c 2725 2869 5479 7065 2c20 6e69 2d31  d,'%(iType, ni-1
+000191a0: 2c20 6e6a 2d31 2c20 332c 2033 2929 0d0a  , nj-1, 3, 3))..
+000191b0: 2020 2020 2020 2020 662e 7772 6974 6528          f.write(
+000191c0: 2720 2534 642c 2025 3464 2c20 2534 642c  ' %4d, %4d, %4d,
+000191d0: 2025 3464 2c20 2534 642c 2025 3131 6450   %4d, %4d, %11dP
+000191e0: 2025 3664 5c6e 2725 2830 2c20 302c 2031   %6d\n'%(0, 0, 1
+000191f0: 2c20 302c 2030 2c20 6962 2a32 2b31 2c20  , 0, 0, ib*2+1, 
+00019200: 694c 696e 6529 290d 0a0d 0a20 2020 2020  iLine))....     
+00019210: 2020 2023 204e 6f64 6520 7665 6374 6f72     # Node vector
+00019220: 0d0a 2020 2020 2020 2020 784b 6e6f 7420  ..        xKnot 
+00019230: 3d20 6b6e 6f74 7828 6e69 290d 0a20 2020  = knotx(ni)..   
+00019240: 2020 2020 2066 6f72 2069 7820 696e 2072       for ix in r
+00019250: 616e 6765 286e 692b 3429 3a0d 0a20 2020  ange(ni+4):..   
+00019260: 2020 2020 2020 2020 2069 4c69 6e65 202b           iLine +
+00019270: 3d20 310d 0a20 2020 2020 2020 2020 2020  = 1..           
+00019280: 2066 2e77 7269 7465 2827 2531 392e 3130   f.write('%19.10
+00019290: 652c 2025 3531 6450 2025 3664 5c6e 2725  e, %51dP %6d\n'%
+000192a0: 2878 4b6e 6f74 5b69 785d 2c20 6962 2a32  (xKnot[ix], ib*2
+000192b0: 2b31 2c20 694c 696e 6529 290d 0a20 2020  +1, iLine))..   
+000192c0: 2020 2020 2078 696d 696e 203d 2078 4b6e       ximin = xKn
+000192d0: 6f74 5b30 5d0d 0a20 2020 2020 2020 2078  ot[0]..        x
+000192e0: 696d 6178 203d 2078 4b6e 6f74 5b2d 315d  imax = xKnot[-1]
+000192f0: 0d0a 0d0a 2020 2020 2020 2020 784b 6e6f  ....        xKno
+00019300: 7420 3d20 6b6e 6f74 7828 6e6a 290d 0a20  t = knotx(nj).. 
+00019310: 2020 2020 2020 2066 6f72 2069 7820 696e         for ix in
+00019320: 2072 616e 6765 286e 6a2b 3429 3a0d 0a20   range(nj+4):.. 
+00019330: 2020 2020 2020 2020 2020 2069 4c69 6e65             iLine
+00019340: 202b 3d20 310d 0a20 2020 2020 2020 2020   += 1..         
+00019350: 2020 2066 2e77 7269 7465 2827 2531 392e     f.write('%19.
+00019360: 3130 652c 2025 3531 6450 2025 3664 5c6e  10e, %51dP %6d\n
+00019370: 2725 2878 4b6e 6f74 5b69 785d 2c20 6962  '%(xKnot[ix], ib
+00019380: 2a32 2b31 2c20 694c 696e 6529 290d 0a20  *2+1, iLine)).. 
+00019390: 2020 2020 2020 2078 6a6d 696e 203d 2078         xjmin = x
+000193a0: 4b6e 6f74 5b30 5d0d 0a20 2020 2020 2020  Knot[0]..       
+000193b0: 2078 6a6d 6178 203d 2078 4b6e 6f74 5b2d   xjmax = xKnot[-
+000193c0: 315d 0d0a 0d0a 2020 2020 2020 2020 2320  1]....        # 
+000193d0: 4e6f 6465 2077 6569 6768 740d 0a20 2020  Node weight..   
+000193e0: 2020 2020 2066 6f72 206a 2069 6e20 7261       for j in ra
+000193f0: 6e67 6528 6e6a 293a 0d0a 2020 2020 2020  nge(nj):..      
+00019400: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00019410: 616e 6765 286e 6929 3a0d 0a20 2020 2020  ange(ni):..     
+00019420: 2020 2020 2020 2020 2020 2069 4c69 6e65             iLine
+00019430: 202b 3d20 310d 0a20 2020 2020 2020 2020   += 1..         
+00019440: 2020 2020 2020 2066 2e77 7269 7465 2827         f.write('
+00019450: 2531 392e 3130 652c 2025 3531 6450 2025  %19.10e, %51dP %
+00019460: 3664 5c6e 2725 2831 2e30 2c20 6962 2a32  6d\n'%(1.0, ib*2
+00019470: 2b31 2c20 694c 696e 6529 290d 0a0d 0a20  +1, iLine)).... 
+00019480: 2020 2020 2020 2023 204e 6f64 6520 636f         # Node co
+00019490: 6f72 6469 6e61 7465 730d 0a20 2020 2020  ordinates..     
+000194a0: 2020 2078 797a 2c20 6b4c 696e 6520 3d20     xyz, kLine = 
+000194b0: 7265 6164 5f62 6c6f 636b 5f70 6c6f 7433  read_block_plot3
+000194c0: 6428 6c69 6e65 732c 206b 4c69 6e65 2c20  d(lines, kLine, 
+000194d0: 6e69 2c20 6e6a 2c20 6e6b 290d 0a20 2020  ni, nj, nk)..   
+000194e0: 2020 2020 2066 6f72 206b 2069 6e20 7261       for k in ra
+000194f0: 6e67 6528 6e6b 293a 0d0a 2020 2020 2020  nge(nk):..      
+00019500: 2020 2020 2020 666f 7220 6a20 696e 2072        for j in r
+00019510: 616e 6765 286e 6a29 3a0d 0a20 2020 2020  ange(nj):..     
+00019520: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00019530: 2069 6e20 7261 6e67 6528 6e69 293a 0d0a   in range(ni):..
+00019540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019550: 2020 2020 694c 696e 6520 2b3d 2031 0d0a      iLine += 1..
+00019560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019570: 2020 2020 662e 7772 6974 6528 2725 3139      f.write('%19
+00019580: 2e31 3065 2c25 3139 2e31 3065 2c25 3139  .10e,%19.10e,%19
+00019590: 2e31 3065 2c25 3132 6450 2025 3664 5c6e  .10e,%12dP %6d\n
+000195a0: 2725 280d 0a20 2020 2020 2020 2020 2020  '%(..           
+000195b0: 2020 2020 2020 2020 2020 2020 2078 797a               xyz
+000195c0: 5b69 2c6a 2c6b 2c30 5d2c 2078 797a 5b69  [i,j,k,0], xyz[i
+000195d0: 2c6a 2c6b 2c31 5d2c 2078 797a 5b69 2c6a  ,j,k,1], xyz[i,j
+000195e0: 2c6b 2c32 5d2c 0d0a 2020 2020 2020 2020  ,k,2],..        
 000195f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019600: 2020 6962 2a32 2b31 2c20 694c 696e 6529    ib*2+1, iLine)
-00019610: 290d 0a0d 0a20 2020 2020 2020 2023 2045  )....        # E
-00019620: 6e64 696e 670d 0a20 2020 2020 2020 2069  nding..        i
-00019630: 4c69 6e65 202b 3d20 310d 0a20 2020 2020  Line += 1..     
-00019640: 2020 2066 2e77 7269 7465 2827 2531 342e     f.write('%14.
-00019650: 3665 2c25 3134 2e36 652c 2531 342e 3665  6e,%14.6e,%14.6e
-00019660: 2c25 3134 2e36 653b 2531 3264 5020 2536  ,%14.6e;%12dP %6
-00019670: 645c 6e27 2528 0d0a 2020 2020 2020 2020  d\n'%(..        
-00019680: 2020 2020 7869 6d69 6e2c 2078 696d 6178      ximin, ximax
-00019690: 2c20 786a 6d69 6e2c 2078 6a6d 6178 2c20  , xjmin, xjmax, 
-000196a0: 6962 2a32 2b31 2c20 694c 696e 6529 290d  ib*2+1, iLine)).
-000196b0: 0a0d 0a20 2020 2023 2a20 456e 6469 6e67  ...    #* Ending
-000196c0: 2073 6563 7469 6f6e 0d0a 2020 2020 662e   section..    f.
-000196d0: 7772 6974 6528 2753 2025 3664 4720 2536  write('S %6dG %6
-000196e0: 6444 2025 3664 5020 2536 6420 2534 3073  dD %6dP %6d %40s
-000196f0: 2025 3664 5c6e 2725 2831 2c20 332c 2032   %6d\n'%(1, 3, 2
-00019700: 2a6e 756d 5f62 6c6f 636b 2c20 694c 696e  *num_block, iLin
-00019710: 652c 2027 5427 2c20 3129 290d 0a20 2020  e, 'T', 1))..   
-00019720: 2066 2e63 6c6f 7365 2829 0d0a 0d0a 6465   f.close()....de
-00019730: 6620 6964 6174 616c 696e 6528 6e69 3a20  f idataline(ni: 
-00019740: 696e 742c 206e 6a3a 2069 6e74 293a 0d0a  int, nj: int):..
-00019750: 2020 2020 2727 270d 0a20 2020 2046 756e      '''..    Fun
-00019760: 6374 696f 6e20 666f 7220 6070 6c6f 7433  ction for `plot3
-00019770: 645f 746f 5f69 6773 600d 0a20 2020 2027  d_to_igs`..    '
-00019780: 2727 0d0a 2020 2020 6931 203d 206e 692b  ''..    i1 = ni+
-00019790: 340d 0a20 2020 2069 3220 3d20 6e6a 2b34  4..    i2 = nj+4
-000197a0: 0d0a 2020 2020 6933 203d 206e 692a 6e6a  ..    i3 = ni*nj
-000197b0: 0d0a 2020 2020 6934 203d 206e 692a 6e6a  ..    i4 = ni*nj
-000197c0: 0d0a 2020 2020 6935 203d 2031 2b31 0d0a  ..    i5 = 1+1..
-000197d0: 0d0a 2020 2020 7265 7475 726e 2069 312b  ..    return i1+
-000197e0: 6932 2b69 332b 6934 2b69 350d 0a0d 0a64  i2+i3+i4+i5....d
-000197f0: 6566 206b 6e6f 7478 286e 693a 2069 6e74  ef knotx(ni: int
-00019800: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
-00019810: 0d0a 2020 2020 2727 270d 0a20 2020 2046  ..    '''..    F
-00019820: 756e 6374 696f 6e20 666f 7220 6070 6c6f  unction for `plo
-00019830: 7433 645f 746f 5f69 6773 602e 0d0a 2020  t3d_to_igs`...  
-00019840: 2020 0d0a 2020 2020 5265 7475 726e 7320    ..    Returns 
-00019850: 5b30 2c20 302c 2030 2c20 302c 202e 2e2e  [0, 0, 0, 0, ...
-00019860: 286e 692d 3329 2e2e 2e2c 2031 2e30 2c20  (ni-3)..., 1.0, 
-00019870: 312e 302c 2031 2e30 2c20 312e 305d 2e0d  1.0, 1.0, 1.0]..
-00019880: 0a20 2020 2027 2727 200d 0a0d 0a20 2020  .    ''' ....   
-00019890: 2078 4b6e 6f74 203d 206e 702e 7a65 726f   xKnot = np.zero
-000198a0: 7328 6e69 2b34 290d 0a0d 0a20 2020 2066  s(ni+4)....    f
-000198b0: 6f72 2069 2069 6e20 7261 6e67 6528 6e69  or i in range(ni
-000198c0: 2d33 293a 0d0a 2020 2020 2020 2020 784b  -3):..        xK
-000198d0: 6e6f 745b 692b 345d 203d 2028 692b 312e  not[i+4] = (i+1.
-000198e0: 3029 2f28 6e69 2d33 2e30 290d 0a0d 0a20  0)/(ni-3.0).... 
-000198f0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-00019900: 6528 3429 3a0d 0a20 2020 2020 2020 2078  e(4):..        x
-00019910: 4b6e 6f74 5b6e 692b 695d 203d 2031 2e30  Knot[ni+i] = 1.0
-00019920: 0d0a 0d0a 2020 2020 7265 7475 726e 2078  ....    return x
-00019930: 4b6e 6f74 0d0a 0d0a 0d0a                 Knot......
+00019600: 6962 2a32 2b31 2c20 694c 696e 6529 290d  ib*2+1, iLine)).
+00019610: 0a0d 0a20 2020 2020 2020 2023 2045 6e64  ...        # End
+00019620: 696e 670d 0a20 2020 2020 2020 2069 4c69  ing..        iLi
+00019630: 6e65 202b 3d20 310d 0a20 2020 2020 2020  ne += 1..       
+00019640: 2066 2e77 7269 7465 2827 2531 342e 3665   f.write('%14.6e
+00019650: 2c25 3134 2e36 652c 2531 342e 3665 2c25  ,%14.6e,%14.6e,%
+00019660: 3134 2e36 653b 2531 3264 5020 2536 645c  14.6e;%12dP %6d\
+00019670: 6e27 2528 0d0a 2020 2020 2020 2020 2020  n'%(..          
+00019680: 2020 7869 6d69 6e2c 2078 696d 6178 2c20    ximin, ximax, 
+00019690: 786a 6d69 6e2c 2078 6a6d 6178 2c20 6962  xjmin, xjmax, ib
+000196a0: 2a32 2b31 2c20 694c 696e 6529 290d 0a0d  *2+1, iLine))...
+000196b0: 0a20 2020 2023 2a20 456e 6469 6e67 2073  .    #* Ending s
+000196c0: 6563 7469 6f6e 0d0a 2020 2020 662e 7772  ection..    f.wr
+000196d0: 6974 6528 2753 2025 3664 4720 2536 6444  ite('S %6dG %6dD
+000196e0: 2025 3664 5020 2536 6420 2534 3073 2025   %6dP %6d %40s %
+000196f0: 3664 5c6e 2725 2831 2c20 332c 2032 2a6e  6d\n'%(1, 3, 2*n
+00019700: 756d 5f62 6c6f 636b 2c20 694c 696e 652c  um_block, iLine,
+00019710: 2027 5427 2c20 3129 290d 0a20 2020 2066   'T', 1))..    f
+00019720: 2e63 6c6f 7365 2829 0d0a 0d0a 6465 6620  .close()....def 
+00019730: 6964 6174 616c 696e 6528 6e69 3a20 696e  idataline(ni: in
+00019740: 742c 206e 6a3a 2069 6e74 293a 0d0a 2020  t, nj: int):..  
+00019750: 2020 2727 270d 0a20 2020 2046 756e 6374    '''..    Funct
+00019760: 696f 6e20 666f 7220 6070 6c6f 7433 645f  ion for `plot3d_
+00019770: 746f 5f69 6773 600d 0a20 2020 2027 2727  to_igs`..    '''
+00019780: 0d0a 2020 2020 6931 203d 206e 692b 340d  ..    i1 = ni+4.
+00019790: 0a20 2020 2069 3220 3d20 6e6a 2b34 0d0a  .    i2 = nj+4..
+000197a0: 2020 2020 6933 203d 206e 692a 6e6a 0d0a      i3 = ni*nj..
+000197b0: 2020 2020 6934 203d 206e 692a 6e6a 0d0a      i4 = ni*nj..
+000197c0: 2020 2020 6935 203d 2031 2b31 0d0a 0d0a      i5 = 1+1....
+000197d0: 2020 2020 7265 7475 726e 2069 312b 6932      return i1+i2
+000197e0: 2b69 332b 6934 2b69 350d 0a0d 0a64 6566  +i3+i4+i5....def
+000197f0: 206b 6e6f 7478 286e 693a 2069 6e74 2920   knotx(ni: int) 
+00019800: 2d3e 206e 702e 6e64 6172 7261 793a 0d0a  -> np.ndarray:..
+00019810: 2020 2020 2727 270d 0a20 2020 2046 756e      '''..    Fun
+00019820: 6374 696f 6e20 666f 7220 6070 6c6f 7433  ction for `plot3
+00019830: 645f 746f 5f69 6773 602e 0d0a 2020 2020  d_to_igs`...    
+00019840: 0d0a 2020 2020 5265 7475 726e 7320 5b30  ..    Returns [0
+00019850: 2c20 302c 2030 2c20 302c 202e 2e2e 286e  , 0, 0, 0, ...(n
+00019860: 692d 3329 2e2e 2e2c 2031 2e30 2c20 312e  i-3)..., 1.0, 1.
+00019870: 302c 2031 2e30 2c20 312e 305d 2e0d 0a20  0, 1.0, 1.0]... 
+00019880: 2020 2027 2727 200d 0a0d 0a20 2020 2078     ''' ....    x
+00019890: 4b6e 6f74 203d 206e 702e 7a65 726f 7328  Knot = np.zeros(
+000198a0: 6e69 2b34 290d 0a0d 0a20 2020 2066 6f72  ni+4)....    for
+000198b0: 2069 2069 6e20 7261 6e67 6528 6e69 2d33   i in range(ni-3
+000198c0: 293a 0d0a 2020 2020 2020 2020 784b 6e6f  ):..        xKno
+000198d0: 745b 692b 345d 203d 2028 692b 312e 3029  t[i+4] = (i+1.0)
+000198e0: 2f28 6e69 2d33 2e30 290d 0a0d 0a20 2020  /(ni-3.0)....   
+000198f0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00019900: 3429 3a0d 0a20 2020 2020 2020 2078 4b6e  4):..        xKn
+00019910: 6f74 5b6e 692b 695d 203d 2031 2e30 0d0a  ot[ni+i] = 1.0..
+00019920: 0d0a 2020 2020 7265 7475 726e 2078 4b6e  ..    return xKn
+00019930: 6f74 0d0a 0d0a 0d0a                      ot......
```

### Comparing `cst_modeling3d-0.2.2/cst_modeling/section.py` & `cst_modeling3d-0.2.3/cst_modeling/section.py`

 * *Files identical despite different names*

### Comparing `cst_modeling3d-0.2.2/cst_modeling/surface.py` & `cst_modeling3d-0.2.3/cst_modeling/surface.py`

 * *Files 0% similar despite different names*

```diff
@@ -373,15 +373,15 @@
 
                 for isec in range(n_piece):
                     
                     surf_x = self.surfs[isec][0]
                     surf_y = self.surfs[isec][1]
                     surf_z = self.surfs[isec][2]
 
-                    if isec>=n_piece-2:
+                    if isec>=n_piece-1:
                         i_add = 0
                     else:
                         i_add = 1
 
                     for i in range(ns-i_add):
                         for j in range(nt):
                             f.write('  %.9f   %.9f   %.9f\n'%(surf_x[i,j+nt-1], surf_y[i,j+nt-1], surf_z[i,j+nt-1]))
@@ -390,15 +390,15 @@
 
                 for isec in range(n_piece):
                     
                     surf_x = self.surfs[isec][0]
                     surf_y = self.surfs[isec][1]
                     surf_z = self.surfs[isec][2]
                     
-                    if isec>=n_piece-2:
+                    if isec>=n_piece-1:
                         i_add = 0
                     else:
                         i_add = 1
 
                     for i in range(ns-i_add):
                         for j in range(nt):
                             f.write('  %.9f   %.9f   %.9f\n'%(surf_x[i,nt-1-j], surf_y[i,nt-1-j], surf_z[i,nt-1-j]))
```

### Comparing `cst_modeling3d-0.2.2/setup.py` & `cst_modeling3d-0.2.3/setup.py`

 * *Files identical despite different names*

