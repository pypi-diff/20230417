# Comparing `tmp/kaiju_tasks-2.0.10-py3-none-any.whl.zip` & `tmp/kaiju_tasks-2.0.11-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,22 +1,22 @@
-Zip file size: 21331 bytes, number of entries: 20
--rw-r--r--  2.0 unx      152 b- defN 23-Apr-12 14:42 kaiju_tasks/__init__.py
--rw-r--r--  2.0 unx     5135 b- defN 23-Apr-12 14:42 kaiju_tasks/etc.py
--rw-r--r--  2.0 unx     7913 b- defN 23-Apr-12 14:42 kaiju_tasks/executor.py
--rw-r--r--  2.0 unx     1290 b- defN 23-Apr-12 14:42 kaiju_tasks/fixtures.py
--rw-r--r--  2.0 unx     6119 b- defN 23-Apr-12 14:42 kaiju_tasks/interface.py
--rw-r--r--  2.0 unx    18363 b- defN 23-Apr-12 14:42 kaiju_tasks/manager.py
--rw-r--r--  2.0 unx     1687 b- defN 23-Apr-12 14:42 kaiju_tasks/notifications.py
--rw-r--r--  2.0 unx      191 b- defN 23-Apr-12 14:42 kaiju_tasks/services.py
--rw-r--r--  2.0 unx     4164 b- defN 23-Apr-12 14:42 kaiju_tasks/tables.py
--rw-r--r--  2.0 unx       38 b- defN 23-Apr-12 14:42 kaiju_tasks/tasks_gui/__init__.py
--rw-r--r--  2.0 unx     2011 b- defN 23-Apr-12 14:42 kaiju_tasks/tasks_gui/models.py
--rw-r--r--  2.0 unx     4272 b- defN 23-Apr-12 14:42 kaiju_tasks/tasks_gui/service.py
--rw-r--r--  2.0 unx      350 b- defN 23-Apr-12 14:42 kaiju_tasks/tasks_gui/validators.py
--rw-r--r--  2.0 unx       42 b- defN 23-Apr-12 14:42 kaiju_tasks/tests/__init__.py
--rw-r--r--  2.0 unx    11345 b- defN 23-Apr-12 14:42 kaiju_tasks/tests/test_task_management.py
--rw-rw-rw-  2.0 unx      610 b- defN 23-Apr-12 14:42 kaiju_tasks-2.0.10.dist-info/LICENSE
--rw-r--r--  2.0 unx     2915 b- defN 23-Apr-12 14:42 kaiju_tasks-2.0.10.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-12 14:42 kaiju_tasks-2.0.10.dist-info/WHEEL
--rw-r--r--  2.0 unx       12 b- defN 23-Apr-12 14:42 kaiju_tasks-2.0.10.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     1666 b- defN 23-Apr-12 14:42 kaiju_tasks-2.0.10.dist-info/RECORD
-20 files, 68367 bytes uncompressed, 18609 bytes compressed:  72.8%
+Zip file size: 21471 bytes, number of entries: 20
+-rw-r--r--  2.0 unx      152 b- defN 23-Apr-17 19:10 kaiju_tasks/__init__.py
+-rw-r--r--  2.0 unx     5135 b- defN 23-Apr-17 19:10 kaiju_tasks/etc.py
+-rw-r--r--  2.0 unx     8492 b- defN 23-Apr-17 19:10 kaiju_tasks/executor.py
+-rw-r--r--  2.0 unx     1290 b- defN 23-Apr-17 19:10 kaiju_tasks/fixtures.py
+-rw-r--r--  2.0 unx     6119 b- defN 23-Apr-17 19:10 kaiju_tasks/interface.py
+-rw-r--r--  2.0 unx    18363 b- defN 23-Apr-17 19:10 kaiju_tasks/manager.py
+-rw-r--r--  2.0 unx     1687 b- defN 23-Apr-17 19:10 kaiju_tasks/notifications.py
+-rw-r--r--  2.0 unx      191 b- defN 23-Apr-17 19:10 kaiju_tasks/services.py
+-rw-r--r--  2.0 unx     4164 b- defN 23-Apr-17 19:10 kaiju_tasks/tables.py
+-rw-r--r--  2.0 unx       38 b- defN 23-Apr-17 19:10 kaiju_tasks/tasks_gui/__init__.py
+-rw-r--r--  2.0 unx     2011 b- defN 23-Apr-17 19:10 kaiju_tasks/tasks_gui/models.py
+-rw-r--r--  2.0 unx     4272 b- defN 23-Apr-17 19:10 kaiju_tasks/tasks_gui/service.py
+-rw-r--r--  2.0 unx      350 b- defN 23-Apr-17 19:10 kaiju_tasks/tasks_gui/validators.py
+-rw-r--r--  2.0 unx       42 b- defN 23-Apr-17 19:10 kaiju_tasks/tests/__init__.py
+-rw-r--r--  2.0 unx    11345 b- defN 23-Apr-17 19:10 kaiju_tasks/tests/test_task_management.py
+-rw-rw-rw-  2.0 unx      610 b- defN 23-Apr-17 19:11 kaiju_tasks-2.0.11.dist-info/LICENSE
+-rw-r--r--  2.0 unx     2915 b- defN 23-Apr-17 19:11 kaiju_tasks-2.0.11.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-17 19:11 kaiju_tasks-2.0.11.dist-info/WHEEL
+-rw-r--r--  2.0 unx       12 b- defN 23-Apr-17 19:11 kaiju_tasks-2.0.11.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1666 b- defN 23-Apr-17 19:11 kaiju_tasks-2.0.11.dist-info/RECORD
+20 files, 68946 bytes uncompressed, 18749 bytes compressed:  72.8%
```

## zipnote {}

```diff
@@ -39,23 +39,23 @@
 
 Filename: kaiju_tasks/tests/__init__.py
 Comment: 
 
 Filename: kaiju_tasks/tests/test_task_management.py
 Comment: 
 
-Filename: kaiju_tasks-2.0.10.dist-info/LICENSE
+Filename: kaiju_tasks-2.0.11.dist-info/LICENSE
 Comment: 
 
-Filename: kaiju_tasks-2.0.10.dist-info/METADATA
+Filename: kaiju_tasks-2.0.11.dist-info/METADATA
 Comment: 
 
-Filename: kaiju_tasks-2.0.10.dist-info/WHEEL
+Filename: kaiju_tasks-2.0.11.dist-info/WHEEL
 Comment: 
 
-Filename: kaiju_tasks-2.0.10.dist-info/top_level.txt
+Filename: kaiju_tasks-2.0.11.dist-info/top_level.txt
 Comment: 
 
-Filename: kaiju_tasks-2.0.10.dist-info/RECORD
+Filename: kaiju_tasks-2.0.11.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## kaiju_tasks/__init__.py

```diff
@@ -1,7 +1,7 @@
 from .etc import *
 from .tables import *
 from .services import *
 
-__version__ = '2.0.10'
+__version__ = '2.0.11'
 __python_version__ = '3.8'
 __author__ = 'antonnidhoggr@me.com'
```

## kaiju_tasks/executor.py

```diff
@@ -1,9 +1,10 @@
 import asyncio
 
+from kaiju_tools.exceptions import InternalError
 from kaiju_tools.rpc import JSONRPCServer, AbstractRPCCompatible
 from kaiju_tools.rpc.jsonrpc import RPCError
 from kaiju_tools.rpc.etc import JSONRPCHeaders
 from kaiju_tools.services import ContextableService
 from kaiju_tools.streams import Listener, Topics
 from kaiju_tools.templates import Template
 from kaiju_tools.functions import retry
@@ -90,21 +91,30 @@
         async with self._counter:
             if self._counter.locked():
                 self._stream._consumers[self.executor_topic]._unlocked.clear()  # noqa TODO: lock stream when no counter
             for n, cmd in enumerate(data['commands']):
                 if self._closing:
                     break
                 stage = stage + n
-                cmd = Template(cmd).fill(template_data)
-                _, result = await self._rpc.call(cmd, headers, session=None)
-                error, result = self._parse_result(result)
-                await self._write_stage_result(data, stage, error, result)
-                if error:
+                try:
+                    cmd = Template(cmd).fill(template_data)
+                    _, result = await self._rpc.call(cmd, headers, session=None)
+                except Exception as exc:
+                    self.logger.error(
+                        'Error while preparing for a stage execution', exc=exc, cmd=cmd, task_id=data['id'], stage=stage
+                    )
+                    result = RPCError(id=None, error=InternalError(base_exc=exc, message='Template evaluation error'))
+                    await self._write_stage_result(data, stage, error=True, result=result)
                     break
-                template_data[TemplateKey.RESULT.value][str(stage)] = result
+                else:
+                    error, result = self._parse_result(result)
+                    await self._write_stage_result(data, stage, error, result)
+                    if error:
+                        break
+                    template_data[TemplateKey.RESULT.value][str(stage)] = result
 
         self._stream._consumers[self.executor_topic]._unlocked.set()  # noqa, I know
 
     @staticmethod
     def _get_template_data(data: ExecutorTask) -> dict:
         return {
             TemplateKey.KWS.value: data['kws'],
```

## Comparing `kaiju_tasks-2.0.10.dist-info/LICENSE` & `kaiju_tasks-2.0.11.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `kaiju_tasks-2.0.10.dist-info/METADATA` & `kaiju_tasks-2.0.11.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: kaiju-tasks
-Version: 2.0.10
+Version: 2.0.11
 Summary: Service and user task management
 Home-page: https://gitlab.com/kaiju-python/kaiju-tasks
 Author: antonnidhoggr@me.com
 Author-email: antonnidhoggr@me.com
 License: Apache Software License 2.0
 Classifier: Development Status :: 3 - Alpha
 Classifier: License :: OSI Approved :: Apache Software License
```

## Comparing `kaiju_tasks-2.0.10.dist-info/RECORD` & `kaiju_tasks-2.0.11.dist-info/RECORD`

 * *Files 14% similar despite different names*

```diff
@@ -1,20 +1,20 @@
-kaiju_tasks/__init__.py,sha256=8-7-qkTtKsV_X7FJNRfJUA7MmFUsRGAAsYu4pR147s8,152
+kaiju_tasks/__init__.py,sha256=no09I-emMvImHxdleTfkrhhRih0c68Qj_1U2epGXq0U,152
 kaiju_tasks/etc.py,sha256=fPwM7jthxYb8Wd0GjmgVo9vKEyrnDW5VPeApT06xk-0,5135
-kaiju_tasks/executor.py,sha256=6Kn9GmQCxitq8nDMzgqtu9dj3CLxwA10Li5uLPl3IYs,7913
+kaiju_tasks/executor.py,sha256=9_OKnNLyaFzRpuOSPTHIWm62Wp1m4ULk9LfcqUnLqwM,8492
 kaiju_tasks/fixtures.py,sha256=EBpjAZ9_nfbMV0DpkcpQoFbw3RsELFuSXBVm-zMPCOk,1290
 kaiju_tasks/interface.py,sha256=HKolfpwlRaVg9ZTJvsxDkYLX37EX8AOtB-AzBSvyWIk,6119
 kaiju_tasks/manager.py,sha256=w5D5xt_ZTk5s0shwnsGWdSM8F6fVM8DgXaSy-hVuON8,18363
 kaiju_tasks/notifications.py,sha256=z7mluYiJFCpFjyddxZ82HkhgRyxgePT6PSdQ0p1D0v8,1687
 kaiju_tasks/services.py,sha256=mudNyQmrgekIw-Ig7lqMktb2UlbCGjBIX2I0nkz9O8I,191
 kaiju_tasks/tables.py,sha256=mWR4NHSALlHX1s96079MwenNrEkXcCVdLSFK8L_3sA8,4164
 kaiju_tasks/tasks_gui/__init__.py,sha256=_gDfM5r8uxCvydv3NOUN21imwJW_NW9R16UXWExQAE8,38
 kaiju_tasks/tasks_gui/models.py,sha256=iXqYnYYh8TJ7jkVxyEmMeykfpmoNfEfEERW-1jwzjsk,2011
 kaiju_tasks/tasks_gui/service.py,sha256=_qCURg-h6I9OI5uZdTGYCzJglXPXomcqAt6D7ODLRmU,4272
 kaiju_tasks/tasks_gui/validators.py,sha256=QybfHwKMWJq9AcGlXO7F5fuEGLssjHN2jcAV0UI6FPc,350
 kaiju_tasks/tests/__init__.py,sha256=WlPruePOcaMi5ikqn6GheE1Z-zYcysb9M1dj6SteWGY,42
 kaiju_tasks/tests/test_task_management.py,sha256=WkN0lAyStIogQxJPyvlYDEY7XcYi5XK-RmQbf6oHCi8,11345
-kaiju_tasks-2.0.10.dist-info/LICENSE,sha256=XIlN2qA8UqpBDA-PteoYP4hTU0qBW0G9PRB__khO2zc,610
-kaiju_tasks-2.0.10.dist-info/METADATA,sha256=kF0QwV50GWlGJKZbvjUZUEOFUFSdxkFFamnbYWQLWwk,2915
-kaiju_tasks-2.0.10.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-kaiju_tasks-2.0.10.dist-info/top_level.txt,sha256=QyLogqOVVajJlalq6RfikGx5VGn_lLeTANJEsfZZlM0,12
-kaiju_tasks-2.0.10.dist-info/RECORD,,
+kaiju_tasks-2.0.11.dist-info/LICENSE,sha256=XIlN2qA8UqpBDA-PteoYP4hTU0qBW0G9PRB__khO2zc,610
+kaiju_tasks-2.0.11.dist-info/METADATA,sha256=xHmmCl9J-TtN7bnb30ZaFBBpVBOHNTYbmX-Dt_jaOZM,2915
+kaiju_tasks-2.0.11.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+kaiju_tasks-2.0.11.dist-info/top_level.txt,sha256=QyLogqOVVajJlalq6RfikGx5VGn_lLeTANJEsfZZlM0,12
+kaiju_tasks-2.0.11.dist-info/RECORD,,
```

